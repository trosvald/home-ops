version: v1alpha1
debug: false
persist: true
machine:
  type: worker
  token: ENC[AES256_GCM,data:k7MdGZxk+74dydVNkKa3Hikb8ouCTDo=,iv:EgZAfxo6qXBEYrLys3PmJcJoBAvxI/jnuO2wXVIe2qI=,tag:yzjLE9uf2NCUWPNZtGfoIw==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:asSjEqB2Eo9vXXzbXjzhME/RH++vjCF6YHJQgmGFmmgn6lFVnRRp3ed2cwj42ouONWMex3HuTxVh9cGCp+pXWgjvqvXxIJUNCGMl0Xo8fb3Bi1Bmd43obGMpY4+i0PhVqxmYGaGONOuV3K2vIb0Aoa8lEBajEei5a7v7SPO8zNqClJGShTiBUrkXfIfUq787D+/AdcJzq/hUCB7OhGYNvibiS2zzTarPzKkKeNxiNK0mJ7aS88ibWRPvNc3TO87wY/TNys8fHyB7qO2aoCk2LTdECFN0xT3eib3m+B5cPTzpgiL64xmrYKeb0rlQRJMDWlvXY1zM2o3MGWG4002Yi6TBlp4Oexp7NRwPwJ0rW1BRGGIaGyo7CvvqBlEkcK+yEOx586VyojfH/K1VPHk3TmRfNyzChVrl9aScgmHlORdmPbGYg4/wb9QdkvwuG3gGdHLCiTyc3++MDHhpsRRUoUB6bFMzc28xs0vMOCReol3wMDvljg4VdkXfWZgvfiaIKWLl7ehaekbfJJZAN6QhLVOlkxWs51sGW2rVrDLDR/GDsLIIMMhCr/vRWDtiTBrWKYMJGGvMeXKUechG+eL4mhRcvJ91cMVTULEYEbpQS/i2L5ijOOmX8SkSJd0IKc8l6x2djwdQjpYn1kd/uxUU4yRosTLXavZhqFQ4NlET6/qnkMalkYL4HQ41ZDan0IG24QWKKAxhd2XE54Lo57xPL4Hhy5xjO5Kslhd68WUItS3uj6BOaHiZDDylKQBxT9PqEtXcyi8vFZWJ46gf+k2Yo1OFOyWn5BjRHWEL93qtG+WpDliWzg/vksQ/Fv16IBTbNhfB+2Rospb+ihmeUkVCURIXhmMyt00L+Z3zFJ3bTRgEIiw2,iv:GEB0QEfngn+jy+tOlD8jjoeDYUK6U47xPekS4FrOdO4=,tag:35phTDQSf6/+G28Q18fpkw==,type:str]
    key: ""
  certSANs:
    - 172.16.11.20
    - 127.0.0.1
  kubelet:
    image: ghcr.io/siderolabs/kubelet:v1.30.3
    extraArgs:
      rotate-server-certificates: "true"
    extraMounts:
      - destination: /var/openebs/local
        type: bind
        source: /var/openebs/local
        options:
          - bind
          - rshared
          - rw
    defaultRuntimeSeccompProfileEnabled: true
    nodeIP:
      validSubnets:
        - 172.16.11.0/24
    disableManifestsDirectory: true
  network:
    hostname: p-tlx-k8s-w2.monosense.io
    interfaces:
      - interface: eth0
        ignore: true
      - interface: bond0
        bond:
          interfaces: []
          deviceSelectors:
            - hardwareAddr: 8c:dc:d4:a8:42:dc
            - hardwareAddr: 8c:dc:d4:a8:42:dd
          mode: active-backup
          miimon: 100
        mtu: 9000
        dhcp: true
    nameservers:
      - 172.16.11.9
      - 172.16.11.11
    extraHostEntries:
      - ip: 172.16.11.20
        aliases:
          - k8s.monosense.io
          - main.monosense.io
    disableSearchDomain: true
  install:
    disk: /dev/sda
    extraKernelArgs:
      - net.ifnames=0
      - mitigations=off
      - module_blacklist=e1000e
      - talos.logging.kernel=udp://vector.monosense.io:6001/
    image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
    wipe: false
  files:
    - content: |-
        [plugins]
          [plugins."io.containerd.grpc.v1.cri"]
            enable_unprivileged_ports = true
            enable_unprivileged_icmp = true
          [plugins."io.containerd.grpc.v1.cri".containerd]
            discard_unpacked_layers = false
          [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
            discard_unpacked_layers = false
      permissions: 0
      path: /etc/cri/conf.d/20-customization.part
      op: create
    - content: |-
        [ NFSMount_Global_Options ]
        nfsvers=4.2
        hard=True
        noatime=True
        nodiratime=True
        rsize=131072
        wsize=131072
        nconnect=8
      permissions: 420
      path: /etc/nfsmount.conf
      op: overwrite
  time:
    disabled: false
    servers:
      - 172.16.11.254
      - 172.16.11.9
      - 172.16.11.11
  sysctls:
    fs.inotify.max_user_instances: "8192"
    fs.inotify.max_user_watches: "1048576"
    kernel.randomize_va_space: "0"
    net.core.netdev_max_backlog: "30000"
    net.core.rmem_max: "67108864"
    net.core.wmem_max: "67108864"
    net.ipv4.tcp_rmem: 4096 87380 33554432
    net.ipv4.tcp_tw_reuse: "1"
    net.ipv4.tcp_window_scaling: "1"
    net.ipv4.tcp_wmem: 4096 65536 33554432
  features:
    rbac: true
    stableHostname: true
    apidCheckExtKeyUsage: true
    diskQuotaSupport: true
    kubePrism:
      enabled: true
      port: 7445
    hostDNS:
      enabled: true
      forwardKubeDNSToHost: false
      resolveMemberNames: true
  logging:
    destinations:
      - endpoint: udp://vector.monosense.io:6002
        format: json_lines
  nodeLabels:
    topology.kubernetes.io/region: main
    topology.kubernetes.io/zone: w
cluster:
  id: ENC[AES256_GCM,data:RIN3ipdDHIT1Nvh0iSOTdbrEmohiGWfFgfrum0O2lGJeeDBGgKquWwiBuqw=,iv:+wBVEOoGcX7PTvqky2KfBDNsGGnqvBcVbiGLNF/BeWo=,tag:QhpVu6q7RZneuos6iDHv0g==,type:str]
  secret: ENC[AES256_GCM,data:I0z27vPLgze8MsbDY/nWeXEDz43LFuXuMnC9/PT5N1ZXS/pO3qX3SVBPmUU=,iv:OSLI00PV9du0JtbIMt4+5YTqLVnxafjWQKG8S4GNKTo=,tag:Ke+8tv1MKNe2kRdKZWBwCw==,type:str]
  controlPlane:
    endpoint: https://k8s.monosense.io:6443
  network:
    cni:
      name: none
    dnsDomain: cluster.local
    podSubnets:
      - 10.42.0.0/16
    serviceSubnets:
      - 10.43.0.0/16
  token: ENC[AES256_GCM,data:KNCLO55JSumL5f3gY4xYA5tdQKcfgd0=,iv:TIxS6DtwqyQ0zxjtMGAiQzEJt3itaUNhPgHD0s0Ql20=,tag:OVS83IHDIMZGrAFDIyKS7g==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:XamA3Hs/m117/jUq+yG+bUazIXCoQOw0Nk12RwIEbZlTOMGJ2Ty4raTFmbzLIfJswiuAXT/3lTnUpOcZ7jXYEbIm+DiHu7Hrk2xX8v5aM9n84swlAnlhCOPYgwpAFZQLuTe46QotJB/FM3a2Q1Os9vbgjlNnWVY5ac/AcqJx5vg4dcr20gbML4t4hsqWsYCOUZXNZgVmD3di51wMSc6nBT6wYuLuQrqbGfYlvxc0dZPMPFNxGp0qNALau7skRIJYiS+8Bosvl4/CbftB2YnhhQ3pGQ6ZNN7jNoH4pQ6h9bas2hNJV6ltpGXndf0oZ8Ped5u5Qd4690eHWpKVc4RT09GvjEHy66K0w5oVIaXJ1ic4+NjQpdbDEj97GinxAqclPTA55QaWQYp5mLC4wWD+sjl6GBJiOHsBm3Vy8+ZGmKU1Rq3sq+gVRFUh7RFtTBVpzpLptclSSVG0yJZQtQqaS6egsT8RUU2xMVIKGbIMnQ6dYYH7TnLbF37xCyu06hoo87ofOMwmb1zoKIjDkkgkiC7bpac97x2jkmZTw32OxKlfWV/jGi8wslD8GZddSMpQIqYDdQeN80k7ube2tO7YolFpnEMYo1SMupsIhMDGt7UO5d+wNLDRtiHCqxS1MWSq3675Tj/mtSl1tT5ZKnWNfozXpRPWsdiCr7vAvDq5hhxZ5sRx1ZJK9jRicnuYLqBkpmzpp2ovC6jzKnCxLhS80ebgkY2m6wdy5Ootx3HA+nCniVjwrB4UF03JTtOxF2Up0Wihbau00ONDxb+29JuhRkMnNl+6CwGSsFYcnMi2rS4KszKytz/TCC2cKXapgnQB8hHXdWan2nrV2uA6qAW+VydEN2YlsyNMeS7w+QZ4C3XMdbSwwLfEReD21rmE8ZnOynR+DPuX1OFiKI3gyl9UBxWAik8hn7tzaTHzbR16jEvPbvkW3Exvf1tOY7o1sa3D5TRC/IE2v1jYGMKhb+fS4zaypLRTtTKL8ynlyIlYCHxoXFk/u4qcdKxjNfsOsJmdY6ayHPhWbuXOciAlU+2IcH6ESx8gevKx74Vftw==,iv:SeLqjizVpFoCX4osdUaJ1CfKqMJV/w58MrzvEp+gxx4=,tag:JjdTo6DY+wi1xfL2azFJVQ==,type:str]
    key: ""
  discovery:
    enabled: true
    registries:
      kubernetes:
        disabled: false
      service:
        disabled: false
sops:
  kms: []
  gcp_kms: []
  azure_kv: []
  hc_vault: []
  age:
    - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
      enc: |
        -----BEGIN AGE ENCRYPTED FILE-----
        YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBRSXJhYmNJb1dhckw5ck1u
        RXkrYUNrUzg3QlRwd05hS05nQWUzSGxZeWxJCmJXaUE0K0RTOEZmdmFXNGdKb1lJ
        MUJjUnRhQTYyWkpvUjdwdGVTZHN0UkEKLS0tIHJGT2RSMmxqR2pBQlMzd0xwN3pS
        OUwwSGFRYjEwS2VoR2svZHRXQ0cxWlkKhTtXefHSYIXCC4Ozh8n/zaOT5uxjUSw8
        2jZW419ggfNaRLGTvXXRTxwgG3D/Qs/xaqAj9UQAQobmQCCSE26EWQ==
        -----END AGE ENCRYPTED FILE-----
  lastmodified: "2024-08-19T12:36:17Z"
  mac: ENC[AES256_GCM,data:tZO+AqDFruLE+mHp0V33Ic/b8oYy7suJrmXdbobK2c+c6Tt84nLmFPOwTdcgXu8nHLDPIW7xQRNhZQys/0BtHYJL8X0tH9nskGOJe2/Y8ya740I/e6284KMR7/82DsbD+cCBBcvvdU2Dcv/8hr7zgHIkDxGeuRIxm6vSTML+HG4=,iv:ZqN/2ReeTNWVF2qvx00JwGnr6TImrrkmGeqZd3rJeX0=,tag:8Agad3kVhDXUQhnUKDoYQg==,type:str]
  pgp: []
  encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
  version: 3.9.0
