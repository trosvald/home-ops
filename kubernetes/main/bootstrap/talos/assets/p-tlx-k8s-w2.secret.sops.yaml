version: v1alpha1
debug: false
persist: true
machine:
    type: worker
    token: ENC[AES256_GCM,data:/ofXWBFtA+kGbm9BFHqpSado+LcON7c=,iv:/aL6kUp4aZJZf6Y8Jb+u7c2Oq8kRymHPFAFWLAoezWU=,tag:dRl2dI5nqW1aIphoG6ZOSw==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:5wjXBSfnmCC6YvBoCrfC/otDIVokrk5XxRBjiV7/UyhUImAfi1mgxq5GUQEnt89Ycj5jtEjYIPPH9HBzX4D3sZHiYNR+xhcoCmbLCqsCDo0f4h/nTiqd/9RT3hHFaMOMHlECpzSBgprwrqUaQzq5cLs9IsgghV4/kTtvsjrpUugNn0Mlr1+YouXBqjKBYRvCh6CNU2dXGw6HKDPPTm5Z47RakKftKaSv9QUGOVdSa9FE4W56sE7XoI+Sv8j1jz5do1c34Dr+5Xe5R4Do6BsSFpHBU3HcYqg/dYEv9d4t8XqfFLfW+tFo2PWPiPJSUxXLUzVWkiJygnDuwRGcrmUeZ7eWwFQHI6XGbtLhxWnoRnXAYajJ5ruMU4Te7G+JGlpcYIy8gYVhzzorVbJ+WDRRk5QAh8GWCU02npVbIlF0HpGp2cINHPbIYsKKzheIEL21JqU6nEV0OojGixa7oe7LGGKwbNq/ZiuvkIR6VTfE2RQ9kgp13OaJc6wwZlv+LGfhTMRNu9JEdVBKWhOzcpLU4PTQCACp0UGhMZZt9Xlp8DH1tTAGPEl0MDvoTxKDkCw6FoJkb2yTrqPe85K6Yg7kkT828Ful+8kp0955lGV3dzofUDhx3LEmhnikC4RJrfBVn3u45HofjUD8uN3zfCxUbDHhmdaRblww0lbjnDkpfuYUSDGUfjPEgpHTQkLFhVS+MfydGn/h8vEGmH+HG44vFahl/f9yicgVhdyLHATiCu+rN4jreuC/eGtJxu092WD6XDjAIR0sfJJ+TQLwNjXrMXoncNMAlapm9tn/iMKx9ly79Fd/TOf0gs3AsNXlv8xXim81/RYRxxW+XdfuA6oImCQhl/d0TrDXrMSGTSoq8UOeIzGa,iv:NZqv40UuDu2CjFe60+mgl6Rh2AQzVu+uK4IXtmid7eA=,tag:+4EmtTP6a1olKHGCzwq1RQ==,type:str]
        key: ""
    certSANs:
        - 172.16.11.20
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.30.3
        extraArgs:
            rotate-server-certificates: "true"
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        hostname: p-tlx-k8s-w2.monosense.io
        interfaces:
            - interface: eth0
              ignore: true
            - interface: bond0
              bond:
                interfaces: []
                deviceSelectors:
                    - hardwareAddr: 8c:dc:d4:a8:42:dc
                    - hardwareAddr: 8c:dc:d4:a8:42:dd
                mode: active-backup
                miimon: 100
              mtu: 9000
              dhcp: true
        nameservers:
            - 172.16.11.9
            - 172.16.11.11
        extraHostEntries:
            - ip: 172.16.11.20
              aliases:
                - k8s.monosense.io
                - main.monosense.io
        disableSearchDomain: true
    install:
        disk: /dev/sda
        extraKernelArgs:
            - net.ifnames=0
            - mitigations=off
            - module_blacklist=e1000e
            - talos.logging.kernel=udp://vector.monosense.io:6001/
        image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.11.254
            - 172.16.11.9
            - 172.16.11.11
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "1048576"
        kernel.randomize_va_space: "0"
        net.core.netdev_max_backlog: "30000"
        net.core.rmem_max: "67108864"
        net.core.wmem_max: "67108864"
        net.ipv4.tcp_rmem: 4096 87380 33554432
        net.ipv4.tcp_tw_reuse: "1"
        net.ipv4.tcp_window_scaling: "1"
        net.ipv4.tcp_wmem: 4096 65536 33554432
    features:
        rbac: true
        stableHostname: true
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
            forwardKubeDNSToHost: false
            resolveMemberNames: true
    logging:
        destinations:
            - endpoint: udp://vector.monosense.io:6002
              format: json_lines
    nodeLabels:
        topology.kubernetes.io/region: main
        topology.kubernetes.io/zone: w
cluster:
    id: ENC[AES256_GCM,data:kTBrBgF/7mpYmbDERPFFhCjM0/GiL7r0KrsFszyxtBpJquizTTw6lh5efUk=,iv:fm1WeIsiNvkcmHms7z3n4yeuXEPC5HrdBmxZzEBZ/xQ=,tag:HVK4iAE0BNmiBdx9vqKsJw==,type:str]
    secret: ENC[AES256_GCM,data:s2/HbBLHTyzirvr9et5gb/acGZBeakWBY0Vbbr05YPoD2aZ1oX9LPH/nDeM=,iv:A4lShQbYA297sPCFl0jTTa3E7XdhVOsq66IHe/gtsvM=,tag:SEVUEzvoyE0Q8mXzAU+e2Q==,type:str]
    controlPlane:
        endpoint: https://k8s.monosense.io:6443
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.42.0.0/16
        serviceSubnets:
            - 10.43.0.0/16
    token: ENC[AES256_GCM,data:XFVUCLvrWDGbPrSjR9htAKT0/5H11sQ=,iv:bTHYhol1WsG6tJ4frNc9nuhOoOPa8Wmf1Vq5pxWXcWI=,tag:N+OMTHEDZgfSKNxcnrh6Xg==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:/9cx/W1IHMs2qz/xKxuCVdSPDaTfPJlW4j/K5MR48UuyNVee1rgujG/2ur16zXqN7vw111YeyiE3B8+ospGJrLkzmqA3IyJcfWjO4wCQ/xXnLynoVl/Pel818UJ1Mp73kxKl9ke3wryFULd58eX/hcN5PfaUdBFHIgAdWwNSyKyfQmx2x1YudlXR8WHmkLf1eml8MGa0gaycrwtYngd3GUi5QGbBfKMige/PkCOht087ZiH6pV/LWNTxSZ9g1QRlLaF0Tr6dUSk0th+AeXOOfoCT2WH6IF6hMsSlTtURE+dA1chrFOXkkEWurjZVqTEttV5pBAfUDMXeiZ7TO+VxoKZzwWfa/M7bLLC6KixdsRglLyTryfMNryB1JG2WG7AKA0uNpTJYBhDT72LiyCQAdQqNi/HuJ42i2miZrO4Nq7qXw3xWyT/34hxZUJzp5Z+UrrDyBQL+Kb2iHNU90jMfnTkul4cmZQqZjV4MYYWx1xZn7/WtXkkD2RDsAyAOFbb4ny9hh6EPD/Arv82wmeHzyStgPVLLny/ClH4f9HYm2uuTzaQVRsL3uR+AFDoGvUr4KoJ3YeajQ7p4aKAyht8LkOIZmS+OG4B8YNeFgEbkf/ThL76LloJQ6LTkX/1JBlQ3gmEdoYiN1e5cZSEgZhmOiK7iQw3j5YdXSXXPneA5lrkJ2TjMTlGiJtkufmMpnfts5uv7BxJ8Tl0FBUlLtEGYE5xvW4xHKf8le9BfW8+NO6kPxp5oSJZ1wihkpfhZGN75Qq5SjRkQhx+7CtyfeI9AZixsd3qgZJUXNZu9kIeVzPH0aZZ6B7b7DCo1liXLN29/zt8TnnJeTSl1EgUB0o2EvlaJvgTPNl3XOGTEUjiDcGaLJnX/UPFfszaydt8vDxbkVxnnqjVZEXvu1K8eGR72IwTfuwg64MR5zYkTTVpQk8WxKpk1E0vqA2JILMjwi+SM3yfeYKiT11dLoTy0dAD5Vr+CJdIVe5LdIftJycqxy1wrZBgankNNGTYymFR0XAUcH5BVSOw6AFdKF4Ku1rEgH/alV7izjm3UB3+APw==,iv:jgtOunl+QN6jcBK1oTs98M58DaL592Yy7fyxgOCMfrc=,tag:CZalXAnr76z8M6bdt+DOdA==,type:str]
        key: ""
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSB6K2dWdUMrY003UGVMNDNn
            a1BtazU1cVVYU1JiUDFsUHFCZ29ld0I2KzFjCitsdDd4VVJneFZDdGVoSG40VnU3
            cU5iREwxWXg4R0czbFV6akFDMFlLZVUKLS0tIE9Ed1JOQThIM1cwcUNweE5zOXJ6
            ZTNWTmxlK3RSOFd0U3Zmd2JOY2VSVkkKrewt0BuVeYi3syBtJmcb66lEw1TM5GQJ
            tkFGKlrOYSbl0j/Cnd6A5HkMETdhKMQ2DEjnoXWOAeyrPkENSNR9fQ==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-08-20T04:17:51Z"
    mac: ENC[AES256_GCM,data:rILJ+LXQRDZXPKcH/FrpTI4nr5SQENxkNQhWiE7WPK3c/87Kkr1XnFpbcs9u+OC7JsjaduY0RjwedJ3PdVUnnJU3F6Wu+7SqdG2FqB737ipzxtC1OWpW3BVTDzXg0WWdTZj7z5He4coMb2Ago/zLPj6074Mkkw9j8SHUtnxc40g=,iv:CCfi8UtH0vKimY9jOT5zn9zujImtFNs6jYe950BOUM4=,tag:73f1wrJKilZVc+vV7HV+iw==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.8.1
