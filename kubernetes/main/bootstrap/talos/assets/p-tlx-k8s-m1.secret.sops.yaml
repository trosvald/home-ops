version: v1alpha1
debug: false
persist: true
machine:
    type: controlplane
    token: ENC[AES256_GCM,data:EL42VmTATEots1aSzbLVJ0xf5+b7o2c=,iv:36msCMuTKcVLL3cI8Gda5UYdqVRhNfYA9Y46nTf7DZw=,tag:TJ6U8Vp/PKfKojiQdLGC/Q==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:/LivXAmkT1qfqO7t/v+omjMXB7pC5N0KP09kwmN7RVDgVsBxKSDM+lqIVBv86jVEzc8EUh4AkaB7s/E/GSR1pEDUncvh+1kYolow/QztAkUTdpJ3cCnI1sytr68ITRZKz/V6bq5KCo2psijfe8wi1osylc4mL/i12BU7w5JahFSgtrX4Ka1CVDAV5MESCblvAEMyjRtYCAQIwLxUUGaruRYlItJjLCcs1DvRoOgvK1lDY7X5vYSpOWY7t5dP5xpJlLL8TMj9Wxxi4jSvnn8XKHBCM2Y1K+YpCdczqcGo5k5ZDoiXKLb+bNP7kJU9s+CHXCeRsREBNo42NIUCbrccf/rs1gdf4wGDVeZ7bxZCe43ehjfnmeddjzBnr/gIwRmrMzJdyfoqnrXLkL5Gdvx+mir/5smuoKXPpGkVaN0BMwSOOmX6+2qC09wDunxB0/MRlZ/mM7EDgs498vwhsCRGLg4sCAp6KNoBrUt8Ai3g8imkyYmUq36vTYvwoAYqhELm9MvrUNLY23L7CwYcDI8YGoQZdY1J5xvpT5xIGF1gZH10v3VhMWi8Yw9X/k8gZQz55u3g8M4UXvfk2XgcocqGfr2pACuhqyqcVqVu+rvC2IzciggQGRw8YL0lFMi482i4576RqQfavaUBNdisJAve0xVZErjshJJOgqPMPlNiepgYY6ReaIrcDRMo7AGfzMdZ+ejK2AiKB5o2uN1JhCzUZo0t4y50gUtziroF8hw1O/0O5AxiQLJQ9R+U8K2WMOf3mvjDuJsYUTko/0jdU9tHVRZyvIhQXN5ehWPYlL0EGnLFpw24bvEd1z0k70UTh532KK2nOFNt51kLzS5q6OtZAPRe4wWVMsq0yFlX2H8QLLeHZHcP,iv:jxkB9eAh9KvgEatmYrlGUxMONOuJ/dlmCm0GzWYScM0=,tag:kr6d6rYnc+57RnOxedAihw==,type:str]
        key: ENC[AES256_GCM,data:JFPdpPKbzvtcyb3//4dWwVvp608NkCCV7twWenUlQhGscLVywFGVOH4DOYnBs/XY/AB+IZxp1QTaHzmy/gtg88Mx3V/piltkXBWhyWdLHPIriMQFS/yR4fJZyM0xv4/tZmQcxI9vn5BW6vqejzHCoFNG9gc2Jazmiyo4K8tDoT9V3BM5Mzpg3PPOqwxq0VKcF24VcEOQPAhe5FPwgKX531LGg9L8FmlOvXr+J/tKx/6GqHrQ,iv:tjYTEBqZqgtr1t12Q6HkDI1S+ZlGgXaa5dow0mKdWOs=,tag:LCIqJc2veh+/gEZ8qTPmPw==,type:str]
    certSANs:
        - 172.16.11.20
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.30.3
        extraArgs:
            rotate-server-certificates: "true"
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        hostname: p-tlx-k8s-m1.monosense.io
        interfaces:
            - interface: eth0
              ignore: true
            - interface: eth2
              ignore: true
            - interface: eth1
              addresses:
                - 172.16.11.4/24
              routes:
                - network: 0.0.0.0/0
                  gateway: 172.16.11.254
              vlans:
                - routes: []
                  dhcp: false
                  vlanId: 1613
                  mtu: 1500
                - routes: []
                  dhcp: false
                  vlanId: 1614
                  mtu: 1500
              mtu: 9000
              dhcp: false
              vip:
                ip: 172.16.11.20
        nameservers:
            - 172.16.11.9
            - 172.16.11.11
        extraHostEntries:
            - ip: 172.16.11.20
              aliases:
                - k8s.monosense.io
                - main.monosense.io
        disableSearchDomain: true
    install:
        disk: /dev/sda
        extraKernelArgs:
            - net.ifnames=0
            - mitigations=off
            - module_blacklist=e1000e
            - talos.logging.kernel=udp://vector.monosense.io:6001/
        image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.11.254
            - 172.16.11.9
            - 172.16.11.11
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "1048576"
        kernel.randomize_va_space: "0"
        net.core.netdev_max_backlog: "30000"
        net.core.rmem_max: "67108864"
        net.core.wmem_max: "67108864"
        net.ipv4.tcp_rmem: 4096 87380 33554432
        net.ipv4.tcp_tw_reuse: "1"
        net.ipv4.tcp_window_scaling: "1"
        net.ipv4.tcp_wmem: 4096 65536 33554432
    features:
        rbac: true
        stableHostname: true
        kubernetesTalosAPIAccess:
            enabled: true
            allowedRoles:
                - os:admin
            allowedKubernetesNamespaces:
                - system-upgrade
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
            forwardKubeDNSToHost: false
            resolveMemberNames: true
    logging:
        destinations:
            - endpoint: udp://vector.monosense.io:6002
              format: json_lines
    nodeLabels:
        topology.kubernetes.io/region: main
        topology.kubernetes.io/zone: m
cluster:
    id: ENC[AES256_GCM,data:Va1X+gm8dn/nwDfeRha792jFE2UldXw/MY75undsiY5aM0ty10wYfkbbdt4=,iv:dZwOpzih9PKjqmrN22J9EyysAs7EtMcFtaPXX95kZxQ=,tag:+1frEowsHFoMBBZSmLyxgA==,type:str]
    secret: ENC[AES256_GCM,data:xFLTSG8gQQBxwX9ZjcdDO4M8Kr0UFtbH1+HlpBS+jzqS9uffOxIN3mpI6nY=,iv:EELiP4wGuwCR5tQeMoEme9KPCdjoKI0L3fOfmcWp3x8=,tag:yqskxdDMJ/WjjJRta1HnXQ==,type:str]
    controlPlane:
        endpoint: https://k8s.monosense.io:6443
    clusterName: main
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.42.0.0/16
        serviceSubnets:
            - 10.43.0.0/16
    token: ENC[AES256_GCM,data:diO+P0/WZu0dEZ/6TCJ8H5urNGFvX+0=,iv:sB0QEyOhp5Dj9N9clwW9uhmqV+UUSaDP/Cv1KFiefHM=,tag:NSr1ZXsct4urodKJuiW0SQ==,type:str]
    secretboxEncryptionSecret: ENC[AES256_GCM,data:Wk4qsMCrKBSSvtaSJuRJsRSzlm3UvPnkpHlRTSP6nXNlIml/fmoo0xYeJws=,iv:ykZIZoqiMYcnuGVWFtHDZS03aIjVEP6vR6ek7IuTyk4=,tag:1KEG2qrXbQ39YNjH3nPb9w==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:N0i0VMuCK7KdT5cj5IKzozGcnRb2lre0kCtYA+DhsXk96d3Kzo245k9nDbgKdNAkxmhZiyvyU98GKrOkqSG/4cNaFaMCJiXOEvgX5qM38wbef6CvzfFQZ0W9Oo8NboJ6wP5OimDyOMN1dI8+kxVqErWC7ijevOF246l3iw3yZzQi9gu3LI9R2INPn1osn1wnadsEVHeYXwg/MzUZRwMdITIs3MJ9XxCR8u7fYqwEM+fetfJx6iXwXzakR/+lW2oUWNL+a+UbS/ndKSngWhU7dQ2cFJDDt7/BmY7rB1gkg2Wbb6QOmxeWcKwPx4Hxx7dmB3mvxGHTdrKtRR08VLbeKYKFE9FGJHCbuhFBaKY3Dk8ncWNX2Lhhz7v8dGIW6Xy0N1UoMKhCD6hItlTukserLM3PpvgAw2MIu3kof5ZUU8OrSMhRgbX7daVAJM4925vhC1xkrXp5tOb8MPjtNCH9AnX8rV5U2Dz25rD1NzqkUZwkCxtWVCTNLHdQnrgkHW4kZ+Z/Z/x9OLJPu86zm3b5cBss8gI5zVQK40NYwshHkWOlg4GtLFceHBOifRuiw6fwDoTlN0P9O1QKYz2jY7jMuO90kvwIdV1ZiuTQ7sXZwxtH8Ep9NZua808yGo+6o1jGCw6VJZxSJdJxQgeM8vwIQ1w+TUt3H8/2GhLcZreIRx7C9KyndGHPEDBOogJp1e3fJ4iLAAxiaj9wW6/J+P9zD6qh3MiEOudasoXPEGejJZ/oFjRsX71sg4DacyoGHppODc59eYbG1N0Qx8bqtDX1HG55AEV98J5lcGryZGLArVDx2E0qo0Hy2V96MhBHnaGAWCywDW6R9OJfuqyTHxstS098RawvbrO/UzpfjTREhN3UehJfBoLxPLr/tP6UQAN67B5tcmXL/esWoUzUkMBLf73URfkoLQOf8zxWzOiQUOYxo/QeLWOgx0Gc+AVxz0YXAjC0Ilqqo1uMHhGLi+lL3v5IRCIsIDku529RkcjUxrG9eOeh3Iqq42NZGDFUsVcBEhcH1PZv7ET13qwYQn0R0pN4MseURODaV8zXuQ==,iv:B8QwVoVBHwMoKZo9ljpT20hQKKp7RGk/dwED/GcbQw0=,tag:BVSf9HlzQVX+V89SSM5z/A==,type:str]
        key: ENC[AES256_GCM,data:9q+U6ufjVVkl1XHymZo4GzbeWW3aO2AiF/SQsHGGg6g1UBHGYxCUoxTSUKUxkuWMPnWxWr0avOlGU4zKfvgfyXqTT6s9rx9pyvYYYkkhiwqpvr3hnZ0IzC9hr6bb3b8bFUVz1YRsE/1Jd4vhSbkUGtfYZ0/5Bnrr2quW0jhpaQ9FkM/losZm++ajbADyrtSJODlSn6rmvrsWIXWbnyjPqm7NesPA7Fy2BsZougJ+EyTAjzk6PYGtUCoGbRcE7fXroQCxvQ7yvLvyORK5FIBODl5L63BLYAPdhwJwJClOqTICTw2Pjvb+62ABe6ZvI64utgGz1bkuAHHiKPJnhyCg/+3nJlhflvJ8k17DoWADLVzDHvrATaQBtZN5G+DZs79zbpslzfzTz61wdjhNsI4faQ==,iv:9eWCKhifslpAP3KnEHVR4PLvnaZWKcvTwVjqibyZLfo=,tag:irBiYSjczq6SH9f5aYIt4g==,type:str]
    aggregatorCA:
        crt: ENC[AES256_GCM,data:QzB0pyB5oJkaU20Y//tAEnIsEFq3szA+kq6i5KRpWvWSXRmCD915Vaum3LsWQaKSYp8K+//FEHMZJ+jgQGGp7v7SNoNSO/0oStc0RBBnqCF0phN6GFz/klzXem5d7Mz9teYpOspZ8gl2VW/SDqR30Ye/GSNkVrwQRik748r5fqK+mpShmnhRZA3MAZ8+ZdaCg+xvc6+eCoxKYxTwYGXxb/2O2s350oLmubuFUiB+EwC9jPF013/li4s3tQDswOef+eNzHcpyFaZKEqb4lp0xzMvO8Ru3lnSuim76x7c+1419mEVu+gR1Apkb4mwisyhDa0YeLv4F0bWLGLYJoJvR+t05D6T2KnH/lEnvUG9evzSW41wqbMWjOIn8KhKRjk+XHwpH+oP20/1eLnle6q2NsiQCo8eXtv/bylSRlDwLLERMi7ruz38x1Awr9WN2PhrSFcaIgyuKQm/bXhJHxefq67hPCqm4rBzdz6exEFzbUbeIXiziaLFShBYMIICQySsDvYkBgpJ+oQz57+/ubAxZEdnCIryOqbpoOhoCh2h65Q8AfbGFUaIvwt9ODPRbA1pknMD76OCK7sp7dA4d+c/89fuODmh9eqCfCgebh6JBWj8KKBjBP/J4dcpPmLUxOAdm/+82Bh5uMlBlzAI63dlh9IOxyB/jTKIvcCuIb9b5P7xMPcInf/Qtu5n8eGK6JZH3rwg5JL3yqWACTf98RQWmctbugAVjRq7HzgrKpSkL4hzOzlXmsMsKIGt6XIkDQHXk7il96gr/l4/Hdu+tTLIa5PPl+GLL2v2/YTguRPRGuQbD+zsjoPhatb3BhhpBtP8V/8ukEZT9INL3drz4MTMJwbSAQrQ5Eo45RJBU/Kc0ax9wJOseWloIqUhnY/y+r7I9wLgp4+0ox0+v8Bbbt8LsnkUUwC+d+NbDw25uECqgHrh440pb6suK0ucdyzboXS7Y,iv:aAtOaFyoloxn/qZ8VbgdWVGb6BLb/U3isEzreuGz7Zk=,tag:u2knwTPluDPN1+04dI3c9A==,type:str]
        key: ENC[AES256_GCM,data:JE2Z5Xa8ARHj4mawb4mupjUg1ON1aEmAs/h/65Q1HFh/ST4Cjg5NcFs86C/7A19YZTJe6WGMzDsYQytTXcTrEXgq2VBnr66saRXFO38zH/t2Dba0OaOqldeTqPNeJS0uupnGEapQzN/vJyhH5+2Jejc/DfA+CHQn4ZyQODib+8e1z9JlWWeUBD/amfPlYnfGboWVQIPeSmJSBfYrPmDOYEj2RWqTLrQrvNipMTEp2oAGCP1Qd3MNe3d6sNdc4wXWkouiIH6BdxFlKT1nhz7P6gN5bseAsrXfXXMsNqm89e0PJaCNtgNHNGIaKUogJbyoPtJCzcMsqFIz4wp13buPR8x8BNgazt1pWbBGnEtkMAXB+N9Y7Q3ahCocDDAa5jWQPakmnzP2XI5CNWnIXqdz9Q==,iv:Qd/azcVBzp5zkRLhMLSk7J6666Z1lCx+9w73Mjd6S18=,tag:nxbA5kmFRPe+7ea0TbZ12A==,type:str]
    serviceAccount:
        key: ENC[AES256_GCM,data:1H+ywrPSJPF4oRI0+YrKx8lPxnX8d/992E12TGxUr9EJs8k5cYSEXL8rACY2yQ/gIxoS1hBgTkC1NiWx4UufrDjnxeJPtmsSyrSHWG/JBx/LU2+Cf7ZACgbjbC3gsHnb4rXjpKbhMNAqBWRcwbw5MOoWAF+T2wzP2QZ8gltkro35V9xymMsoJbxo69bQjwa7G8yg+xQ+rexDk89CfcVl2pkqIwFBL7k0lgh/qXMT243utj7CunrlPHO1igc/Qf2Ze6xgUjbJiEPc3IjZkACBS/0pSmtykucQP5iZmEM4YqGl01YUxr8nzraaimeD6vrLrF/8Cyp+cBHKnKnVuWzmb3+y2kuxmQCUG10JoZc5Pj+wRfJfH/M3N6xklSGqRVECzBXmTvPdXlZLgHEUBr8S9g==,iv:l008y+QWrb2AHWXO8yPLJhlKI8GboT7krm3qxORvumo=,tag:vHGxJHPH0REGw+VNl/884Q==,type:str]
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.30.3
        certSANs:
            - k8s.monosense.io
            - 172.16.11.20
            - 127.0.0.1
        disablePodSecurityPolicy: true
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    proxy:
        disabled: true
        image: registry.k8s.io/kube-proxy:v1.30.3
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:EW/yiZPXS9WwqEaOTRvaDxkd4YwgMpHUykkaRAbXqkonwfPOc1e3r6BVJz+TuhBt46PdpxGW79cO4dyfW6BUgGr2r772OeDuXEWAdz3vG6hQt6eIkSgHeDLRZWx67Kbu3jcX6fGzLLv6EmiWREx4bdc0FWwp4VfvG96AhTqSLouzgBHU6wUGJuDSco+oWHLUQzbm2mcEO+YNvjZ3b1KMh16AjR1yKbrpf66Dfw/eGNzv9ScHQu9O/IGo+wnYieWD6wsEh5mRoxFKY7r8XaS2ujokmGGYld24RrdcG8XRgw0W933gsi5GShniozLaYglk0i10PTxsRAh3lrQnDJFeyXWL486HDYjPhLcAr0jwghE4Q4TmzZsURVsG/MYc/GUpRTrVQWUSgojkeu8EZKLDeWEFUFiOs7Lba8H43z/QReZz8j3iDXGTDhDNmTIDNdlMOeUL9xPAMmQ4P+abzPbqYisX4ZdVvxoFMRacEro+H32HrZlpA/7LntpJ1Pa6br1xw/fT+Vvxou/az2aqUpUgSQk8E8XHqucMOVzp3x3vpftW2KkcPLik+6QYVchJd4HPecfpOULOsf+C+q0IENh8sXecVl17fyvEJQGr0JzM7csnJ9Dffv6adY2WIwP8BC3Om/eIModiUPS3W3Lqss0hoyMsSSj267a5x7Ah+3G3PZa4WsZw8tdY9FDbvACYtvbyZerMSKiEUUM2pNetGxE4RLMh2tLF+Sez8BuBAuYytQ7apxA4oEMIlo6a/IWGaa8nOKwOVoZM9kTQfWmO3im4Vf3yRx3mw4gHT1a1+eBPx2YDrFXRhqs0dJRUby1WPqdKvVZ2EFy0giGITxctNEQKJOyVncPXLPfkFnyoXakLLLuaThi2QaVzzRUuguB4xw4+yn7agbdY++bIZVM47c+S2yRFdJadoyH4MPsij9P44TK1R+pcS/5w5HD6iV7faKw7/2+MlkmCL6QLcLvcg7SHAGSklGycG4LLGZ8XlS3LxVtSCmo7BRUuABVl++XGEuQ9BOFfIg==,iv:FpN0RNND5Zg8zrNJsTHb+GoJfU/ruiUZwXibTWK24H8=,tag:AAIsBlt66s2FQDt87F1IZA==,type:str]
            key: ENC[AES256_GCM,data:prKk9EkDFsUnAruLQsMfuflH2F5mIrbEgC/7yKr2TVU2NU8sfyX3xlQRPJPAP6hnTeIDbcyQWAqma6VXhABTZcuXqZLwgRng8hN71P+YJEif7Qslp/FK+SxfqEY02leqS4WlyqG2ETIuk8uw5QYc6tiW8tDf2Q4xC/mjZl6spcqZLi+BsvcWVg69HnoPmV32lU0Hc/yyjRqgt99gPMkdNI3w5zK91a6kJvrkiee127pFzJHXmHXBC33mNJNVJKEw00YCthA5EgYKdeLjmTq4pP/yGXC0fKVB8A6sM+VyiPf0GJ7SiSdVyMXdkr6QBNeZB/gO38dAzNCwIfDwKsAcB9f9yQVmTVR8QoKdOGIPnp7PgtBIyXLD6R837AC8zg5EO3k/5Qr3fT2AEnWOUuDt5w==,iv:WATnh8De+xIbhcmrcbHJiWiWkFm7Iu72lBSjRK1LXX0=,tag:DJ6x/ntZJ05IfnmKnWWo9A==,type:str]
        extraArgs:
            listen-metrics-urls: http://0.0.0.0:2381
        advertisedSubnets:
            - 172.16.11.0/24
    coreDNS:
        disabled: true
    allowSchedulingOnMasters: true
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBzZ3VTZ3YwS1V4dEN0dDZm
            N09zc3lrRXFPcE5YZk1YMVRRb2xVOS8zaXhFCkF0T3hUWElsTmRRL0owTHh6Y21h
            MHVLdDRheTdWWlp3bit1TlRwQXlocXMKLS0tIExKZVRWSjNCZ3dPUEhJUFJhNU54
            MjBxM2pvbC9PWUJ2a1ZDRmlkaXpZY2MKQWjRYJWccDjKCfFrHbi8bNUG167EWHz1
            TapPW0aq1nqJQeUzfT36gvxEzvWTr7lsbrCKEafNVjwznFkgYO0FUg==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-09-09T02:02:00Z"
    mac: ENC[AES256_GCM,data:NsAvOK0m5iCgNhZ/o0Mkr+2t0yKbILx8n53HftDSNLwBzwEdj6KHPt4Jk2G3+B3xifeJbalj7H/2ywbttptJnp4gae6Rw/g9KGwcMnci0OF0iEhXrQybZkYCKYS8/ljK4VS7AXPTyXp45SJIMH+K5r4+KpT96BnDb99e6j6z/Ho=,iv:c71liQGeK2dY4OUhJPy446AWOw+J3lrVwavKXHmvP9k=,tag:2bxHLn489ZcgLtZBCm9u/g==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.8.1
