version: v1alpha1
debug: false
persist: true
machine:
    type: controlplane
    token: ENC[AES256_GCM,data:D43xZa5vzKAv5gNumAhLfjLQj8ZzErA=,iv:xMFwPWbkbyI758O1kg1W6JVkSBaj+8VcO5C0VsMz3wk=,tag:wJLlWAcOGmcfG15Txeoo3Q==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:ZrbuFXLPh6nCm9LuEv71Td44btElUl3eW8edrAwY2TLIvx2J29nvfPoHtH/Y/NkVg6rjQSbqbgkwzEILr/+eFDxfZgfZbajqSfQIGpfEHdom0hwJ/P8fY0yAeyNc0t3D5ReNsJ2UIg06TyHzWzr8aNLDwz5814qnkf3ESBmw4mDmpwQbAYHrhYS+q7q/QDIg/4V4pXwLkHYKRbbHza4SgEHXvNiKmHdxw960QL++fECKakxlXQJMcWF6AMSM9V4q1qBv36BXygjzehWJmYzmS8EYb63ygGzFw5obRETo38PnAyTgUE7YNIDyBUVupeXCPoIE4njPyoRr52XdAsIiANE8h2GFyPvuZqnHZwKw4hiZIwuGNn0Ypv7dgdg7GwLdt+pigILCkMeH7d98msNaIyxvpp/vjyNmXl0k2dppBz3cckpqQMr1blaZBkLdl1SXysXHxERNX68Vw3AB1VS1VCe8FEkCOCvrwwqnqq108VVJjD0ZfuwPmHPkFP6mfnswco970GRR8avZeltorjzQcFY6bohfBspkCimgrVW0ri90dhLLn/pq0MJYyoHGuTOsplf214kJA1WhYWNidz/97nBxyFvAi3XYRuywLB8+ENYWrt7X1eMHg1PUdnP9wMFBGEJckhKPuhP5jJmglG6PTAaom3/fUvyAzTVLZBiRLmsI+S9gvil9ubGw+BAlRzKxRD8ashLSri5EO9LG0lfcoRkm75uv1DVhK+3ONcywW+ExRSDurv+M0ev8S7ySz+k443laANYs1FsAHFBA898s/3mF5MBXV7X/qIGT5wdVkOHEs/y14Rs8IPGI5PdKrO6Lt594UOXJ5a/6Mf4znXvVGUgrVq2viIN2CLfSmYltY/CXNCHK,iv:IdbtZ3mb2jODXHSKA12LMQscgtwT3g+Qfud9PPKG6bg=,tag:hoX6l9pg8/gN1vqMlAsOlA==,type:str]
        key: ENC[AES256_GCM,data:lN2c88P6rvn4N3UHUzmTZA2kAM7yVZLkMUhO5tsrs94xNyujy10pYxqVMvhd9JmiSzIJaf0xHLcHwlpV24YSGwIeItfuAyepEQH3fnpY60ajh1hDmTXL8GsKEVHwhOaINrTVDtUJruNy2x0dQ/KUG73AgdYcH8MCXLhGHOId17dJ6HEE/qzU4xFO4QopWETk5imE1dqRGDOR2B6YnyLoT2sRnW4iEAXylGi0knXefC0WOQNe,iv:5xV520YS4blT6m04gEIdOTImouuHHgTMbxXKAcT+miQ=,tag:2kWftYQQ6xYoTsvUhNGwng==,type:str]
    certSANs:
        - 172.16.11.20
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.30.3
        extraArgs:
            rotate-server-certificates: "true"
        extraMounts:
            - destination: /var/openebs/local
              type: bind
              source: /var/openebs/local
              options:
                - bind
                - rshared
                - rw
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        hostname: p-tlx-k8s-m1.monosense.io
        interfaces:
            - interface: eth0
              ignore: true
            - interface: bond0
              bond:
                interfaces: []
                deviceSelectors:
                    - hardwareAddr: ec:0d:9a:02:85:30
                    - hardwareAddr: ec:0d:9a:02:85:31
                mode: active-backup
                miimon: 100
              mtu: 9000
              dhcp: true
              vip:
                ip: 172.16.11.20
        nameservers:
            - 172.16.11.9
            - 172.16.11.11
        extraHostEntries:
            - ip: 172.16.11.20
              aliases:
                - k8s.monosense.io
                - main.monosense.io
        disableSearchDomain: true
    install:
        disk: /dev/sda
        extraKernelArgs:
            - net.ifnames=0
            - mitigations=off
            - module_blacklist=e1000e
            - talos.logging.kernel=udp://vector.monosense.io:6001/
        image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.11.254
            - 172.16.11.9
            - 172.16.11.11
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "1048576"
        kernel.randomize_va_space: "0"
        net.core.netdev_max_backlog: "30000"
        net.core.rmem_max: "67108864"
        net.core.wmem_max: "67108864"
        net.ipv4.tcp_rmem: 4096 87380 33554432
        net.ipv4.tcp_tw_reuse: "1"
        net.ipv4.tcp_window_scaling: "1"
        net.ipv4.tcp_wmem: 4096 65536 33554432
    features:
        rbac: true
        stableHostname: true
        kubernetesTalosAPIAccess:
            enabled: true
            allowedRoles:
                - os:admin
            allowedKubernetesNamespaces:
                - system-upgrade
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
            forwardKubeDNSToHost: false
            resolveMemberNames: true
    logging:
        destinations:
            - endpoint: udp://vector.monosense.io:6002
              format: json_lines
    nodeLabels:
        topology.kubernetes.io/region: main
        topology.kubernetes.io/zone: m
cluster:
    id: ENC[AES256_GCM,data:WtV/BQOPyvYgfkRSN6aboHXea8QrQlnrxuF/ApXDyL0ielfHNRsMDCbFVLE=,iv:Axhqhn14ZNhMmcOFzqfAGdClLTvfka6BHiAdSCtNgxM=,tag:vdVlE4c9yTNu/d0FX9WA/g==,type:str]
    secret: ENC[AES256_GCM,data:3ZZue++mQ2g7ayo3YnKcJSCa70o9FBGfLPUXUK55cHZoE/eqBL4nRSJKa2w=,iv:SbDLsM8njybdrmzV9BUDq/3SO5kCZtNOE6UGP9UQ3Xo=,tag:s7R9PXuGbOuMOSgG/2VoKw==,type:str]
    controlPlane:
        endpoint: https://k8s.monosense.io:6443
    clusterName: main
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.42.0.0/16
        serviceSubnets:
            - 10.43.0.0/16
    token: ENC[AES256_GCM,data:s0FU1kfumdyy4OFeymx0D6gjAHne2U0=,iv:0j6F2BsU9/WhZZE4DmUwOF+QwMJuCxZXn9lIUQrWcfQ=,tag:mHI8ajeLnyKrwyf7tm8rOw==,type:str]
    secretboxEncryptionSecret: ENC[AES256_GCM,data:nBx3L4TIVzZUEEuBU6X+ei0up1aDgI440Q3ipbWRfnssrGcH/tK3qS7+LUU=,iv:ZEpYKZZfWmMiIam7yG+U3sjZySCSqkFREx13FyLw5f0=,tag:rXgiVDfFHIkUj3iJWwco9g==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:j+ovNzzFizZ1CHXX/TEyaivndv/jIl+BloECmn3neTid/SzmrrLeleBCh0wsqP5qXykNdDLtZrgUhFGWa3n5wal725meKPxoTpdtJaPAHq4UGhK7KV9mPebaZ7q9B7MNekIjMxoUkOWEVypk5tDbVC9LtUG8CjO5ZIQrfhW+1KFhQdFQA0IuOlj4O11/Wr/rMGWEbCgR7EHk0sdKvdPhRUI1KjyEWrCeFCkgmeeJIkSr2XNzF0NaakGDZ812/1BSvbJV7wQKMP6+Goq3aYQguFQj8sjT31A7FG4tB56/Fr7HQEOjaLXfWorCWb+oaQLYDqfTeMjUmIdsEhaFsH96mrH3tgPgzMaev/56QRhS6h6U6lC2MMAK3Pw33A2opkd4eDVzTSEXpuQVsJKAY5ITMHt+DsS4uusXOFEsAifG0z80j6dZeZpJq+ghmFteXqCM+YClpuRDMpv7o9YstwZCrDgG8il4odH7Wy7FJz+2ezB4FYxqxGR02k2cmIDpNGNDZH6R1vQ9rjJOpIQ/yrOLLqRlxEo8VlGG+zTpZKCYj4cWyEWNaLlHfdCOC7Rxx/iroragUrm9HOwXNeOUiKLDqfvKp4o9m5FLOHRp5CNqZPPjGV8YEFRjmbiMVBhfc4d8oK04WsMwr/zHs+RJtsRM4vSN0QlYfzOSPMBiLvTsv0vCG2A5ClQprhi7PpvUfftkkeyVf6zFormuFU7IBv2guoOEc8jxpnTZfeWSoZLQVvtk/xg03oZfoKUSYAy12MMT0bEEe5BuYiA6qv8fAiZmuf9d5IPwbft60/wQ4rXxIMDKSHqOnMHxShfQ55vtKWrBZ5gojRUciKCvN7+H4U0c6uMORMkF3XIudtj88IQumUN7/FbcT7vNfkB/JvVVfMNI0F3aHFFalTSZMsPMFEVqYJKp/kBJ14OSGHRovrVtwHRNvsk7lCuswqbBZufuT0pPrk+DcMqi8zpZK3LK0e2YRjZtiPQdA/ry5QcN/j4uVSfGhh3RpZ7dCcUI65TEzpfGSNO7R4lOAPGeZtL7u0+BZwD8RD0/yn2Rs50k8Q==,iv:/l24fGoE/LlOMmTc0jTqlvvIUoM145Pgu+KE2hJN7/U=,tag:KnJPEWJ2ujdJkgNAAyoyFA==,type:str]
        key: ENC[AES256_GCM,data:Cz3lEKEO7zENL1POQEZokwaL3jt5CZCt6SKG+mx41ZR9aooZtIWIx1iTA7P7Gu8hTbs4xcJ5k8b2pmEZklnDaVzhtJjPEWD/opn8zw6qRaBela1lKfgKiZloQuXXpcfBkDoCSTm9dmmoYTHSVDaks9jbWih9sBhQ/q1/ffVV3EVMzNXOYa0ZV2CN76ITvrcmtug3YUJyG+GR94hTH8EJsQ+fqcdaeXW9nGnAbMCpEnUSywclVY6SkAj40grtiqkE3g7EoTFEr8Q3vNPiv5nAf/Nh9tk9ijUKcrX4/KvtrRWusRq+MHPnNsqOAaH7q4Bc5v/CEnF4bsfk4MF1kay7JT+peGy3W+YUetF0OPvWpTdC7Uefx5DEiZLyOMGJA+SVUuHLHrVOfYiz4WDZsqJ1Bg==,iv:qLuUrE5UyEE1MD9fIuMMgdf+5BMFoXu21QTWdUWXXjQ=,tag:j8BQS5YeqNxCvR/WohbsOA==,type:str]
    aggregatorCA:
        crt: ENC[AES256_GCM,data:Q3vTue0hQyYg4rjMnQauUBhW2nbOWFJCGIRxjv+e8dCPBE2MJBgsQSSxw96+2vqD4Y9qGfjxdof79LhKHmC1XD68/rg0wOvMlOMBvof+qLhzd32TjHa5GFarnEAV4z9Qqr47nlo1XINLL8Ea/rlZd7RZ7zGz1mgz1ZWZsMA4HaphhyfkgIGI3nmvK7k3q+AvUCCCmkWQV4PiTZViI/DqOEQK8m07UZXNV/u2kGnG+uEzzDF22Gz3DOcFl/JnC6EUn6PY/YovMfthfXUDD1oTzyA8A1eL2IT5Spraz67DVPRUKo+xg7iC0sM1It4chMrnI3c7r+9qctIO9mBafp7Shvkl0n0ok/bUxNnlsyx9d/cwNXJO6jbnP2VyofNmhNbRC1DQvoXVI0ElirKi276LLFkVbmmUB++mXl4yWKh9rMs2Di1t9McTt0f7rXRQy63aFKBLqoMwT+Bh/6RYQ0MAKrXx1HN8+evVdFmf0I7SSsL7kcmdlGTpLomYExjjViOFi2ezaHjubeX076iFD55wUDovdpVC8wvdHirB6DGvVAqRMwgMVnQm6WYngM5Uv3O+/CPrqzu+brf74XWgutZ3sN3L6kikvitE76GYspnFlqmu2IJlnUVKvdKhiG66OHKGCUMPztwZggY4Vkst+GPUoeUCjpnIgCK260XEUPBFed+JMVffmgDnAMDpg8uXvOdHu9MvvkRBEyvoBir80mLpY+mKnnbUh/BcRSj1iZO9PEHt0WAfLMKn+RqDrVE+J8gvUb92gLbWkJGwF6U4J35JVI7LUQJCcBOhjFU5eZ8lRxk/ey6OIJOJSGxM1647+7RuTfZPQwNEeQnKC9QjRhjB7WnylTQ+1NGgXwfFMY95G9WSKj9UKsbnSbHFI7nyNMgi+G4h0W8DtTPe8IYKQny9wDAzoFBYlqBlWOEpY3G+sX7d8XsA3oQEeOPJLe6lPqT3,iv:gt7xZVEk5uEt9BG0PmlcvyGJbZEmkucXTR1YmbXlRLg=,tag:vdCuhEWMtFvjO9nuDH0pAQ==,type:str]
        key: ENC[AES256_GCM,data:fweo2Ivu+fZdbYbi5In59k+U8cQ1nfSkt2ebd3EChWZD1N9Mby7suiw6ogusW3+FoyWNgztbAonwTL/3qLFQf3vJ2bFcC+OLAelWmSe8Rnl0Wa80pEjGO5CODIx9MkOyUcrTeOTSEXn86lB+e4s3Qml/V8sDsC7DuWIBdBWvU4NXwFCG5BH20UVDjxXTAHK1YyT4DxCcGLrMGv6Tohg7ME7aQzhZkdwFSc6FPiosvPShlZ+fJUQvx1MdJvngAWge60YKzNZTHdvxAr/voMocBS7XjZszpm4w1g9BM6zzSm2Ak7oMC6ngAp6M+074IJSxN7XfGXBH58GoqlDKFHk46RLXkBUxUFomeMI8AcfyYFU63OUJoryYze9moryYPVVAjgk5XyRXQUwdo05fCqGFRg==,iv:kpatQ3SBZo9ztu0eN3QHueB3l68rJAI7LeQa6dExnfM=,tag:jx0Z/wSxqEYNr0ngQ3tI+Q==,type:str]
    serviceAccount:
        key: ENC[AES256_GCM,data:66Han7oTiGm/jaoFwYWT9ICOGAvGXZvTL2DQf4ttXlGR3xG7V8IgZgJcwHJSaAAIt7tvbek8RypcSoH3rnKP4bD/TjCBNv0WTxTolvJ/WFDu8MD41N3e+wS56/EDAudTink6O1UAQXZEeVDkaGcJrXq5B/mRYkTdfANC9sHFgWLVtzDf60MgbKGGRRQFTXmJtoxxAHq6HtVQ0zd89N8uqWuWTOOkPHL6vSpb9r2yrNF6wBQLY+gilaMeHCXrA+Dp4lQqfx/BmT79EifV2+vN/FlQg4urAxtiImZX7pwmbAeBehBt/qn5RgYMYmOZBalgxpUhCVQDPmChwCwAGXzYkSTK/L1mjyTeQ2dDNpHWJ8RzGLqiD/zz5oSfCmjrNZbxSZEJWbuOmtcTXn3bs3tKsQ==,iv:WP2fyLGeA3gNDZhdVob0eSTBmLA6GFYwD/Z7zxGm4d0=,tag:jDb9ZssOQR+Cp9qIoPx/wA==,type:str]
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.30.3
        certSANs:
            - k8s.monosense.io
            - 172.16.11.20
            - 127.0.0.1
        disablePodSecurityPolicy: true
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    proxy:
        disabled: true
        image: registry.k8s.io/kube-proxy:v1.30.3
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:k8yAgRbmVnmZSQKtRvFxqOw2LkHHNsIxFTay+Tl3e4JGcXjB73DhZ12ZJMzSsrTExAHBym1D+c5ys17PwSWBLu5FA5kQFmMky85l/Yd7SCsDpqHMN/YyxFbJ1ksmLJr350cLPtFMeSIKQyhXhAd2OteOAJ9ZrONSdOzLI7wjWn7gQ1t+t0K4jfVbACDNhcCiGpcgQ4ifDU1yEJQDrjTykINQmbDmUg19v/PTV402cA7yL2xThMWW7Hsm5KfvP/yub+6OGxxzytIPI/y95Hsl7QlVXX3yz/Fc8r+p63Q/N/tfFSEvggXrfY2sIMKpVbxsT40oxIgf7Jcugi0EOLkpPZkf6m31Lu1y4EkdowJ8qVWhG/ecz24fJkFQmLDFcoPje0iclQCrfgx7VLLxHjL1o5cuionaLcDAr9E5uQTswqm5BBfuwylBjrx5kV5Nf7NWs8SDhWEpRzGYudufW8y+Z7r5Caaba/pt23FcCr3Vk4iLSLQQtnbST1pNGQ8Eds+hhyjQNNrZ/ipoyKzjpYc8z5kuMONKDdR2bpRp2D+3EcqPtIS2HyKf+PqKUJ1OCZxu2CKKoJ6SqbFG6kYKxdG9CRwr+gksG7+MOO8PFa7LBitfC4+uw2CU4cj9Uthg9a29SL8fHKKe0MbGDbxK1IhA33frDDEekCaG8Lmt2NJyb1NbrkkFsmOy1vGcHqBygPlzTqxz+p0uWreQS1F2Smu0H7HFO5Ba1zOFOgh6rnOQKhlUGgRXrwaIHUIoaRagSS+4HqZVROFrlWgwH/J4RrOQ5BlNsLzKPGTsu18yVy6KYK6P3ovHCm8cQ97qkobuJiLObpITJKgW2QGGNFYx3gk5fVRW1TS1C+gfrXqsGdRG3jgomO0bZKZQ50d3apimtUhfqsr8l1soAftUUi1BXHzEyxFMQFJIAmw2yIRJoPvR+QDmDrTnhTogPrT7Do/bB8zROE60x+XP2zKeZ0KzN8iXoVYesH7e0CsrIMxdF5u73AONLjcXrLM0puwy0awWrThrOWcfiw==,iv:rVArGyaZljaczJ6w3ARjZFLx0n5P9AuDajf+yv8gEpI=,tag:5yjZM1AW2rwGT58Vdy6+yQ==,type:str]
            key: ENC[AES256_GCM,data:B+m0Pr3TK8xH+M0+aCycWzJ1C3NpcZ7a5e2fWqVi7NHuzfnuGK3EVM+8aaqbzs/DS/1TowUu614DIH06iOP/qjoNCNXcz2TXAihTdYRAlwyhlCgRIOMsEhf0Wq7L6STwBPNBsFMXztcoXCn/t3AfKt9RV7pgJ+AnNMCgxJ4pVKAojKs3f+hNNt3mL3/hNRkDkOR1sD8AwY58EnrzAsLBPsICZLDWZG4k9vb82TJ2ffJnNy7OrpnsyJB7eBCkoKc0YAsP8Enl9khao+t/N3w/B2Q2DgH5o0AEjt8vxPbDizMghXY34wGXqVkKGa7S5Mm1vez4BVnWOD1mL+fbF7/FGNLE81neUAoa+3nNnNo/rgiZzjKPKmtABi6okQX0wrxJxzo9FFoK05unievD/s+2oQ==,iv:UfeOeWVUNdMc7WJuZhXnANRfmayq1xnm/o452GMx5+M=,tag:WYAdtMp75g/L1BfEddxcrw==,type:str]
        extraArgs:
            listen-metrics-urls: http://0.0.0.0:2381
        advertisedSubnets:
            - 172.16.11.0/24
    coreDNS:
        disabled: true
    allowSchedulingOnMasters: true
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSArZVZuTXFZa3NKeEVsdFk2
            MW1kQ1Z4eTYwTGtmRm9hUUZtTXE4TmFnamtVClhsRmEzNEd4TEpTLzdUZGRPMjFD
            bjRYczhyTFpVRWEzQ1lxUFpmcHc3R3MKLS0tIEN6cjJHQStobGhKWmppeE5zUG85
            UGxiT3UyWEVhc2FUTERvZWV6eFRKV28K7jtf0E+q5QInnKN3ZDTr5cfPpBy9tHxb
            w+XmoIDY6DOvcy5YfAixwgWXqSPH6/qfjgcqOtVGYh7/p8DRVtHVBw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-08-18T07:56:26Z"
    mac: ENC[AES256_GCM,data:00cDSWhr05K9sftCzFsbxpltD27A1B/EAeumTprnUuzPm/rpbeLqdrSyhuPeOWGtNjOpbhMzvQ+tufPqeWmV6KMYJcj1Vm8JTr2SNVWV34UhpfXO/NzTvh9bzsboblsTFDsgtxyJC97H5BZgnM6WcB2tL4H57f4kBsu5eKstplk=,iv:oxF/K2/cDm4/R/O664tIGDGW0tQbY3gsC0QjloTthdk=,tag:D2kekUK4nsBygWGSt7aNtA==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.8.1
