version: v1alpha1
debug: false
persist: true
machine:
  type: controlplane
  token: ENC[AES256_GCM,data:GOtNg5WBD3AsuA/8VnDPVqSr2Vv44ag=,iv:HGaOuZVCKE4raOW7kpMPkqwn3j/VNTmNz9SOxzX00Dc=,tag:Te5ATbrOvWXAIFenlDUQkw==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:QqYevJt36S71DWY41he8AxRkJmGX6toZH+PPywMAwjXrubxYHmkJQaS3Zyf7Y9otgzbmnGZvu2r+kcnm+IvlqemkfOu5K9N7Y3pX43LcM3FIe0kG/FLs9tEPRB3Qs+XFhk4sbvxidpzQdWBGyLLMwmD1z+klcSbYBsrAcN07Nqb98leuoZWDLiyuurhyvdRs485dPNbZcYxgALGNutiRWgU7u0iieSGOW3hoHRLyj6ya3QbZYLtGRwBnpL8h4g5Em6TzMkWmYNVLfLmhcO8ntefsstciTQ5io3SfmczAfuNTHH4EksHCKppjGL87P9Nt9EWRjcJUGKPLQE2UgaagjMerBD5J6OAAO+2nt2FvA1BsN8CEMfEZEsEP1yMroAjzdGHrUawD1ZCOiwPiEO/3t3Trto1lKY4EGA9hTH8maqu+R7cSUI4G/bgqvQCndBkOD9j6qQLREOH/RNuQHxMiz7k6i/VwfIeE/WA5ou54Pa9KDKGIkFzQ9FycMgpFG6lBhdb9x4RyLRdK+0lV1DRoy0l0MSfmDxBtxGBfJzY3scxFmZaXU9Es9RcjU6cwzr6O/BO/FKMT7f98vbf5E15FjJEEXmkx+BNY1NMfbHcrXbIcMYVUo7Vrapj4LzoQd5z+yr+CWhPyh9gMMORR2z6z9ekvnrr9jcBLP8TRcNLseWkW28/zCn+gWXNy2MFixJUe5b8HQyaQBTy2qofgEwsCB6KL5uX4M9/e+8elo6bB83umpvOFOtUvDQHANbSS2AcFS28FeByh+B4GUxV24SMXftaWJIUZGiByc1RkGacgH7iNRZBQkyija+w4HEe+YJx+KWfBFwYWOvWXx2NIJfOKoTuvBxO7tqhxLYUnqdyVxj7G+BUW,iv:WsyNGT0+72dvOeRtU2xIm/s6NhZ++IbQ31ZQohD529c=,tag:SAnvEf1qFCtM7tymNmoBsw==,type:str]
    key: ENC[AES256_GCM,data:HvvlNuDSHWiQuucia0PdX5bdEZTXzZUsswsa8ABmAhF6WjgjsPthGfC5HkbRSXhSF8cLaCioKGLji7S4vqTYN6JLBJ531ArgRFNo7r2qXh9DE7eItDbwnB+6PJmiucFEtOwFhfjCVyPG5wjjsUntdvD61anypKI2LcRK9wpzETbLDVb4Tje+QK2o2GEnfXyruIF7cysqXdxerTqcKvrn/esXPUdvUxxf7ve5dh/6D+Hbh4iy,iv:psRxbt8UOqjNK9JXLKTn3U7V/HWnjXKdam7GUiYyGyk=,tag:WXgX/Y67RgWHI3vTQHNvWw==,type:str]
  certSANs:
    - 172.16.11.20
    - 127.0.0.1
  kubelet:
    image: ghcr.io/siderolabs/kubelet:v1.30.3
    extraArgs:
      rotate-server-certificates: "true"
    extraMounts:
      - destination: /var/openebs/local
        type: bind
        source: /var/openebs/local
        options:
          - bind
          - rshared
          - rw
    defaultRuntimeSeccompProfileEnabled: true
    nodeIP:
      validSubnets:
        - 172.16.11.0/24
    disableManifestsDirectory: true
  network:
    hostname: p-tlx-k8s-m1.monosense.io
    interfaces:
      - interface: eth0
        ignore: true
      - interface: bond0
        bond:
          interfaces: []
          deviceSelectors:
            - hardwareAddr: ec:0d:9a:02:85:30
            - hardwareAddr: ec:0d:9a:02:85:31
          mode: active-backup
          miimon: 100
        mtu: 9000
        dhcp: true
        vip:
          ip: 172.16.11.20
    nameservers:
      - 172.16.11.9
      - 172.16.11.11
    extraHostEntries:
      - ip: 172.16.11.20
        aliases:
          - k8s.monosense.io
          - main.monosense.io
    disableSearchDomain: true
  install:
    disk: /dev/sda
    extraKernelArgs:
      - net.ifnames=0
      - mitigations=off
      - module_blacklist=e1000e
      - talos.logging.kernel=udp://vector.monosense.io:6001/
    image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
    wipe: false
  files:
    - content: |-
        [plugins]
          [plugins."io.containerd.grpc.v1.cri"]
            enable_unprivileged_ports = true
            enable_unprivileged_icmp = true
          [plugins."io.containerd.grpc.v1.cri".containerd]
            discard_unpacked_layers = false
          [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
            discard_unpacked_layers = false
      permissions: 0
      path: /etc/cri/conf.d/20-customization.part
      op: create
    - content: |-
        [ NFSMount_Global_Options ]
        nfsvers=4.2
        hard=True
        noatime=True
        nodiratime=True
        rsize=131072
        wsize=131072
        nconnect=8
      permissions: 420
      path: /etc/nfsmount.conf
      op: overwrite
  time:
    disabled: false
    servers:
      - 172.16.11.254
      - 172.16.11.9
      - 172.16.11.11
  sysctls:
    fs.inotify.max_user_instances: "8192"
    fs.inotify.max_user_watches: "1048576"
    kernel.randomize_va_space: "0"
    net.core.netdev_max_backlog: "30000"
    net.core.rmem_max: "67108864"
    net.core.wmem_max: "67108864"
    net.ipv4.tcp_rmem: 4096 87380 33554432
    net.ipv4.tcp_tw_reuse: "1"
    net.ipv4.tcp_window_scaling: "1"
    net.ipv4.tcp_wmem: 4096 65536 33554432
  features:
    rbac: true
    stableHostname: true
    kubernetesTalosAPIAccess:
      enabled: true
      allowedRoles:
        - os:admin
      allowedKubernetesNamespaces:
        - system-upgrade
    apidCheckExtKeyUsage: true
    diskQuotaSupport: true
    kubePrism:
      enabled: true
      port: 7445
    hostDNS:
      enabled: true
      forwardKubeDNSToHost: false
      resolveMemberNames: true
  logging:
    destinations:
      - endpoint: udp://vector.monosense.io:6002
        format: json_lines
  nodeLabels:
    topology.kubernetes.io/region: main
    topology.kubernetes.io/zone: m
cluster:
  id: ENC[AES256_GCM,data:ituet/dk8qFD9zxgfKLk2aM/F/73A0QptyDWvq5QPZoFkOT1V6/nWgf3neg=,iv:9QZQsj+KAC/SzDycjb+nyrnYKhaDMLRWEhKXhRDlqwU=,tag:DNm4UQ2AdiTNta50x44Llg==,type:str]
  secret: ENC[AES256_GCM,data:zCCNsLrzgqRe/4m5AM7luR5AyO3QzkO95mbGoEZavcBf9HQ+MAyRZlygh2k=,iv:9RUfo/5Rx6ECo1AfZ8C/3yDs6VGm97carvr2Uv2++6k=,tag:uOIxrmnXT90dp/GQRdH3rQ==,type:str]
  controlPlane:
    endpoint: https://k8s.monosense.io:6443
  clusterName: main
  network:
    cni:
      name: none
    dnsDomain: cluster.local
    podSubnets:
      - 10.42.0.0/16
    serviceSubnets:
      - 10.43.0.0/16
  token: ENC[AES256_GCM,data:kjeN7lAjXBs+KAhDQJPvqaYM0aeeO1Q=,iv:cDjgWREtKKhRbtkDiKqeIaUGR6neVzz/mAdVFzGO7GI=,tag:jv0uC/bXOpXVw5y4wwRZ2w==,type:str]
  secretboxEncryptionSecret: ENC[AES256_GCM,data:pBCds02QB3D5dNz9FNjtwJp7OaQVNQeIf6DIozH72queWzMXLLzR2dsMMyg=,iv:jbAv95cIVpbztrnYgNfjyua4va9cqwt09DXjKpWM+t0=,tag:yQDU65m70qqjGJnPnjg47A==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:iqTmBdqyf3QU5EEVRDL5RX2UC10j4HbbSqHGd/D48myYcUdf5t76f9niqu4W4UUgEFGXX01666sfSuxX4Bh342OlTl19fUeTmimcxOuMdtP4fSGzFO3ozVVMW/y0gDX3qV5u8No/cV+cuBuAbza4xUJm4nhC5EGY/JFGThobHiD52lJMeuP3WI4exERZbFfFYfNEchFRrixqcERkzNLenqXML2BjxyAWdSYzI0jZ9QCdvsVnmLkzWDBEG0Ulcc/U0Lh5dC+ClmO2Q5wK35L7GnRILD7zzN+j7MLE0tztLm4lrR0xqGVaEDz/8qFMOFK39nosV09dBsnytfu92izsheY0CFsLrk0BR5MpSCtL2irCJUK9xXrGcUkb5AiBcEVaN8FQiCRwx3d+tenpLKCNqvUrEPueRz1n8Y0hBUm0fW6RFFVXQgUVBH4gInLO/v0fj6UCqoeRhrapXXYgpYTdo81NbwpW2Uwm53aeMT9n/K5iklLKcsAa04Jjojqg2prmyGg9k2zklVyhl/MsVNs0CJXAtCQPUIWzzQSeJlqc5bSdX2k7ksoDeFYmNuN0Ut5Ge2BqVuZjNC+R93ISU1eRjgwC3VPdnt8axikjvWpAlB3JghX6j5+5wF8ZBvjzAbz1MJhF4dGA37jrByyNSRrKagijZYMaC9mAUm/2lDuy6AkE0cMACgIgfiQDAfRWf3QpB3e+U+IAWF1AbbFz+vWpdghX6fFipo0ZTk+eFZ/ExFZWgVhoRhUiHWKmDFBVYEGJ1RNHyYODHzn5ivrXg2Akkppu7kswKycAIx+3tuTht6EIxmMx+8ERvlwmVP07aDSObn//4+nE/7nuOIuGeQIGAstuJviwNyZcWenXPa/lr3cLd3N8ti0Fdex5SFEZdzMxDP8VsKvmsL57J+2tviKLsfqVt+KNLlhH8mDShzOQIgS3SwFXHghRVdO+2rgdLxo4L16Pqz2aZ3V2rSBxWHydFjA9mPRU37RKytupqJ+l8g80iq2kytpvTmDVxUqOfK+2u9EJEKBxZmEupJs5gtranI3bTXfWRLKXZMIbeA==,iv:4Nkpw32GZvy3bD7GvFsccTkiDgg4T4GQpb28EpqKQBc=,tag:yYyxCoa3or89/q/jBj7JHw==,type:str]
    key: ENC[AES256_GCM,data:FpvI2Qn8gsLeTPNEeTA98UldniFUl/oo6ZGQxNleeJCeg+5fJT4Y0JU6GrLYd5cvzhut2J5Uxm61LeQgGjpUtTGoXyFPPJufaFJ1i4Z2NYhtT5d7PwPYgnPYDoH2voc67gMxFtjfsEKH+qWq/q6DxMKJ4Qvyfs07sH2OJnqEIrl5kR8yiWy2i5BQysl9m0CJTZJP7J2nIZ7YnqR89OL1ydsWLqq6uqN46TycAWS4jw6aW+8QiKqAhNOxoWkrxN2o6Jjg4ne1LpHiLmVmPgnd86l2NrX2dY37Vlrl5ZDTs7Xr9CSGY2QYLex3atj+LnVRvgQFxACPv0iUqX3/CMX16WtjVEktTQ49vbkAIs4FQ/4Lv5SLlwzAkAejlicHioioby3UaV8oqLueQjyXiiynfQ==,iv:AF2odfOXkVWOdTlYFRXnW8OIgOIQZNbkNws93Jd7PG0=,tag:XYv/aVC8Kmq7enU2OWsIkg==,type:str]
  aggregatorCA:
    crt: ENC[AES256_GCM,data:EtQdUO3rTOJ2zv2tYGreLNAW7IIWOQfCK0O0jBnA5hnIXoIHm3wj5w/FYIyqNsm5RH2LZ9zzMaR9/WMTeWeY+KZg+ZiCzfOQtUE/odAnslg/CZ+bunWnfoYlIUBcXBQVug8Fl3ii3A/lLw1vJWFfxY/th2YjB8Y/VDIzvQnEiK4Xqp1fxyiyks30qEHudFXisS3kQKl6YQ/TG5uI678SVvn6SFn/yTrI1OsJ40TUGHRKbTL9RJSocyxN9I9bmtQfc/kEbEte6LZC7rO60CPcQV6cfzILoCluBARbLtQKjinQ0iLSgoHL99Yl7M9/AYD/edSoV8srG8hxoZlyQRNKj/+TtLDnnGvhDwX3LeDZj+xKcw4jyzss9GozgMEGcbqzU/tgTZf8VeI2jvqNHj1hwz5KIw7W9zNCWad2oltcTMRVsRrbsVQjYBvbXwZXolHIfkLc4XE37V76Bh1Hnzr8IK3xrQtyzn8v9VcKg6NbOGMwJ42ltxrek4BmSzNGTYn3uRwDlfkE4BeKYLqvXRsy8R8sTCvsawOfuFXmPvFv0i/paJOjoUP9SCzV8FZiF/lOt38v1StS+Bq01wdN09AJMluGoY/nfdM7pwdZusKdBbUR3ZaVkPSJn9tiwboCA4LK3zet05+JMAEgbnIi5Kh407VTJAiKvPQnGxB1B9t6mfw2VU+UGpJuUCxImeNE37Cc0i/xNaiyGBfRQlC4eXA6UhQkvnoTnBuDmET5OlycPS9qBXp7oq2poRTYGx06ySBqDx/u4T1D7ezrnxdgpOjAEa+v1AlDrCfjvISYvzkG3j2o11T4jh056jmOIgjW6MHeJRnzamKllASJimC2iBnQdEyDvWOBI+yTy1DlaXVTM/A1qHoyqN6A5D/gQyj3761SeJ5U1rXM0SwLOK9E6ZyS9QTMgC7Dfic1T+WOP2fH6iv830txPhNthk4lYCjcWAkY,iv:u2MRNw2Cjx2DbqVV7Jxt7VbIY7WTIntWNe8OgnKwNuo=,tag:CALl66/13qZYJv3P/8IBjA==,type:str]
    key: ENC[AES256_GCM,data:pDY5/bxbHgKfWM7geKLVD2ScCWwJFROObNQDIR+9A7SJGTFG8pHYFw6nZ2MVjJ1vdUHCpUOeXEYgdMNLqJFO82Xx5zQvqAAo8GgPQaS4Y3bmkYM8bZ6hIpD7J10f8qJYo8qU0dhYS8PC0tWzAicx0O7rMEZoeh7dOQwW3vR4fWYjEa7oaL0ysVEsoU3S3mOIUIFn/bJD7w3KROvv3uh3Pq1HxBSRmcPfZipBCwnv8KhpgRkfCVz9T0pz9pzX9L+AQM7sUqDRiYVhkJl3SopOi8JOFj1x2x4TiD0/XT5T0KJrUwCcfS0Ir3H9pb6aVPy0SbmxBSU2XkvxnvzQoVuqbiDVB8NUeyTIoPAL4H5Y7pVRteUEEP9V77p89HMRJ745tyawLED2r29L0wJ1tT4Q+Q==,iv:bVmK6NiJoi80OTuPY32oUyTmov9UQCotE81Qgw++ddw=,tag:9tKfhGiZb1ZT4plkKeUVtw==,type:str]
  serviceAccount:
    key: ENC[AES256_GCM,data:DVfBJbmA/QH4SF3tERSngSovbsUAuMseqCJmAYgZJpmJBEdY0leDDiBaKyMp8fTIoI1f1ADrfnLOr70BcvU5wkpn9lmNivcaKlJi6niWoB8V6moRpXJRsOHYwLItsp7PsZ8Q8xsGlefKjI60JeFutJw3eIhLW9t30F47qflac+kM5Pe4enENRpCIE3FcaUQS4ii1mZY2c9oi11wbD4eN9wFlSeGCEkrSDBkPDUdBOhYlsrHIoWoolhFAvsV95+feVBujHiExdAKZvJ0acXoJO21J0EnfeAn/kA2c+zwwOJmc6kVa/jn0Fa48ZhplS06ekviro0v4mn46MvpLhGzGalb6nJKrAzHlPNBHJNVMIxApUoFGUWVLmMBh2WqZbSuLXandACfuN9CBtMMcn766vw==,iv:bcaOd3hcA4uNacdy21KUprye1x9eQ+1x09Y3yPkS4wE=,tag:e361WV411dOfQeJHgK5S1Q==,type:str]
  apiServer:
    image: registry.k8s.io/kube-apiserver:v1.30.3
    certSANs:
      - k8s.monosense.io
      - 172.16.11.20
      - 127.0.0.1
    disablePodSecurityPolicy: true
    auditPolicy:
      apiVersion: audit.k8s.io/v1
      kind: Policy
      rules:
        - level: Metadata
  controllerManager:
    image: registry.k8s.io/kube-controller-manager:v1.30.3
    extraArgs:
      bind-address: 0.0.0.0
  proxy:
    disabled: true
    image: registry.k8s.io/kube-proxy:v1.30.3
  scheduler:
    image: registry.k8s.io/kube-scheduler:v1.30.3
    extraArgs:
      bind-address: 0.0.0.0
  discovery:
    enabled: true
    registries:
      kubernetes:
        disabled: false
      service:
        disabled: false
  etcd:
    ca:
      crt: ENC[AES256_GCM,data:WTxdPneq6NZqtdj6wn7TO0k/NshYaTiQlvyS4V28gIYSC1vzg+HdxbZdDFvPTYE3EMwSMJmgPiVBJSJKOyEbLNGBXCVwfhGecJdqarNMHamRNRz84NjQdjoy/laff84/b5zOMsxfpFHr8lLnuZEaZerJjmIsyRJhB3kolp7jI45IuJQ/lZNtoyWzCIglk2K7HIGydL/2aKr/wyUaeBmD+SFoGZNJvrL+wRmyPBaD3kqOEPydbNvcHtP3VzG21WCCdnfR64GsKcxJVEnHb0zsxwKrIct8Gk13o26LCRwghmy4uRmPaOZocmxYEHd7uloMhhYAPIFvzyKTaRQRHlp9W1aCUFKQshzJizEKbEt8OlLmLuxMHMDuK+BDv978TFwafnYKo4KNnrhWqy2CEgEFqPeXpCA5DYVpa/mfwP5rPa71IhP1jHhKdQ7gW3vbPG+xcEFZSvRH+RzfoEwSdi8O3iCMMC+w6s2lJcDFUrLtwYGqnM8xArOa+s0WzNUtRtghG241i833d168pGegGDhjqBn5AVpFwXyc9mK163TaKMKWzgGI0eCVzQ0oVpS1zfEnezM29XNoKIUZ/4P1HHJ9v9EBqYJ3HUxGfZFrX1FbC+yrgHtZYS83aEdR6AUhR+pG6VA7hzRNwgn6m0vXEK1LDNcSlGnqpcmtrRMBG2fWX/H0lWBoGL8/iRA/Jr5olsxMK4cQ9pkDOdc37e+uPt6MvKxmRyJxiQfMn9lmolSuvHsAmXm2ljKVHNs1nla4xLpR7R60WgNd/CPUMGxj4j0i5zEOegnZKXfzTrOmS5yZ+3GO7EiKvsOTiSuBwr2dvWCmARGdB3aTkU6Blmkdgi9ut2B2hDQXIGwHF+aakWGb9WCZ7o+r82dGxahAL6HwFglki7y5l3FpP8J8X/jt17LbQoyCY9a40RjjwnHgmTJl7ommTyukehOuEHEn33pG1om3wYaAluU3wPMyk3bsR2h0B6f9RLadpAs/wbnS1ud1Ciqb63Y92NeU65nYg7io1kVzNm6fsQ==,iv:b8fEZ+puu3xpHn4QVcL1RBTLBqgZpXmpp/3vutlpGJ0=,tag:l/1BiX/PthiM22LmSkJzDg==,type:str]
      key: ENC[AES256_GCM,data:gh3tXfMSIirUDLv6RONwGGTym+Mw3cROZa200EoBVkiea5ppFrktMC6OGsOi4T/bDgZSRaBa/CrHVks7qPOzw8+e2hJpOhD1acyLPVUKoFILbNqAO5huwaS6Q2kEk2QrPhl3Mpv+rBOtgy9zRfEDKqOhaiGzvbCdOJ5JP6GnRWisti/frRLjbl32USCGRsAo+yOhKaGDV/8oWC3fYywZgZogbLWZOBhatJcvKL7nSq/9s9ZrNS8yvKmPEMZAxKXoTFbzy1ZCt/h7bUb4XNWPd94uQbH6tuIi4h6CorpOJh4rvbedS61Ock90Wp5FJF2uMr6IDbGnJ0XPa67ocM0ocxWxssmOjh0TnAFFaPeOCQREdcXFDC1CGD8AWYF2KcOEm4//Y4/PL3MLZcanY3pEEg==,iv:qAbB85kr6ETOow1bMZXZdLILHUydzfFJxELEl2JF1/w=,tag:Vyt2APpvD8vaShx67FtlBg==,type:str]
    extraArgs:
      listen-metrics-urls: http://0.0.0.0:2381
    advertisedSubnets:
      - 172.16.11.0/24
  coreDNS:
    disabled: true
  allowSchedulingOnMasters: true
sops:
  kms: []
  gcp_kms: []
  azure_kv: []
  hc_vault: []
  age:
    - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
      enc: |
        -----BEGIN AGE ENCRYPTED FILE-----
        YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBDRk5WdU4vTWpiaWYvR2I0
        eFhHY1VvS1ZNMDNkM1g4YkF6TnJlQ2d3cjBjCnNWM1BrL3V6bFMwUkVtbE9LaGs1
        b2xISTExdzBkYlpHWFhCdGE1TmNUR0kKLS0tIFZFSWptMVE0cmQzN0FuM1FEY3hM
        NDdMMW9xcUpTNDNjTVQ2bmJyWXo0blUKsrxR/d7p+SaI/EHObyuntrDh31ItTstx
        A4D5JQPaUQWIXhlhMuqH9DITtgb9xtmRdifg9osmDDCD1WQUT1waDQ==
        -----END AGE ENCRYPTED FILE-----
  lastmodified: "2024-08-19T12:36:17Z"
  mac: ENC[AES256_GCM,data:c3dFA0mf/ILZa2TVeWi1x10SlZW2Io9XIWmbc0Cbbljjpq2+dssUYfsucsXGHIhgmCK0uBBHzrb0v6euWjeiNs0r0EPU28WwvnW9MdvdWBFgk8SKL+UkDO6PN9Bx1Px0FaPiFKYyZroYUuG+s6lj0txQAk1j+ecxnaInSnInYr8=,iv:tFheZy7v+0fidC05EEmkzF7kMcOuoQiXNXYh2eaO4i4=,tag:0mdTAQlv9jSTntJdGKQPyQ==,type:str]
  pgp: []
  encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
  version: 3.9.0
