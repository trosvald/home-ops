version: v1alpha1
debug: false
persist: true
machine:
    type: controlplane
    token: ENC[AES256_GCM,data:RPgx5mULB2LuHLJMGgna6+Sb850RwjU=,iv:bPsJdbUYPdcOfO8SymcCsoDKFFgacLy8xw1+QNpZr+o=,tag:kEjjgQgDdxgIKf2vQqj0Kg==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:4lsa6R4ABPd3/Ys/O6Z8uqeZyx+tpOLNRBckePIVSkzDM6uoxIOrHW297L8ZlUtOrOmdld2rBHUKpxHGOWXd3eQxHZH8uOs2w1I1F2EnZIq1lIdP8VoQ2XZyC/HBOi0L2a+yOiNOTmVZqwzaMDgjpr7o8whpIEmeQLCe3KULOfZAGWqKu0mhu1jhDCpnXEUxTNp5v3Uh2ct6G5kiFsbfZeoMTUV+IdbmsD/7UQsq0Xl8UdMDzrXbXpwWPIeQYos7omcDeRiDvN5FEwvOZc6M6Zn9XN20hRHzQkG/z+bOj58VdRZgyKkrCsOZ2dVW/8xjm0gKHw3Qf5LBcVhYPC0Cz1qUGOGFeoADyxoDCEQNNaR9gvHuNNGeRYRDpCqkBcEjCJ0+bzg3xEgyaQFb6nQ+KmkOjfORTBZBijCI44Xnx3hLU6rQtNuywLP74pERY0SrU7FSQ9bvo6d56FmSiU1fNUTJG/8mfI910NJ5geE01iIheu6edTF9L5b17ek4rvlVZTPoyMZi0Knrcg7p3A1IhCmnG+m2GvBQK0eNE2RA4fY5wYlfLXmyZpPBWXmfHD50na8bcahW1VBbDnwVALv4waUwMuEomHnHzC4uWB6c9biFx86gWbX66x6Ni+0IN8mA9JkTZj1sZbDx1Zz8h5+jSiSGo/OxJ/liWiyAY/9m/ukyeSw7+dUL8LlQiFb1qb61JfFALD9WpDUTjjafTD5IhND0oFce6TBIWFoJT6kVCaALhNJg24pg72DyOgpmCq1dngre7jbM1t9nLTW3kiOpED9wO1FaASAI9e6YBBBzG+wsK0gjoJ1qp9MRLCLgeUqVyqO0qNUhtSAqjIVEkI5gJTtE2sWql2P0e+49HtmxCu+Q29+j,iv:GRzqLGmZqtXJMsc2q9aa/+Pa+F314dycRrct2tiOYBo=,tag:ksFADq+L6Pdh2LUn6UtSaA==,type:str]
        key: ENC[AES256_GCM,data:FRd7mMrRPYrZEl+WHN++rxgt4ssygtiXAIJXv48jEnO+uC7VFZKuYW7u9b/aNckrK7SSh1rnadxsVSJnUPzuZ2UEaI90Ub54aWiLT2jsYI0rUoBSME90wylx3xaQmdHmzT17o2+JsT9ZQpraXNV4s46rcbmB7VcgPn3QOENZmevnbprMbcT7vraWJWWpFDzzxnf4NCzvC6TzQ5zDj59qEHUzhWK1dVzGjVBhQJIprtl928ka,iv:yV+iKZFzPy7DqPS7hBysleGZBBbMUrek54PFrzs4A0A=,tag:3/iqfp9wxXsvOQCJG5CWUw==,type:str]
    certSANs:
        - 172.16.11.20
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.30.3
        extraArgs:
            rotate-server-certificates: "true"
        extraMounts:
            - destination: /var/openebs/local
              type: bind
              source: /var/openebs/local
              options:
                - bind
                - rshared
                - rw
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        hostname: p-tlx-k8s-m0.monosense.io
        interfaces:
            - interface: eth0
              ignore: true
            - interface: bond0
              bond:
                interfaces: []
                deviceSelectors:
                    - hardwareAddr: e4:1d:85:75:d8:73
                    - hardwareAddr: e4:1d:85:75:d8:74
                mode: active-backup
                miimon: 100
              mtu: 9000
              dhcp: true
              vip:
                ip: 172.16.11.20
        nameservers:
            - 172.16.11.9
            - 172.16.11.11
        extraHostEntries:
            - ip: 172.16.11.20
              aliases:
                - k8s.monosense.io
                - main.monosense.io
        disableSearchDomain: true
    install:
        disk: /dev/sda
        extraKernelArgs:
            - net.ifnames=0
            - mitigations=off
            - module_blacklist=e1000e
            - talos.logging.kernel=udp://vector.monosense.io:6001/
        image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.11.254
            - 172.16.11.9
            - 172.16.11.11
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "1048576"
        kernel.randomize_va_space: "0"
        net.core.netdev_max_backlog: "30000"
        net.core.rmem_max: "67108864"
        net.core.wmem_max: "67108864"
        net.ipv4.tcp_rmem: 4096 87380 33554432
        net.ipv4.tcp_tw_reuse: "1"
        net.ipv4.tcp_window_scaling: "1"
        net.ipv4.tcp_wmem: 4096 65536 33554432
    features:
        rbac: true
        stableHostname: true
        kubernetesTalosAPIAccess:
            enabled: true
            allowedRoles:
                - os:admin
            allowedKubernetesNamespaces:
                - system-upgrade
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
            forwardKubeDNSToHost: false
            resolveMemberNames: true
    logging:
        destinations:
            - endpoint: udp://vector.monosense.io:6002
              format: json_lines
    nodeLabels:
        topology.kubernetes.io/region: main
        topology.kubernetes.io/zone: m
cluster:
    id: ENC[AES256_GCM,data:7t2S2LPcaNdK3XqWm/kjJFbxFfWCmlVr5AhV03pZnSg5VLR5C6xb/DAATSE=,iv:isW3XcOoYace8KPWkE1I4WiYszSi4lznzIVD6cqUMRU=,tag:3omQaXAUFQ7ksEgxDPLVGA==,type:str]
    secret: ENC[AES256_GCM,data:W4/gDyHKVyE0mKKgwgtuS03v/AMXtnp4/w6/X59puyd6ZmLkberMFDU9c7s=,iv:QDbH6PYS+KCYtVlw5JActQew+5FfVnHhMQ/M2zgRPEs=,tag:UWvBIVpasonfc0/t7gY+FQ==,type:str]
    controlPlane:
        endpoint: https://k8s.monosense.io:6443
    clusterName: main
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.42.0.0/16
        serviceSubnets:
            - 10.43.0.0/16
    token: ENC[AES256_GCM,data:QEfSt/VNzT4qWAXWo/SdPEuHag/k/o8=,iv:ZIBH6D/JT02rTa98QBw0ourLukrZZosfuZOQuaaByNU=,tag:13Y2wWtVo1GS9y2Qi/vtDw==,type:str]
    secretboxEncryptionSecret: ENC[AES256_GCM,data:BMt4YMrrYPgQAmARMu+cxxbYaZd65M91ZaNR7Q4WL+5c78752auiJHaC7PU=,iv:k6ALFzMpQQm1M+7PWhe5lcteDdCM2Xkjx3qBpkZHILs=,tag:5IOFqLfTtgkdRSlBKqJcMw==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:C8dLUueVZQH6Dbr0WXhIYj9ZjE3q1PKvyzlSJejWzQzEdXYnsLL6UJv2D8vRjy1KJ16nAY/tGma2ZhOzZ7q1sZGNIFpMk+BzKrvQYb1pSkmcTqZnZrU+e0PdMoN4+vfl1djQvMBOg/5Pg7fv+Fp/LWw3T0NVvNPSIBgPP5HzXeSQJ4oGz5kMZin99P8dffdJXUi4yrZobZ39g9LmgUXyk10VExAbEKv5fDEK+p86wK9JY37XVFBs4wLKwpePM8KRhoexOb2V4gj+Y3XFDh6APYz+p2m9cL/BU1A5hGD2EK9DVshjNeGga82NX2QHBxBDcEmND+IX8bI0SAQK6HiuZ9SCfDXfql9dIO3Jzzeuaza3LFIvlreBcYhX+WZ90hLFk/2C4nIQlQatxa0ie2ehW02Q+MRAX0NTX9tqB3X/mq6yiaXTC9qqm4dphh3nRFbGKRogO9Hn7I/Z7582WjKarfMKV9wGSIrLrLAK7uCJUSnuJjnc/uEfT4duJ4fx78Si5TnkQnLoImNu6cGwWjxSsAvbT/ss59PUPTT1eOphVH8Uw3lcFhz4wecrFGvJTVaG6pYrZNVZVuRlLgInnDA0VHPhwr6yJABwnECN0YTFChz6oSLfqP7wNYXpxQBM2vV/5G5YA2gd6tZ6h2R0EuEysLc2XhBjpadI84dD8wAV7/uNihVBzcXv+J+t0mjkFsVoAaqT1qixO8V8SoCDWmaCUSVKZ/9er4ZxYA7szJ0wIcUBVFe05ldGMU0YuwOlnrTYkTdXRYbpk2imF3MVgOLczfeO0kop6d1n2iOsIVnyObZ1S/eJD8bHINFiGEXapg4851UBk4LzkcpwmV3A4YeQbaKK40Dll5e1nIbzVW2t3N7/2wpc0REI2KfOyFjsYmIKPd42Nod4sZ+Xov2jSe4rLkgrZ4Z7LfuNEhUByOTWPa3lpYmLd6iD+uM/aVRCq53NlsmLbXvMLM5qdme18aUFMtKZxb9T2zesO1ob8ihJ4ECsiZ57dg3EVCCVsTJvZK9wYfToxt2qwwuISz2Wu8xlx8fhzSr56RKOr3asNg==,iv:iike59dCPTSJDCjnJoqGE7JQZO9r0+e0zoHD7lfGmX8=,tag:qX3B98CpgaEoRiHHRh/Ygg==,type:str]
        key: ENC[AES256_GCM,data:YH7onz0kWDfoufzuz2djeEldGXQwW2KNZSJTSbjRmumYT2yc9+gnRF+jKa+UAIDkOGUkVesh8tth1WVJVmG4QIa3cE4IUCR7gW4WObCi9hvrkyHcINvBaHPxF3dI4zkc1aQFMzwf7GYLKYvP4DsIy5ynFS8ZgcXt+ub+Lb+vi4p1FI3OZw2zByDCGu5QuaB1XdGxe4JIkvlx//Sw78E5BKesKIASm/Ccij9iMCrJOzxcSeXT6SFAaIhVjng8z/zTIMd6QFXQps2JTOxKoV6bIG+DUXvtT9B/8p4Pa89vEA0MdAYJmLrGCALuU35nVSucvNZlbcjhvipCi1h5wlAkNTR4ui5PllrxXjscoavQep4Q8acgykDmGLUfrPcQVqaEiWdWH/Bvg5N8p3QxP8yGEg==,iv:epMTHn5FCBM+mLnw1gmzGjuXFKdvTx0SobmExPh33vY=,tag:xDjebNK8J4X09DW/Qd2y/A==,type:str]
    aggregatorCA:
        crt: ENC[AES256_GCM,data:1X6US2IkdFmPziu4lxwRIiPDPKMY3voCHqsE5SzU2VL01arTcq9bDN+vGj+cDHz+6VMiTMht0+rljnd/oPKUVl2vcTE8PqxAUdCUyLigpt9OQACq3KTu8p2PRu6nh1upRdusXFO2c1JKI62h4n5naU7CaI/qnyTZpAMUr9Y3qQLQQrtw98hBFzl2LnVw2lEqSKvQUyMUTbjNnR3uQdj3EWu57V2HRc13O31Kp8056rViXWYDQ8hu6NzXGsgL5SJhdIozrHlD4BAaotkKFhxYXH1lFCqTToMdQMlZ4J47NB8rsYbXw2yTkEzvhi/vxZO28zRwXxQjEeIQGEy8DUW9sHIu/KEYmeQXv6GF8zAOv5bwSDqbVeCsZwXO4uVv8r/3kvEWoyraX9es9cg7mQBN9e7cOBhy+HA+rx8hcYm1oqR+9vj7MChxi9Wc9S33bKFwO/FyzzzFbk+yBvc9BoiFCazTEKp2xpDiRk99hUPmV5qv9Eq95pl6hgpEQGFR1nXZZXP9RyW7Pllf8Y6rT5xBcXFY4kvbFlmjWxxU65G+QTpDZG5zCFrDsy9EFpa5crLyz22KFC8c2uDtA2HxDI1uQyOanQWhcEPUcRy6MZFWRAUjKMH/Tw9I5wIc1ekIeWQGI/TpwTzhQf83vlgZbUJ2Wk+XK7g/PFGj5LTxXNrrcXWPJpVPQJ2NVkvewacKw7DJsxzH0GvxDgPmJ4cHMIJfLlMzniQh3Svry3dJbTJ3524ceiIaaGqoXi+D03msDnyYrhFdxQ7EpjkUXM4kj7o2BdfLdn+6FG9PZAF81P/9/BQatB9TIppymcUOWZs5KYhgeOaCbNSVVp6a4bEzPeX+jZ171c0GGgPQik6r+JbrvR0mbpS4SS7pxN8v11ndQ19YoalZj85vCKkHNr8NPVOvIPCE9ZEnI6+SDmLwN7eazfM1Sb0+/h4IomE+9THVi5um,iv:1e/0F+NaPsRJa7sStbL+Fs+C7fg7VJcqZNB1215jWHs=,tag:e9WPPK4y1C5XnfuWJn5EuQ==,type:str]
        key: ENC[AES256_GCM,data:P7MTZOTpsYiZZZJbYiSSz/ZOpirPbt1a85ch6/LnxF0N0h2KpbjhO0rHDCk/i4ktnX6Lw5O1E9fbxgwRh9X12gqaLTJS+h5qvv/QS03zholo2ZAGrkR3+FTUoJaH9qrkAD+CjwNknNNkmEDTKiExKIx0KYWIrI3ruIZX35TRp1bWse87e/lTA0OGcq6lhDcigqB2QemT8Kl7I6JwG+AHlFN35VLr7/I8k6Fi7oqzKLDh7mJIQLG/NrJ+/0nrqHhauM2lYOnLZ0JAMHTV/PaJlJPvC7f1VV12aQwu+Hqx9qqzUT7BM5Dzz3YgTR22TO3T7yjnDQ7hzbZJCXCDF4pEMA1i4pCqOxZftC9qA4uRwynS+SzTrCcBp+m5BI76KKBtQvI9OH/U/EZDwMVPDWrIpQ==,iv:51scjQ+e8BiqHX/gMhPCEhzJwx+rliFrO8qZdiqcfNU=,tag:sX7IAdncIA2FRcqMfNXf2g==,type:str]
    serviceAccount:
        key: ENC[AES256_GCM,data:nf/0/vehhbbLTl8XBwnFdu80D7WDVr4Vyi40a0PrNiQVupc19GIZNp5Jb8xpEped/1lKMB8pb80cphPrw/29GqWY+eU6gThrkbgkST4GaW8LTv2u0Wh+PZJQ+FWzKTpYyMBD+IVLInFYz3iNpx17vr1qG+zM80Sdsb/925+lcmSVjg5LPOVfMFspBNZ3eZiZkjvaBgAwEXRZtYiC2XckBSuZmv+FWaF6qnBp98RSuTH0v4lJE4vssidwf5yycganX2d/WR8/oom3NqdBX7+7FpzXUBcNxgsiQPvsoJcWZ6vdujh8bpHpDFwJAA15ufU8CRXE8RBzMv7LInaRKM2UIVmUfLtE1kIkMbrl0gzXC7BoW+H3VHs5POKKF1vcF+XAj++uF7OA2CcqkBStlQND7g==,iv:mswXr4YO3iviFafw1NWJCV8QXkNZKL+gr0ytx2jyyVw=,tag:kXlDF53UdOKbVCXkF7ZZew==,type:str]
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.30.3
        certSANs:
            - k8s.monosense.io
            - 172.16.11.20
            - 127.0.0.1
        disablePodSecurityPolicy: true
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    proxy:
        disabled: true
        image: registry.k8s.io/kube-proxy:v1.30.3
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:wjKROxPCOMDcUd8sWWq+QTM27VVN4RJUKHgn5LkBog4NUbD+TCkkbvST4/HRVwlZ6ExEif2PV9XzhLwsMmKsd8brJXN0nXJ+yirgVLBzhekaPXgDlSVefFOZ8wEHZo5EuyYQdq0r5X2go5ik69jYPIWoOSkg9CbmPRaQLUFo+nJKqicBZpS83HGbGdH1PCO9lVgxnrhTQLcvyvueAqFvLUXsyo3kD/SOQSrDjTMw3L3QUWNeETfrm+wE8dnqGwIehPLXIBSPFYWTBVDtvKD83WqHQL5xpNyKmD4SzhfnWHDCMIH+l0VpLeG/h3J9p8JwqK3Vm/MlQceZQQZHt66b2DZfPNFQ8bHl58cKV6IGQ5fAEaid0HiLE7GwVnn6R7t5jG9oOvO8jVyNcJT74ELbOfFSb3gjxXL+f9L2vpdsKWYH4kXnuRFS4sUmAqkarnm/olL+XZjyI02u5VystxtICBewNehVC+BTx4RCTaBP6LAQOZ90so//fXAsvbm5sSB+4mKWDSDa0loDWKl4h3YoJNjMr0shpVzUw9tEy/dAZy/BYPm55NhLaubji71XUXr08MfWHOarjGN7MatSIbcFlu6hBluhbMYEQOVWMk9RCNoGwIWbilAingSP1jFZf3UU+OKkNWluG0pl0Q3kwnRaalM4wd7arpZsTYIUfwqvEKGepEbGaoxl3HZR+5QEc43B3vK5hPNC65jL7HaDw2WZdqQbWIFgP2hLXu+AsGQ+U10rlHMu7biYx5duWcXIEzlEULIlokub7IAzRHr4/e+K3SNh8oLYDru08IYI3QabpilrPEPYiIsPNuwLn9eVz1mY45hNB8XXjIsvjJRy5WadFLtp9I1r6Y0QHzYSXpKyX87Xab+poBxdq8HzCBowktX9Uuac2WYpYKgIsPEDe05406hVpawkUsVefFVhjG+BAV8AKOy+ZjXVxBcov2BI9iGTEQtaSrxEgFH55+c3+9lOonNtVowpYdIs3PPXWW0xsFsniMNlLRWF4rSgjFgvtcWZ9tBkXw==,iv:3S7bRzed1w1/4mmc8F7BtfcXHulUgEyCy6kOdfuXOaI=,tag:gN8Hn8PNWcz9Un+G2HyCcw==,type:str]
            key: ENC[AES256_GCM,data:Nx3qwaD4MlYNSnxQNLFJtkx0EWDzI6HtWRwJQo3umoG1m9a/IOd9N9vCHOFoIQ+IZVB5lXHJIjFwyn6vH+vAT3js+k9ZtkzxfVDiAVisBKb91lVqGXIpSxwcNqL/s05FI8dEPX5J+Cy4/tm6E3idakyjiuT8replEoDnVIOtB5Fqu8Ytdrnly+ALrBiK7s0qD5gu7xls8TrUlq3Vz8tNKpB+ksF+lSzeXx/41mcnnnYTtIjQeUyL9HxSdLtiKU/1tzg8Y/YauFpglnR7pRSuzo8hcY/TQrsPKwPAJ3WA0ILkd/PGOPk4SeEiXbS4qV5LjrEkaBLXMTlV76eOtw1TAJIFT/gAHmba6BqpS02mQPWycm7NK2mwdPJQtaRy5gXGwLrK+ujgybqoSDE+Jpa83w==,iv:6lp4jE+C4OIh3mxyzY8kxCPuRL3OJWKxW8vnV8ZRMoE=,tag:kio3FR1jF9q2cP68xIKOOg==,type:str]
        extraArgs:
            listen-metrics-urls: http://0.0.0.0:2381
        advertisedSubnets:
            - 172.16.11.0/24
    coreDNS:
        disabled: true
    allowSchedulingOnMasters: true
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBMc3kxRXNHd1RpTjdiYWlG
            OHN3UVNTWkswVy8vMGErNGZrOGtQRkVYK3c0ClVaUXRZTnNqUDc2VUtpYTJuR1l1
            c2krbW9pOW9lZXNoSnkwOURLZW04RkkKLS0tIDJqSUU5N1o2U3h6SUg4TnRRc3U5
            MUpUYzRmckhPTjVjaDNBSXM4NVk2bTQKTqQCymHre9n3OuHY2BE+kJ2x3kHMQWXR
            GzOwyb/adce8duCH9Oi+plICvWKcrKDPcb+LLFSGCs1GKPsoeahJKg==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-08-18T07:56:26Z"
    mac: ENC[AES256_GCM,data:OQXVE//rFjxo+/PZGvd6RCVMLIANyu9pDxxjdmgLIqe5kuymRQ4dqT3XVdUClZDFzz+nKaOgCFn4lf/n5UR2zWlIEZ/lsCoo5cxfqEs4+qP5ldAWRSL+wqnPPcFQxzVPx494j+d1OffVmdgabNzOF9LkZEcsl7mFzBW0pxGE5w4=,iv:7o2gRWP81uo3K86CSYMQqc852H+JqmhxmP75QxP5yII=,tag:MSHhDTqdj7mdE5YITohXqQ==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.8.1
