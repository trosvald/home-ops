version: v1alpha1
debug: false
persist: true
machine:
  type: controlplane
  token: ENC[AES256_GCM,data:TqgnJ5QWgPawcD1xIS9HzWTXjoe8ZA0=,iv:Dc4VaUJx5JaW5JtGGHWmzZ0K5W0OiBO+yIYpkO0LZn8=,tag:5bVFwUcFnAg0j6FIA1znfQ==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:XugRuRXrbpmSeityOHjCSdnlfFuWVwjTofuUqPWO60BqjgoalN9TH+Q/sqhsoSeKt3BM2PWexWaQsawsQC9YHXzDrEWwvxQbhMYCqAIERDgWnlfkc89i85eRQBQDSpn3LjZW1Aku3VVyyay0qZfW7XkQMBS3m6SrI6oKO+q8oSVnWgUTHzK4Y454xCW3XO7jl0R3eFsRPk6FY2mRW27eNGYl2UssAAWCb1RvIevtnFqWJ5DH2PRbZKbtG0wb+Vy9T4zZP0xhWipj6dRa0Ct91ODvfCrYsAfFls6TeifipYei1GZ6G5dswS1c02cPaA1b2sAVYgGDn8z/kn7SyECMUgoncx9e4dfmHRl4D41xXrskxxTP5OMbHW0kusIC5WlvoXvnpyzrtvRSli8+vY+Dqdmuhaa/XFQaTioknaqDAaj+ExaWBJs6szGTKDijQ3sWxrBdgYfMHuMGmZA6sytLV7e3KxxkHP2npA2K6PbIl57FnoBCn7LyiGmFjhcUTLypgNRM+/xKgqwLpNjMEqJVSBnNzQ1zf1D4wbPCCZeDszUSBcVL6/bV/rgNwnPxalzeQvezPPE5miErfroI0FW6FA5Yoih8m2QdIWjLkVy4rtndq+nb0gaScljgfOC7jpFnQuXA+aW3YHjqGtdeijZHwAw3Da+9BAEMUaKpT43LKAnCA7jH2foLtQnvtLCVrK+2xt5hMEMLfsHx+3JUaCbgH/YCPrrE6JEtGZrttLSIiFz4n934+d4K1BdDt4MxF0Z2pCUwmGJK5s7fidrvFSHUUJlykrJRzDuwknnBEwQG1ZTTgaal8TTf/hLHawWi0QfvUCyKr3OfVj7zfKTfq83z2ZlbwpWxVnDU10hMzEh8q23gKhVb,iv:bIhkPu0doNHFK3sbU3QFgBBFESJRJjoVqstLXHBwVlc=,tag:TWm2UEcfC7UPEKEbNijz+A==,type:str]
    key: ENC[AES256_GCM,data:XKDlzYskrfhGcWOQmTNygn6trL5K3FyIfNOEe5lLZYGqm9POu8XLj9roVVnrA1VXjIYlAjjO7aInYVF6quVtY7cdCZP2kP2vqlS6vUTRXDQERhDl1gtHwIjG1dR3MZygHXDqiroYs+fC1n0ktKT4v4pcBtnKWTvj9kb6hYzQkyyxBM6LY9oJ9IYsWevX1hCh0apJkyIaNBtGUeUQH9CEbyG3lbBJDiOcXQgl/gkzIwBgJfuq,iv:3muFXi1EVPE1jSibjVT1i/FPHf7khwTpTOUNYVi8IY8=,tag:GVAMwH9PcW6RKtU9bGlI0w==,type:str]
  certSANs:
    - 172.16.11.20
    - 127.0.0.1
  kubelet:
    image: ghcr.io/siderolabs/kubelet:v1.30.3
    extraArgs:
      rotate-server-certificates: "true"
    extraMounts:
      - destination: /var/openebs/local
        type: bind
        source: /var/openebs/local
        options:
          - bind
          - rshared
          - rw
    defaultRuntimeSeccompProfileEnabled: true
    nodeIP:
      validSubnets:
        - 172.16.11.0/24
    disableManifestsDirectory: true
  network:
    hostname: p-tlx-k8s-m0.monosense.io
    interfaces:
      - interface: eth0
        ignore: true
      - interface: bond0
        bond:
          interfaces: []
          deviceSelectors:
            - hardwareAddr: e4:1d:85:75:d8:73
            - hardwareAddr: e4:1d:85:75:d8:74
          mode: active-backup
          miimon: 100
        mtu: 9000
        dhcp: true
        vip:
          ip: 172.16.11.20
    nameservers:
      - 172.16.11.9
      - 172.16.11.11
    extraHostEntries:
      - ip: 172.16.11.20
        aliases:
          - k8s.monosense.io
          - main.monosense.io
    disableSearchDomain: true
  install:
    disk: /dev/sda
    extraKernelArgs:
      - net.ifnames=0
      - mitigations=off
      - module_blacklist=e1000e
      - talos.logging.kernel=udp://vector.monosense.io:6001/
    image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
    wipe: false
  files:
    - content: |-
        [plugins]
          [plugins."io.containerd.grpc.v1.cri"]
            enable_unprivileged_ports = true
            enable_unprivileged_icmp = true
          [plugins."io.containerd.grpc.v1.cri".containerd]
            discard_unpacked_layers = false
          [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
            discard_unpacked_layers = false
      permissions: 0
      path: /etc/cri/conf.d/20-customization.part
      op: create
    - content: |-
        [ NFSMount_Global_Options ]
        nfsvers=4.2
        hard=True
        noatime=True
        nodiratime=True
        rsize=131072
        wsize=131072
        nconnect=8
      permissions: 420
      path: /etc/nfsmount.conf
      op: overwrite
  time:
    disabled: false
    servers:
      - 172.16.11.254
      - 172.16.11.9
      - 172.16.11.11
  sysctls:
    fs.inotify.max_user_instances: "8192"
    fs.inotify.max_user_watches: "1048576"
    kernel.randomize_va_space: "0"
    net.core.netdev_max_backlog: "30000"
    net.core.rmem_max: "67108864"
    net.core.wmem_max: "67108864"
    net.ipv4.tcp_rmem: 4096 87380 33554432
    net.ipv4.tcp_tw_reuse: "1"
    net.ipv4.tcp_window_scaling: "1"
    net.ipv4.tcp_wmem: 4096 65536 33554432
  features:
    rbac: true
    stableHostname: true
    kubernetesTalosAPIAccess:
      enabled: true
      allowedRoles:
        - os:admin
      allowedKubernetesNamespaces:
        - system-upgrade
    apidCheckExtKeyUsage: true
    diskQuotaSupport: true
    kubePrism:
      enabled: true
      port: 7445
    hostDNS:
      enabled: true
      forwardKubeDNSToHost: false
      resolveMemberNames: true
  logging:
    destinations:
      - endpoint: udp://vector.monosense.io:6002
        format: json_lines
  nodeLabels:
    topology.kubernetes.io/region: main
    topology.kubernetes.io/zone: m
cluster:
  id: ENC[AES256_GCM,data:l2ggo7T2Iu1XMJ88S7zI2GGvMxpJ4P0OVMwQCvzNCH8GXz1UkjOPcw6U9ys=,iv:oFu84OzXoZvLPH+W/nkokFgZd6AzK2igu/ZGPnWgLWM=,tag:sdquAjwZ31UtDnfdYCsNjw==,type:str]
  secret: ENC[AES256_GCM,data:cPrQjn1XXX7OTBULqt/3GqucUeS2eBbW6vt18C5qe8PDfT1E8fLVY/0GXR0=,iv:gRT/oiXDIY3pXKtsNm0K8PZXGPKi1aaqAe2GTWsSKxY=,tag:NwQz7/lQGJlaynF5edNOXg==,type:str]
  controlPlane:
    endpoint: https://k8s.monosense.io:6443
  clusterName: main
  network:
    cni:
      name: none
    dnsDomain: cluster.local
    podSubnets:
      - 10.42.0.0/16
    serviceSubnets:
      - 10.43.0.0/16
  token: ENC[AES256_GCM,data:+Cgzq6vjMrEXPTFwWD7bR6nlDZ1xKGQ=,iv:IBs5C3n2Fo9bK5j1NK+vKq8w9QSnc9jm3xhTvZc/gkA=,tag:HzWP/KoVHKam1RJJQyjm/g==,type:str]
  secretboxEncryptionSecret: ENC[AES256_GCM,data:W6I9vtAZHxHg4MCR2DfEw5+4BRUGH7hJAAaA7kFxLJ4YZnJ6bJC5IVwJJdo=,iv:zYxC7L/YTpBgzL7lVOY02+v2gaz8xfFQuf9/Czr7b+E=,tag:Xjjf1GkjhVVrb59lOiyxEw==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:TV2e/lN208gxmnIQ69D5KtusQR7qT1Cc7foByshA/oXbhQ2RQmPHB8Tteig1zReIoXxXkyOCcoKfVFSO5Maga5g3xbcXnqOAKGDuhmclYz7ohC2gxCHjsiGRleprgCZXlQRGXyyoTiOM9CUNC/mTq6vMNcfBLsk0QUHaBJ9aujYqTjf2CZXsfM2KYgcS+35YjRdmbAMaulhJyZAiZfnT2YnvG1XpEI2Mtzu0LpYC3tnspQABrC9nRw5G6AOwCcSQ68JXBWCkpQBmHkQzZ/Ror5SnXM5NX/HSQRg1XLftyE1y+/XkYuPQJdv6uJ66rbTsw8E07iJw3XegjRNxih0yhJiNZfIJCYLO9i4HAZQKq9ulkL61auBky9GA89ntjr73jEoVkkyDaQgE2U6mhFVUEdzXyRkLMGtZz4ZvMC7gfV3u9jw15WrlmyJEZE5WmoYyHbvyX2J0OGDvTjcVPZ5SjIdJNC/Hbbz6A59mlWMpX/Aco83SnuQF9wx9evjtNaF4M/7Fxu/y3iQ3VoqbQ8hDZDMtaVrd81xpg/+jDAssc5JOfZpbl2bq4feVVRzk5TJ/4vQii3yjM4qCP0j0tycd4lIB6/yWSzKc1hhwpPCppa2lME0RUju4UTmHb57Hts7R6lB2lBo/J4SEX1+euptQ2SknQGYojEoEuPBz/L6euhTfpotoqYdmTCeJdJbEudw+OhcVnWmVUP5NOw/GjVQyEo1kY0iZH9jQGHmYRuJHDAU9Ymb6EfpnuQTc/yhaHzp6iepJTDWkW527VlKs3F6lf5JNIXU6FnDMRW6wmm5evBT4wUgy9+wVngxcAT59J/qHKECpiH7souTjgHawCV+PI94v/h+QPEJoxmj9xvJetE4ewgQZVf1FgIeN7bLLT1fhhhdvlY35ppcKbEJZDhY8ry405RSSzSOOn12pKXof7ZtFLKeVWnEieg12L54da6W47z5uyoT1c/oBKXIT7NPLtzxymR4/+iuZW6dDTgi9KI6D54noJKIgAGgQVvg+uUc/DTriM/TMPQUVF/PzCsD7u92YZVihQ40ar4nSSw==,iv:tpOwGRXZlFvarKN10okFSMin3gb+svWYcMGqALLunsI=,tag:SuLo2fWXhU5LgajTDxll8Q==,type:str]
    key: ENC[AES256_GCM,data:1FdF7ZI0XBGzjMomC1gd8Cha5JbhTHV4JqklKE/BxGMW5fnMJRXkpXUxPPzhdee8l6OaofcsI+D4QTm9MVW1jDhhxL0k/jbMFp9MCFScAKDLbEBvLXsRcC/rI8kc/t2Xxo8ymCwdTI21iw4/3UthYo2O21IkKs06aPhfcOFTNxkiN2HTuJQPmTT216fbnO6v3GkahI5v7aH9gBL4oqvk4rK+PGZGOC91h0H4g85yN9RnONA/5iFGT4CX+dWuX7q3fzVDCIHKWAg4y9DCMHHNlxj0v2hrKOnyfkYNFogKusQP226MScq2wf0PWxjE98oae0XGhrhkZvhZH4v1bB5mnKA8CgvQ9+pzZuDHWPyzxKemB50JDdSiydVEMpW8tEAlRsN1+0CUVVyRbzB8Bnlk0w==,iv:OGqPiuCgMnu/x+dUhC8zSqNGdHf+uj8HQJALqlZLE8E=,tag:hVw2LU4IL/UkpCLkHWDM6w==,type:str]
  aggregatorCA:
    crt: ENC[AES256_GCM,data:wlS+r2hrq28bUxoEnnUeltp2UldG7ctnKet1rGIYZ+ufEXXMshpysPUi8H07H/Rk6AdHdH46r3U0jqX6JVoH4PpaVof/Eo4MidbLnMoTscwlvcrhIngpxA6iALx1pG6pLKcW/+3eQOYxvyXlm9fp6SzsOTVOZsUAOuMtg7Y+FGsj4NPnShbldmP9w0TC4Klr2UN4cTJLIMxaXfLR45c4vKYBcRiZ0llHuAw5LXT7p/XgoXlUZgRSeHeY7nzV9e2jL6ZhBVUbaM5JxtX5VD4cEn5ZPGsar7BbLgON1AZMf2ruVzduyetHAm4mwzfbRQiajrMD9nJtJzdarbocJlbS11hVLLJYaAti48jLM4EAPC1k1GActtFyYLaGtiJ8MUhV2Lw7nI/D1C/JslSsLMENpjBWp5Xf7EDyUdu16bke6SUKOHcGWyM9Wqoel9JYrPNrsSN58RppTay6yd7jCTDvBBJx/4L3BltO0bL/uIO3uqj9LC48pyH8MqhIk+4viLSJsT8s7agoHd+ieoSss4kBOTyHR+6V05g8P/ubXWKQ4w9Zr2tTRFZm9yKW2WNhtIBf4j/8cx0IcNV6DuHI680bY5cd9avEEp/hv4erYLsVbqDiodX0982GrdQ2+HDmABDELyAmnwhqqDYABnMqX5eqo+SeOeTKH0I8MYWnGl3eDJUW30xP5K+wLDL0cYfx5Mie/jW2AQniqfRh6MC8mmht6EiCKivAAl9LXM6MGL/S42KRdNxTliuOmVCw0sMeWheRXHSYzc5hMXVbDH6I3hm15mVcFq/Oe4pKYuXgPRQRB+gDatrQ7PWmLBQzHacWvgDwKc6gxMrFogFGwXW13hleVLgm1ukRXw2sm3/XHe7hFE8q+rnPy4amqjQuLjzIfb7/3wE1/yFfLTQijZaIBu3tvYQcAxpH5aOOGXY/RLOB2YNaqm/Q1wx4uUlf/y4llfr+,iv:wCkUCMLh/uodTpN2R8JnN9wQv1lJ/wOG4vOIdz+Fa3c=,tag:wJgyKyNGTHbXACq+pECBbw==,type:str]
    key: ENC[AES256_GCM,data:DdCjPN5p+awAqpAwyG8dqQimgTm/qYxYmIrEgiRZpAyyJTKb+j2j3UAdmhNckXTIWEZgxwbZ+ccSuXg8oYJFXi21yPR8OIRtSZD5pHoybHNyPb+Z8WV26VpnX7rLQH8JfyXwIHio7LF2JjsPYLnoyO86XWDWo2bWZwYI3yWyad1l99Hkx25gUayGmXFmQwSv2ltiLJloXH3XMNqCCFMlUNnd3GK/8EKC1xcCyZiutYEz/DuHdxjlKvWh3Dle1lymKqX9/b1KE3vvGPW1e17mJS6s4xORzYagOcWvfkT8L8kGXlWwOlzfU0Hi3j+y320sGja6sd0LTAfcR8LpQZM1PhsDvteH92PdwROIdfmBSqUGOBJ6Eydx5l39QDN7W+hYyTULtVWvUFzquEnIQaBHdg==,iv:hmhAJ5scpZa2vrFBQP1wAAzxNbdRux6r1+x+Sz6Dmz4=,tag:Odw5lcIL4Y0mRvw4c9s+LA==,type:str]
  serviceAccount:
    key: ENC[AES256_GCM,data:/JgGqIeV3ZVZM5lzXUum0gWwYbrkQqP/SagXJwyn+LcUeCeo2w5kaTXcFK2s8Q1RzFwOQBY1eBGf9dB8GawHEMIlhjDa25FG2JEAyshEB5pDbhFcYzxT3q+M3HPIwwem3XDD3M5q2tHusxd++sQfDOqhduEZK20FxIZ0mJb5u2ac+CbQxpujWZxsHTV5ghm1ciHbQq09noxPp7Zl+fsjSRdTA7893HMGyucw1dyIU/+34f102Uz0nNFLcXNtKfM2GMk1cYN11L0+a+Cb0wwS39Ux0DWCn/r4sWEWgQJGIIXxzLmKod3H2Z1Si7sPSKB+cGz75y+t3luMdigtGcoJ5cYDCSMeftVR8KjJkDcudpVetW3pQ7xdGWV8xankd5f85tSEb4JTjeM+hxz5lrR8Vw==,iv:vWDLS7z2B1TxZ+QTbsqzkwkjqUYBmOsSDsAJUX6RWgM=,tag:Go0bqL8aB+uvrPnPf6rbzQ==,type:str]
  apiServer:
    image: registry.k8s.io/kube-apiserver:v1.30.3
    certSANs:
      - k8s.monosense.io
      - 172.16.11.20
      - 127.0.0.1
    disablePodSecurityPolicy: true
    auditPolicy:
      apiVersion: audit.k8s.io/v1
      kind: Policy
      rules:
        - level: Metadata
  controllerManager:
    image: registry.k8s.io/kube-controller-manager:v1.30.3
    extraArgs:
      bind-address: 0.0.0.0
  proxy:
    disabled: true
    image: registry.k8s.io/kube-proxy:v1.30.3
  scheduler:
    image: registry.k8s.io/kube-scheduler:v1.30.3
    extraArgs:
      bind-address: 0.0.0.0
  discovery:
    enabled: true
    registries:
      kubernetes:
        disabled: false
      service:
        disabled: false
  etcd:
    ca:
      crt: ENC[AES256_GCM,data:omMiW8yAGehGuHz3E276JjajcyT5IEnjWb52wcNWFisJ5y6t03Olq5bpqRedjis0D0og30O567LeoRrxkgTgzUAy+sCu6jXJUi8b+n8xbgdVITY2cDCVzymZD+vBlLgy8dOaq3KpypuQdrVrKAGZ2nnu4MNKiKr7K10nCkvhjQVqwDiCBmmB/SumlCIzq/LLKjFGWHe8taoylmt5ZpTrYZqYGnjCFrtteIq3OxA7Ah4Snn5sfoT86l2sZxvGwlqGy++LaBHcYWjwAPB8QE3ntABxpaANPnEG0+fmQ4VLzoV/dXPQnmiHedbqU6rlVwVY59ulyHR225VAT0uOUwDrwnswo6boJ+K7xWl7ujQXQBDnP22FLZifnbZcbzEKQcRO0fh8Mdza6ZyokdLK55YwdpaKz9tLxH3119/MGcu+Qjn+NHaViy4XtrsS0Dw3hv9JCmMnSCRpmf7MKUExyZIipmzNd7XvNW282FGWH4x5PDHxmvwCUZ45VS8b8LXPuWoATZL3fXfxFj2TbjoL5Ffi9q7CGH//eUztrCgI1bn7hOYDvjYqptghv9aRLJu6heQeGwcMHsfiOMaFJGNTVaQm5bBd/ZQ3XOMricg+zGFBV8kWwp1Ok7keEpKLKNwbT7Q+KIqMs6vVu4z1Ko5DLy70YmMD/5WgCo1aSXig++OEeO/EKLWaZqKyz75f3+nXMOvslZueooKBBrrbIsFLbCtyobJeOJNUiDdO89J1Ae305VlJlJn9ZRIarMl4PDQECevRvNrmorMhllkwLf+ia42INupLvFqvqLEEnr0vjVAJV5vAZYFf1OxEJ+pJ+TXbqvSkO7ZZiTJ1s+WgJQZxQyJ2LUlOimHBORuL4HDQ3oGBXU/+XRuB25KfteK4z3P4EyVMWciRu5iKMz9it+/cRM7jnRpeif6cMIO8VRmNUr6bCGprvx0RmbqS4Mj8o0JROWuj0ulSf3YZgfOaXVBoxIQU5R0wmOuaK+VKt5agAu5w0288f9e0HYonYKOgE4oftJ06XDF6gA==,iv:iITSTIibXJRt9nSwXfO/eOcN+70TUh6EKavBhMLa9Yo=,tag:/BEjQfullOmhTV2Lw+MzbQ==,type:str]
      key: ENC[AES256_GCM,data:QbhNQSvp0Doi0KqX4JLsowIH9GwF63Xg6Iw4xNBF45lLzAElZXodmXaCWr9894SmdP2oAyEwyWw2V2xl/cA43RTEw6+C5MmxMSMf8buKjZctA/gWJIkeGHAbZ/oeIZ7VEYERawl2q5jrn05PXJFBLtTsi4Fz7rh4A1HjzTpugdmNX9cNHkpbseLZV6qzKyQWacE/XI/6FhNNgvvK+zy6xTDMHO661Nyoof/1/Ml2xDTWrTy32b6hVLOi4Jwe7WIxGT8QbCKcJIek6LFXGl66uYvsiKX41Kp2PJkp+ilTC6JTrc1oNK06lnP5drQnOSiw0wo8Xcc9oNP3SuOXpmaqrJ0ucYgeytHkdoxD1Y8AAI6iQRqfgtGnPA2HqqHUUx13P/EAvHfrZgaJT9ewxWKRug==,iv:Z9EZ52oJqMgOWCVg8ysxZUz3ZjfUVEGEaQCEqLnRClc=,tag:J8B6gebQ6MNrQ+vNfArvlg==,type:str]
    extraArgs:
      listen-metrics-urls: http://0.0.0.0:2381
    advertisedSubnets:
      - 172.16.11.0/24
  coreDNS:
    disabled: true
  allowSchedulingOnMasters: true
sops:
  kms: []
  gcp_kms: []
  azure_kv: []
  hc_vault: []
  age:
    - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
      enc: |
        -----BEGIN AGE ENCRYPTED FILE-----
        YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSAvRmV5aXNIUFRFSkN3aTJk
        TElPVGV2MkE0NlM4UXNpYmJFWlRFM293UVRBCmNrMlNtaXZaMmFkUEhEQU12d1Ra
        b29RcFhnTmF4ODdzTlBEL2xpK1RUZkkKLS0tIFllUm5IUTJTbnJkck5icFYvT3JE
        WlJQNzlDc2xCQ0t6SzE2Sk91bFo2TzgKuGolVcrACxikTMHlT5T3aix8U2/Qqufz
        Gvw9AF87WfySmxT0EzgW4hZhdAbXKkMINQ3vLyAn2mYJ/ZqYP7apFA==
        -----END AGE ENCRYPTED FILE-----
  lastmodified: "2024-08-19T12:36:17Z"
  mac: ENC[AES256_GCM,data:hcAzLG5pxtKG3a0AvRsknwagriphaiOpqP/ogS81r8yPTkXsJP7GGJVcOyhyU/Jeso9Qrxm5EE99qNJJX/+NksPLz8fF88HzfthUB7bJqAkJE6aIjRT5vns1ZFcCjzOAF4Fg5CHDde7rQti2bHIMPj4J8oZoN7Dt4kpTPqbgis8=,iv:dbfbE0O8zyv0iRJDiJM9I3rFIANyc3xoZJKHIkjAHYo=,tag:irxgh9VIxoeiq9AZQqLyig==,type:str]
  pgp: []
  encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
  version: 3.9.0
