version: v1alpha1
debug: false
persist: true
machine:
    type: controlplane
    token: ENC[AES256_GCM,data:2JRRVGRpVJrFLzPq4PshS0F6E66f5iw=,iv:EEHmfK97GVbWd73fhwCz00SPV7a3PTLCJpszurLx5q8=,tag:YVSkPXmtrkx2nRo8nqKDQw==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:mllqFOWAalrBaUOHCbJd0EDsqp+bzlezDzNgPIHdd6SE0rAuXL6OlCfBRezh0SPKLg3aTCOWehS3pSF1DJvc0Zn5qlBSdSahaNbqQcYb33WnTcgn93py9CqFU5rJBXXE2/wM1Sg0zi8IdXfKInYtAzGZIqqAF6Tsd9rcx46MA9QRITHyvmnJgHrRnmYp1LwoOd0S42b1rQd09OVmrYGN554cM+SBozgtGGkUgBivt422FAWDNdABbryyDmwvd0FsteJaIkr98CBqJLp3ZI7xv8TZkd34l68gJ4WBZX4ZveInrvXc6/JqaLnosd7tgqBqRIZtGn795IfZGaS4BMqJhtGFK9AjlmcBae+SA1BzlaCkAYlv4mqINZWAUc1y2R40SpU8is1keglRBie7anu2BN9I0rLwDyjQV7baYVlVkrqPyFZjr7ZN+4orAx8plwOneYyQkaIWP1688dA9qDFZm7hHTjERLUbXe7jMZS5hLumvTyW42EVzSG5MueHbxFiJOi18eBlFbgoaKldPuV4GKOKF9cm6nNEcu2+1DGomRYmHvb+GPkV2Yn7rrycAtz0NSedJbPWF8l42kYUtwoLWbeWNPqAi11/Cv5KO+pUQNYjbVNkmYSeVaCaZW3qxBt/vbZD3UXeDwRpy7eyHPTl+bM93tIZBGgRbaIO13keqh2ECE34jM2u+b7VBc8293I/doDWI5MR1e1HvQNxv8e1n9vrgUeKXGl2hCWKmHADbM/h2P6RI3JXFNQt1WaoEngZHSjsOWfYjXWIJq4uEDzL5u1CFjWoDKxfxrZ0pLqm0z7reShGW80ycIZqtAidv46bO8R7rFMWHlXoIZtViQeDrDSG8fRxGC2/7B8XvlnU2ebbLEDH6,iv:IxrBYEzFCPgJzCdnNT5XFEuHZBfp7PdpHnefvBs3Q08=,tag:42+MI3Nj/8oGIMhCEi7onw==,type:str]
        key: ENC[AES256_GCM,data:ZvfYRG0TmzH4G/NxjoXQMSrRiEcKUgo+BM4GjIcc0cIZE6+cRaZdQeIFR0JjlQArIB50uXSLB7emyEJVVE1B8P/0a0xy9+sxcYzcpZ/fos2BKXYwM16grKzawWVVJ5+RzEnIIwbHSa83FbzXhv8WyoIpfPw3KAMp1SO6c3TV39eabmdXlkNxkKgKsut4U3Ez3HUUuYoFIV6bYd7X9TYqpeHmAWHNw11G4YueHsC9HNrvFwKA,iv:0tB66hc2JzumhnWG/TdCJiVecv5qlt2/Kxh37hnOMoY=,tag:DKQKy0ToJSmwZ4uRsApeEA==,type:str]
    certSANs:
        - 172.16.11.20
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.30.3
        extraArgs:
            rotate-server-certificates: "true"
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        hostname: p-tlx-k8s-m0.monosense.io
        interfaces:
            - interface: eth0
              ignore: true
            - interface: bond0
              bond:
                interfaces: []
                deviceSelectors:
                    - hardwareAddr: e4:1d:85:75:d8:73
                    - hardwareAddr: e4:1d:85:75:d8:74
                mode: active-backup
                miimon: 100
              mtu: 9000
              dhcp: true
              vip:
                ip: 172.16.11.20
        nameservers:
            - 172.16.11.9
            - 172.16.11.11
        extraHostEntries:
            - ip: 172.16.11.20
              aliases:
                - k8s.monosense.io
                - main.monosense.io
        disableSearchDomain: true
    install:
        disk: /dev/sda
        extraKernelArgs:
            - net.ifnames=0
            - mitigations=off
            - module_blacklist=e1000e
            - talos.logging.kernel=udp://vector.monosense.io:6001/
        image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.11.254
            - 172.16.11.9
            - 172.16.11.11
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "1048576"
        kernel.randomize_va_space: "0"
        net.core.netdev_max_backlog: "30000"
        net.core.rmem_max: "67108864"
        net.core.wmem_max: "67108864"
        net.ipv4.tcp_rmem: 4096 87380 33554432
        net.ipv4.tcp_tw_reuse: "1"
        net.ipv4.tcp_window_scaling: "1"
        net.ipv4.tcp_wmem: 4096 65536 33554432
    features:
        rbac: true
        stableHostname: true
        kubernetesTalosAPIAccess:
            enabled: true
            allowedRoles:
                - os:admin
            allowedKubernetesNamespaces:
                - system-upgrade
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
            forwardKubeDNSToHost: false
            resolveMemberNames: true
    logging:
        destinations:
            - endpoint: udp://vector.monosense.io:6002
              format: json_lines
    nodeLabels:
        topology.kubernetes.io/region: main
        topology.kubernetes.io/zone: m
cluster:
    id: ENC[AES256_GCM,data:a5GooiBGHBVU72Ugbv7q6F+Yya9tdT9F3EwM4gyip3GCHNNvtB9bp0tyVlo=,iv:kiRY7jnYbMrDSAzpaOAmnZQDOHgYfeqYwHBOnwIJKmc=,tag:n+4IOLz/i/8lA+aS/rr/qg==,type:str]
    secret: ENC[AES256_GCM,data:LgNeMI81ijZZKeoJOaBpbakgXkXMXbUtDi7b+n9W4N5//PtuSUJrnlFlzas=,iv:rI2YUPX3a5SMQtRiFGvaq8NT1b75b+4tTX1xB3r2u/U=,tag:O+HaqBTFmWncwEHpNpG//Q==,type:str]
    controlPlane:
        endpoint: https://k8s.monosense.io:6443
    clusterName: main
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.42.0.0/16
        serviceSubnets:
            - 10.43.0.0/16
    token: ENC[AES256_GCM,data:CYrjQ+DC6x/Wbn9LuOTufYuypOE5UdM=,iv:3gbSGC/NEFjFo5Fg9F1Vw/OkkBoV6zWHD/y5TMOzKOk=,tag:OZsYmFYc2iyZ2TJG74ae7A==,type:str]
    secretboxEncryptionSecret: ENC[AES256_GCM,data:Qxdyb9RAJmgg/OQ5vy4XbLZsnUDp0DNFAqvwHmJKomAEg98DqACMw1cLeMc=,iv:y5lCBTfdQhYh5lQ2ATMrkJ3qU5XchwuD4pCvEEt9OOE=,tag:QsrmhkbMZ01wEUINikmN0g==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:1FZcvmGSa+ymLFSriA0nnuTYeoojSWo2xCgDl85+XhXVD4STXLNDVIclGnnaUvl7E2WejlizaDc5EliO9htA0EkKiLZ4ngfWnHKGJwk5005boQmEevp//vP9ELJb5T+SohSotIXDQ/gKzUAEYeFxK8mNZMo1WxLcPnLEYJ7qT8NiLhpAeefpuqoMeGV5+KnPslZo9Ozrh4UcXMDHM5c19UKgM5sdYDK3kA51NEPhE9mZEbfZT0ousErg/iwlsKiG+Zt/7uKfM7gENWYmBs8ygQPcmmr8oqwswSzgi8Yake++Hg5U/xgTMz2R6ywhOtxIJsC1MLTdmSvjO4ZxVk79q31Jgwmy7FMQnUkVXSPfPDWoLEZXOp8W7QNrvJ8mzjjOCj5sH5Ktv8JNNFEZNiSKIYYgzSZgyhjsMDH7pFSBPJy47Y33V88iJrFj0sSdcmjKPrXyd7ifbTHFN4eQHnjWgTsR+6JBkKZfNAQHdgA0muk5bi6FcYSUaAM8TosszlZIEfq7FwajZuOAUYyKIM5FWQtscg2mPxJYED1iYSCZOOaOlYxCU6cVwR8WhQIhhWm5dnlHhybCVuiaXvuNdozMRfTevGt66WJ8tGy72I/I2JObi0zSqdmSswdpdbzGy0Wd4HaZbNO+H6pCUriBYr11/dUpnT5ZUz1WneTKUuAEuYI/ORxz2jQ3wOolVbABuYYA/3YiN8LLwrB8DMakQMCdh5TSyIISlxw1LlVzJzTO7ZoxtfTFA5TQBvBrYqRB80xR74+AsYMShK4G6dh6fCSTqrjyiQTjopyYTDsnHo3f9rb2PTWxT6a4DJnMEk7OZz88xhhLd4wvoOX5nVTEwL4PKNOG21ok7bPbwAk1CuRgvazAdl+5e+1copdCYljObJo2PST/FY5YMP9evpwH5miXaV9ph0jqKa1laEwmiae/NVq8/aNUr8y1EJCRMeVaFkAQZhmvUeFdSxmAi8yNYtZgesoktWhPt3JPDIeOAD+vYIgddxGYL9jIG3BqthnyE4tYhMVGCjqdfbZBkjhImLHwoLoql2yXYJ1HTPsMGQ==,iv:UjIsfKeQFajVL282qqhvRa1jEtQT46k6EfL728L+BUk=,tag:H4FaCroLwlQgibHWA0z+ew==,type:str]
        key: ENC[AES256_GCM,data:FnmlWCHXHGxeuz2WGD9KmRGrgloeAi4O99RVf9V0SPJHecjfkGp0k5VSfmqhqTVlYsh00lN30IXF5vjWvbeZJUJGmXEo67rcHfNTKE6NFUVxB6RxaD2fUDTw/KmxEgMuYGH26RWAlTmuLX1Mdq0Xim6sZUmA9Lia7NLNaX1z0rpr94WgI6tEu26cS/UF4tAZ7SKbKz8BwK+BQuMg91Buu6JHypMfATeQDG8EHx6qZEHYwDfplJWqkCd+XE+yVrlZ9UMHdrw1GJa+t5hsTezAJSzVRaWoA+0jsZd3KomQzqznWW4Y3+h4588MgxQjxyDznmXTe3aI6FZRQCECxWUyq/zTL/3NTg/8R0ePeTCpRKwork0kEBH3/awIUdj1siATnE0uEv7teBlnCaokrn3HBg==,iv:M5cKBNuxSMZJX9GECCo3/uc2U0mhlhhC5ovaL+f8Ivk=,tag:Ad6SU7W4Ed0Pan4+zfmQFQ==,type:str]
    aggregatorCA:
        crt: ENC[AES256_GCM,data:nFTboBbQiB4f2T0JGOAFMSGrOLNV1QX79+mK/XGa2Dl3zyMat5rbcn5O8/Q/tpa13xe5m503OAzFsiRJJsQlnJqjMcFvhR7vEAaK7bQRss9nstDh9El23mIUosmg/9+raxuA0Bm39vOMf4z1whG0iFSaOMtNfKvurWPJwTYqcsrw3pgybrk5RCMaGCGwX6v3R+LSEdq4hUkl13ByZOvMQ0ATWEpHwbpjW2yRqQknEn8fN45QYlKSxDhl7oBHYVA/R0Sf+No87yj4DMHEQdEIEufIjxPhCU5S6ZdLTih5EK099kUwFoxFkRKnRjYGmD+WIq+XWhneTqf5koLsSjxzmvQpO+zcGwH2HrRenBZy0BKvuKT8sNI0lVSfsBg2VT6i5ywcJdq4iYnx/w5rOiAL0VmJbEJrIlRqoogBlQlMb+ORlejEKq8Ks3qcrCbTnUkLXvDPUoJFdwdOYgIaZVzq/wPyMlXK5wj9ajovJitFenoA6L1rNaYtV426iv8BnUumC0mgITpz1RyR6sVpC145/gox4vhP05rP4aL1REUJlBoVEn6ehYN5HDDV2L8RnSYrNTFc9nuVDxA+Wlz+g1lW1z6L+UbIvfQL6VIw1V3I7bYIeclQu/lHkWWUT4zfWttJ+JCnIpOmBc9N7Pa3SpMNgglPVlXQ7Z8/wzSd1mEuaP9y3IrBXwt65cRb/XAfW+goKJ/l78OfRy/q8SeF0XP0svu47djW0Yf1az9gW77Rf2UaKeURyJIvGmw/1y3GhbfmqX7UNW/piuYSbHqUaasePr+/1YpH3nkkMnuH6wrgcUb8PB15J0079OiqZzH5Wri2c6BHszaBnciscukFyF5mRC5OhIG+QLhH9kL7PZ4G07qkNovwhpPWrrOczle1ICwkBQKhLOMPANHh9c5c39+Ob6I28Vp3otEWR9aiISfYmnR6Po3y2Rk2En6Z7LZTaPbG,iv:6/1LpmbzxIqjtrbgbeMYSLFB2GGUFEClP9KpCprPlK8=,tag:12fuA8bS8B8uC7YncYyTXg==,type:str]
        key: ENC[AES256_GCM,data:u5rFBKDDl71ZqgI8DcORV6JFZb28LKGp5uHn1rE8P5mbmF0ksPtYZzQsBlY/2WaSyB3g7Cdlyal58U8bv4ZNnJd2oaGeoEHfE8LM5viDAINUWOneg9MJjD9RU/B50lc9Q66fAKPY/YsKL/2DaGGH+NjLmSLhgEMKfTwu2xEPt94NvUDfQPhTbXeAelXb55QxcxuP/zJBE3GslTa6KJTBp+MLp6WUh3utX0ICrMd1raepbhkooB9VmapvwaActMklbqOqyBo+gSfq3PN0JAXda6NaF4aR7HwQ3M97Nx0c2GaN4Un6bF63w24+RSYyNo3caK8A4nBY9vVKAqEuw0AtcEQ9N7Tff/tiBovPUcbz3D9jHykw7Xq0claaOvUBxnmRuK5tfhUKl7o1xPuOKVg2qw==,iv:9+uBwdXaH55eNMGp9LRkakOFhuoDgW/bbobvrBONdd0=,tag:6AAqDy44+/5wH5cVZw6NVA==,type:str]
    serviceAccount:
        key: ENC[AES256_GCM,data:U57DCGcqwfVSIf+uBf5698fqA8TD2w1Nj+sDpL4zxtu1zYOmXKewHTXRDQoKs5Ah+2AY7zB5HKmwWxkbNCpd5AWm8MKYl/OM+6jJLr1sriUYRZRZmJQtgJB6qQqs5dW/qT951tbmIiQUEukEVRXsmr8e8Rl1Ps4BZg7LfjbOqSd9mqhI9j/fSDHeW6DCSlmNkQTvPAKoMuIyyECt/YEvCbfdiE2xOVgByxN6/bkrwKbeO6t7rrGVoqxBiBMYsyn2+GGBYlFT1arHRQTubgNPJKgqRpMCG5mcSsjYKn8rRAl4TjCwfLOyB2zpIknUpOFSGLyt/NAoHxJTc+oyT4a9ItfJkG0+G/I3nNKq9108jv0zjj1sybJi782W18hNozEsvkCCYNFr+yn6ddughDXzOQ==,iv:QxBT9HaiHoU1A+tkAg6heZ9r/ghp0Uov+x1UEEaI3Fw=,tag:nMeqkExg/YccIg8lafqqTA==,type:str]
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.30.3
        certSANs:
            - k8s.monosense.io
            - 172.16.11.20
            - 127.0.0.1
        disablePodSecurityPolicy: true
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    proxy:
        disabled: true
        image: registry.k8s.io/kube-proxy:v1.30.3
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:ogzvz/M06OjlTd15heCuDR7Q6lEy3FhMLSFxTkEavhz+owHh9G1VGydzlHEJxg4rK/GzCO4J8CnS0RBdwDWTTySxLpHHv8B62yXcp7zHQXA7TSiE1TITs24c/BuPDY3jEyfw+ND+TlT1IiRDQrNmFp2wM7JQCnWZM4kYhMGQdcJ56YsfedVBwXQEfokJ6OFzlXUeyC8ymoXeVIfCsvbDwZoCQgOaF23V9HEGYogbscrpi99uSMFmIEclNHCynDtraDx795vZuUfxV5T/6AR89PUC7Yfy/KYZHJHcWZtWW64drESGcPuQNEXxpsyWswZitJ0OHa+v7ZawCYjVglzOeXt81dCm+ZSdgRGZV3Tfh9rypI+vYQSdG28hITq/vSDA0O3X8QSgIVOooduXubS8JWBUj3s8vrTzUIu3nzQrW9NYOeJt0f8RFRFB0E+g2KynpWbgGMYVXiCXGL/U8oXvchOAsX07rhixZ+r+fiZ15R4/GA5mCHo0P73cBErIPWZkVAoTg4SguOHl+A3wsZCSfTIBSE34s2By9TlQXbXplke5qNBQJefD8RurJe69waH2HGRH5y3sA857gYNnBKBOR82KSrM0JA1LVyu0p5LeR4NfihN9PIhEBpt5ckAQaDpSJ0RjKp6zIj9wdNrIBBkp9dRyfgXpkQnxCGeyWZONwuVZMz0cDOY3TaIBbcjaSqIcB6UZxY/AygRrgeEKK1KcmRNDqUFR1ShA8iF+G/OUWc2g3BopyRTnm/7e+Kvg/3sGLyMf546IDIjQagTjReQSzu+vcp/kcZwsdYT81SdAqlYQA92SOfP3XhxxhmsvzVBDI17hOvBkkgTfb8Z+pGSwacBJgMi4oCEnSc8dDUKxFCTbU1O0ssXneufvlAPk83fE1nnDnndB9Ttr1qJ9toeUC7UT6C+KUqm/hvD09PE2PChrgFzQqcYoxnZJAV3gewrxxk2kAV2BnszP29zU19QmfIEpV9V0dgAcxI6udLJx7jqEcScTm7Grb5M7c4xU/5kOS3VsqQ==,iv:ZL+brhagSu9BI3NwGYeXn6MtT59PqwP8our6DoUikfc=,tag:iNDwdsYYZG0OZitDWZAckA==,type:str]
            key: ENC[AES256_GCM,data:0romI0S+8Xrx6VS8O5EyrinDZhifo2HjtOqjAAVyEvd+Op82lr9vujk9fIZwrziEZGBE59Smd/pNUIle54wa0yQsxwpFVOmxpwZPlPc01OSOjJhqsNDLK4ncD6ZmyRmJmW+zgs1Jqd/OIY9PZCjrmkqFlDrTshvBWilmxuWrUNz3zcwr7zwXqRwRJlScNjXFNUE4vfrMu+7KrRS2eVKugTMz6GstTmfTzIuY45dA5fjn0di1n9ter4Yc9g9Whmg1TJ3BHZlodYXfo/pVf47sVvwTM+vsIAvSPdJPpM1yPwxL206jUFm3dbNCev0VDj1rqQ+GIskfDRFl+BnnuTu9sC7U4AZwJDfN5OcvLzpAtauRHfwNkuYXKB1BURHeu8QI+XjgFZrmRZjaBcPO4VHy+w==,iv:AG8jtzATL7Vq9ChYhohxxMnNbUEWBW+ClWcPXkToQ/I=,tag:JHmvrrcZVIaXcjZxh3k4tQ==,type:str]
        extraArgs:
            listen-metrics-urls: http://0.0.0.0:2381
        advertisedSubnets:
            - 172.16.11.0/24
    coreDNS:
        disabled: true
    allowSchedulingOnMasters: true
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSB2bFZpT1J2bTlteElRQ0hQ
            TTc0SzJJcHNqSTVBT0FLZTh2WFJobVJid1VnCjViUTdxZDlqTElqOWlkYXorblB5
            akRqUTdiOExCVHJBYWl5S3RlUXNJVTgKLS0tIE5xMEhkcndhRHpkY0VvZVh2S0Fr
            RFRiUnJpeUF6S3drSmpaZ3pUdzl5T1kKLYvGfr5Ek5QW0AB03fRPnTPVFhQov5X4
            r2nThIS4yw5LnnVw8dgpj47af8xx1VQlEjU7GEuzP5PDjzNhgY9hYw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-08-20T04:17:51Z"
    mac: ENC[AES256_GCM,data:kgGZ0hS3YriFYbrqKvX8n4Hhgw5OlVdIwqykkVmOzmK1FITWW/zd1qpp5gG8i1Wdg0/LT1qaBkO0s/XvrdSE/guv1T1AZ31PPKcjVIWEmMcaGJwptdEeRXdkRRDMIE1xBQcNNbhGHI2eN2/rO5wi4CLFzgIHBQpiYLCd3L3U8zw=,iv:ZpaMd3mMdLyL0ecwYtswjM+ohAO3gM3MeShmj/hmyDU=,tag:zlXV0KdoSesHiRw2QzS6sA==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.8.1
