version: v1alpha1
debug: false
persist: true
machine:
    type: controlplane
    token: ENC[AES256_GCM,data:o5w7wYnJtc6HMI1Df4tlDz2DQ03znxA=,iv:Tr188w9LjBHaWjR3eZ3pe+fE/GrLH/+1fYi1TzIGb5M=,tag:9f+8utwFTyfIRupiMb1p5w==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:5aXehilguYOWuhDsv89eGvyzyh5pQGMEfO5ZQBIHWM100Lp1gDq2EiyNPAnup76+VX1ypFxME7hnuNBwkcPVy0I1iS3rn60rXrz4lnsO0QEmS5TIZ5otmT5Czt8scEZv+NjIWdIFH+Sxes4NefFMNmM7n2ME12d21dJLvzivRtwpx6/3q8nSjMdV0JHIxKd2TGHoFGjZmykEG5SBI0PGew7vgtHtsG6pb886Gw3evMRG7ZsnfMsNEheGTkI/w4+maLz7psa8Ag8BHNxb4WSE5jFrNI9WhaILjrJldjVAQBRakAhT9jGwzj4vhncyJObqP/GVfBWBMH7fbRigcgpbyCdWdz/9lzAgJ0sfRTeO8RigGNFuv0se2NUBKrn/vbnnIZBuLGj7Dp1zY9RRe3UDR+i0kFFavuxzY2wsKc0WrAd2dosIZcopwOEPyU6VfYhzvQwp+mtcFGw+YaAMqfj2QqgyNX5UtM9kod0YL8PJRG9Ynau78YrBLJg0HzAlP+4L53XFe/XasZbeyfyVpc8m9UFsrev2UIN5ky/pzTBFzmtD2gKmhfcyefc88gWjCWRgNhVmK3dQbcC9ThYo3pr6JIPEoxKRlksTYArIkGSIasjgy0yPXosyJYORTGiFispS8IQKXsoxj+hVDSNDAe3I46aqHdkQtn2euBCWg4P/KrRuAVeR9bzQbTpkN1VZxAW+nxb9VawaI/b0PBtueSMJ2upzTPMAJdf0qSHP9abPnwSM/hka6G5emrz4BW+P7VBiX7LF9kdgbHyXx4aJEUwS1nbnnEtN+3j44RrA/Tq+i+dm6LnbLwV4Az7OolLY9y80Bm56totgabbuYpIL+GcF8VGPfiOkNsp14fO27egxmHzKGydu,iv:Avg7zHGu9bU2Ir9u9Kl62N3kXa0DqGcJzW4IYq4RgPI=,tag:O3WUNkk7+BuXzQn1d9t52w==,type:str]
        key: ENC[AES256_GCM,data:VBtj/z98MMEio8OKJKxhBSYf8qrZFRWgCyrjuQLOTisyxX2+OAEITKoj8CSCUADDQRLwZqqwPGJtQGf4Mt1RG/9dAmnuR36ptgJYqUzb85C+uiiBku8Lylt0rlGC/EUspzUDYBXFX3a5vpRGLODupvGA1S40iQ2C75IW74iHuMRdh78Y3QefZmfF/dH1T6IeOxswNzN9AN579Riar/9+TzuvFJAjs8acnxaf1w9BOMrsD4EH,iv:obO3hIhLBuhB/KsqiHjZ6huWYY75hZH2HB8lMMtiWzw=,tag:ZkvT9kynVYhwCWsB+EUrzA==,type:str]
    certSANs:
        - 172.16.11.20
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.30.3
        extraArgs:
            rotate-server-certificates: "true"
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        hostname: p-tlx-k8s-m0.monosense.io
        interfaces:
            - interface: eth0
              ignore: true
            - interface: bond0
              bond:
                interfaces: []
                deviceSelectors:
                    - hardwareAddr: e4:1d:85:75:d8:73
                    - hardwareAddr: e4:1d:85:75:d8:74
                mode: active-backup
                miimon: 100
              vlans:
                - addresses:
                    - 172.16.13.3/24
                  routes: []
                  dhcp: false
                  vlanId: 1613
                  mtu: 1500
                - addresses:
                    - 172.16.14.3/24
                  routes: []
                  dhcp: false
                  vlanId: 1614
                  mtu: 1500
              mtu: 9000
              dhcp: true
              vip:
                ip: 172.16.11.20
        nameservers:
            - 172.16.11.9
            - 172.16.11.11
        extraHostEntries:
            - ip: 172.16.11.20
              aliases:
                - k8s.monosense.io
                - main.monosense.io
        disableSearchDomain: true
    install:
        disk: /dev/sda
        extraKernelArgs:
            - net.ifnames=0
            - mitigations=off
            - module_blacklist=e1000e
            - talos.logging.kernel=udp://vector.monosense.io:6001/
        image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.11.254
            - 172.16.11.9
            - 172.16.11.11
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "1048576"
        kernel.randomize_va_space: "0"
        net.core.netdev_max_backlog: "30000"
        net.core.rmem_max: "67108864"
        net.core.wmem_max: "67108864"
        net.ipv4.tcp_rmem: 4096 87380 33554432
        net.ipv4.tcp_tw_reuse: "1"
        net.ipv4.tcp_window_scaling: "1"
        net.ipv4.tcp_wmem: 4096 65536 33554432
    features:
        rbac: true
        stableHostname: true
        kubernetesTalosAPIAccess:
            enabled: true
            allowedRoles:
                - os:admin
            allowedKubernetesNamespaces:
                - system-upgrade
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
            forwardKubeDNSToHost: false
            resolveMemberNames: true
    logging:
        destinations:
            - endpoint: udp://vector.monosense.io:6002
              format: json_lines
    nodeLabels:
        topology.kubernetes.io/region: main
        topology.kubernetes.io/zone: m
cluster:
    id: ENC[AES256_GCM,data:YD45wFH+kGBmsILvzSRlTH9cqf7kNjFEgMtNdOWt5P3Xf8ld+QzgRTrCaV8=,iv:aUOeP6EqyuPz3rTSJgLfkAl+oWCrM6CmK513iu6rd3E=,tag:5tZsG3lUoAgTZX2N7t4FHw==,type:str]
    secret: ENC[AES256_GCM,data:37f112mcU/ZjA33MdM1mb0YUPIFh4jsv7mH0Ajl6u+Flb5iv5aElnnZZWzo=,iv:9ki7wPMiIzJm2opsDK4vVJIDDD6x2g//K4gB8L+QAZI=,tag:8KJD4x5OTEDFtGdTY0i7Mg==,type:str]
    controlPlane:
        endpoint: https://k8s.monosense.io:6443
    clusterName: main
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.42.0.0/16
        serviceSubnets:
            - 10.43.0.0/16
    token: ENC[AES256_GCM,data:FwT7kqURWidUl2ZQ588C7PYbFcJo6EI=,iv:SybW6gutKZ3EfFect3JsmsAJsrc4fPmmJP36O2IbDIg=,tag:VzUrJNwFgTdR6IZjCnDZ2A==,type:str]
    secretboxEncryptionSecret: ENC[AES256_GCM,data:cpH3vmzHhJ6ioIHkifIMIJ2UvcN1tfFr7fSjBeOdJMS3lL4B0ZMjOlxqfVQ=,iv:u0hloFDgLCT1J8XxCAMtWsZ/PqlXF4cqmj6JneL1iEs=,tag:fL4gcmkC2vn+I/IVL//SRw==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:yff6V9zCRg0uxI/SV1l7hOV9xb1ZwHEGKGaJ2KoM2MswC38o/muVMXuh3tSiUlYQGo5b5uEZdAMD9UtQ2Us46TOZpqxajQMnwuniH+Kav6P6WbKpdWLBpeqmwa3NoMHG3tltPs5uKsOoncpq7XaHF7o9AZSSArhFDJJofY3yx3CqlrrrHGXCmGlwurMlQvlo6rXfpkPo5ElqiINOo5DJeM9xbZHS67INf3OT9+C9mziab/DUDy+tTUP00BXBBZ5BkghVXLIrqbSWMK6R0I5BnaYU/tqtuDP17taWtRmDmpgiFW6Osj+YidLkhxpekQw/zWiYZqlZUuQAmBwREbhZ5CWfcV/ELkJmhahk5z5aJ/rlObSGYNGLuPYMCKnc3VB4irtIPWKkCWlZn1QI5sHkxIMmxfeSY+Gz3hstPntVWRLKp4T88DpjmpkyCDOh+j3E6qHLiUK+dJXmKbUxYQ4FPj9+mVQM2HqL7hexAwFBPlLNM3ryWhouTr0lCL3R7b0hPIacGgbDy62eAk7BpL8aoom38tCUbW/QX8u6MlrbQM5H0WjBMmMs9ajZfFI4mOdRKtc0QgnJdBcsiVp+CJGChM79bLQYzngEnNVA67u0hD9je2B3lJNJU1kHUEk81IJw/3E+lOTJZ4Pm6hPhBed70bRKvrYo9YzR+DGG3PaqESEH+1Zm0R+w0wc/A4yrypiKE/j4OHNe5i5si46Z3s7XX9vrJpbLfKTnxJZhyR2iWxn6/VxNfQ9S/C/a6FIG2DW1RVI9bOCx5vTziRvLaVIubEIX0nMHuN9sUBRfmcv4Tm2bEImkahiqKFfu1Kp0KBo38UhKMQ7a1oBOdmoLkbICKjeDhIGH4Pgt70i1kKjqifWiW/Xz/n5DrV8NDTa5W8iePD0fg48AreLrzvT1oGU6QJ0+ow6LSIhbu9zitqtCUcIizeUP0xPkT4rJEB/uC9Jq02diqHuMb4vBPI+2CAPbdUecYpOwjOYYE1fYMBYKV/ANZwggyd4R7Ck2w8B0N51hNJMI48DAMB9Q5oA0DOYFArHOyHmHjMu7zi41kA==,iv:H3CDv/rGUvr47iGUEzh78Yn3HrknXOpErswN8g5hIRU=,tag:zbAKGSg7xy+HojVBUzRBAg==,type:str]
        key: ENC[AES256_GCM,data:82WZtiMc9cKKfU249e1toRPUtz6cSV16xmYis9EkC1LxUFulsTQqcLcoarv0qKKZgQj7thYhen3mEUDYLFX4cIRXa3AQodt0GChz88Sv9iO0qYIJJAmJ7AtKEzMymqp3fM3o9T5ZEuhgU/YdKOxNfXZGUHmKSlaOfK2XLNLqOSycXhv1LdZW9G2HOEugfKOiMwSSti2sAVzVyKH6yiQqifg6FU07NOZ1xepTmvn06/tUGx4kxzB6tmfluLW/R+Rfqkn13c6/U8MHScwBLojZGZ4vuhNsLJ7fUylsI8iBChSa/j1KSrKM/DMT/+v44ow7dhH9XcfV3tgUQpgpKcjBPiC55xkSMbIzXv3akqhsXGaCkgGrfeRd7zDPP1XwYrR4w0W1sCqls6dFYgx8eTFb7Q==,iv:ZQWDDBVY6iud9cXJr1BjhBGU95o0+NdPaYQE06EgXWU=,tag:R2+TPpaeR2OlbtnNRHyqQQ==,type:str]
    aggregatorCA:
        crt: ENC[AES256_GCM,data:sO0A5t3u+VyRfHWfzRxYneDfh5puQM9g6iBv7wnwT+V3p2/Cj3vtwiURIUtBvmqTItvHGKcsBR7tw9ca5+P8YqtRJXVltoqRbMfX4V+M7jWgAcOc+I/yEoyQhwtF3LrSWtHCW158eoL+URhuuZFKtkWsOOZeJew4okZd179TdUnfkSwSp2ptLICSgdmiwZA9ZIY8e1f7uxm7QwZkp0TLewzgejUSOH0xjS8WUaNcvSF54DOrd/4JmH46hkNNgYhKgHaJMAdwQ4MV302ypIiRIXEFwADrcLH0EbGr3erfGNwaiVAepUEHh9eoyLMAM/mHoB/iiseIDmADRvED//cQ2mQb8CThqC7HgcXRCroZC3oRAS//qtnATmsKUFLhPUNBKDl7AOmq/Khy56MgGK57Q1PFb5+HNW8A8ZZ2f8y5tXaSLmBSAjzhtP/yquqExIDJMc9luEolgrNyl+eVFYy0tcX1KWimNKqh/R1CQYPqAlbjkVY8l3ibF+UR3o65+cAPwl248h5ANzHZf1TE7/o6fEozaL6L4yqn4uEwtmrI63jDE70x5X1xevpFpP55QQx356UcQXcF4w+hu5OlpFAkTib7tneo+EfRcxHJkKAt5YuofXUqTSl+l+bn/B+MVlJgNc2rwxc84gYkF9XvxlARBSjHcAA5YTzAwAU5cdtXG8Vc1zLnALZglGOkjJKVrR6ROiZI/oMtikWW57CtcYNXRDjCrC6o5EHpnx7oHxHEKVlFQGrOGdmx1Apwd4Dz1MWz7H8OkniejQRm2ofJqCN2dnjwSVU/uhvq1O3Tsop0sVzqZhpFtZaXl/ywpF+tagN27HrDSFOoemBBQijEMTtsYpuh3dTTEInG5+XvvPYw8pYXebh5SPadDagS4UTD8mBnlp+70tpARcNWMYbiI1RbweOOTr75xDvn2NvACgrHfQB1owWJvQsB9eeNSeY6HAIF,iv:BQKi4XF1arHTGelrmddiO03dE12wqn7cqmjSh/NVC9E=,tag:HU/HJVG4tQ7hWScxQuRqDA==,type:str]
        key: ENC[AES256_GCM,data:Pac9X1rfNgvVLI0dXeZtYJ3uecRbdPMCi4FjudkjDUdeMXzHuqMyL6e71oz3Do0+lGJXjkPhzRCNSA/+INULdgWFujNVgG1/c3kyg5HHl4A5Ur7Zc+6CqklES8haoOBwl4CBtIX0/tlWuEtzWbZbM2U5/QRdfQE+LBjy82BDFUUFJYOtNuZZcd2yY1X98xQuHZHdXx9FsS2JDjZCYZt/OGwvefBkB8Uel1sZUKcIv/IJD9EFboJIJnQ6huFj4DOxVJDNNyn6hbkCYGWF0q4nPY6/QDO5JUqyYtj1ufXFpS1EBcB3DOrPVVtHy7vQRoSnz2S4tYPZvRE9KNwlmkt6wa6eN49yM1xH9/58jZM2XzZOQqyhp1qncDV8OIDm8lR1B1COFOP/Ilz/5DcP7AQ8Mg==,iv:xPyVnFaLSiEQvWoN2x7cA1glcghyhAPKIn2OYjPxEOk=,tag:z6ElBJX9MC9S1fnEnpApYA==,type:str]
    serviceAccount:
        key: ENC[AES256_GCM,data:Is7WYAdRa70h20plnWQYGvWufn2vl214ovbeCGqgA/OcIY6dCz0cXLj9ksIV5WU+boiKeYc/vm/nCDKMR9RJ0NcGfWzV37d1TUVFCf5i04aIr0LcZxo3zyelDi/e9GeB6K/PQZct3t0l2t0GVYVrhPbze/IjGgnUKa4zqmjK2O82jILYSABi824mk2FM7r5lgdDO5WDT8G4G/NUvFfb4gYk1gwvsWB8NYMHxENqFU2ChCRKOjoEktR1KroMOCpscyKCsjdS2+29gxTrgPBKVfBisZ5UyfHnkUs70cXZH2YT4ND1YCtWaNHaYSy8vXdCOErne6t6pjxT5DRpiwgBVFqPvCpWSdDWIqi0yy6GHrFCExVTLF/VY68WONo0YgBpfE+fIXu7L//dPqvl5v+Ey+Q==,iv:iTJPxC2Yk4zkACHy8KxCG67s6spAzX+NmOdX/EmfsTc=,tag:mDxu/hUjGzAYOdcySYZbzQ==,type:str]
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.30.3
        certSANs:
            - k8s.monosense.io
            - 172.16.11.20
            - 127.0.0.1
        disablePodSecurityPolicy: true
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    proxy:
        disabled: true
        image: registry.k8s.io/kube-proxy:v1.30.3
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:yd2RDmQgaI0/qvYftGnqmdiiRniDpXZNRSciB/VYbH+ZXREj3EmgltDon8SJT6VpEy9fJKR1zNv6qJP11igUzVfERA2oRkKWDxhtvIlRLvwTIi+8gGWfgUVTtPS3282pSsXilwe4Xag0pHAazb0VGO52qg8InrrsqIb2fMnaMifKVlEggl+fR91M4f8L4jDgZJydffbJSnWqcyjMxPHHXnSBRS7AQF6rXlRLUFbr/R2/FuL9NKZOjpxNGfawXA7Di7d+y1tg2Qyq1nCSGRNbCgR1xRj40nkMIl3linGtgI2uDlWlk5lSaf6WH7Vr0JMelRGCgqM5pUxERHj+M/nHy2wCs2VeoPZGhbIHZF/evg1lzFxSkJzeKxNsYHcZELHY525yGhve7Z8fbDdje/O4dt2T4tP7RoUtht3riQLS721gnEwss5q3sIXb7hKL278x4z+k0okr3rNxT5kwlB3YQ4/NTbrHzwWYCOPv01wwi5sqm8ImUhPHCg5iUlL+UZWV4Cv8DemHfFbtLehltlfBhfYwhn6WmH8/+wfn0YmaBuDpQGR09P7zo8wnL1wGlVRoettqEwb9ZwT2Yr0Xc+F5nX0TBLgxUHKYYa6MyRzdGjksQgihHn27YIQnXg/q2JQ7gaIMCYqM8QG5Zzg0Y3Vr57JiAKpTaEUzgN/WDBPzHQsAcgkv2uq0OK8fTKpVQ1KxtdQVHzZAQp6l4UOJdyEuvEOe6nluCZ/Rrgu1PiOdLIvBx1vzNGIchU01x2XjVqioGDWVKMISpuYUojUJJTZf7zIUlB1TpHRvl5WQPfDiA34N/C1BsyJIK1PwTW1djEpCdNVs5BRYC6wISo7J2vrPbRJPMrwWwAEfBsSmzrdcvwuc580lqP1ca5ZDHMh/rn7UlIJEQr6FwFcGzfZg5O8Xrpxl4k9aymfW9IcUxM3WQbGAEegltISWk+8xT2soj3xU2iomrMS0eRH4gfXfaWody7AyBuGbc3KJmu4E6ZvCphcTi3okED0KbZsj4fEMGyYIeyQ3TA==,iv:2SFAtVKihWFBF7xviejrkLYJ/5moqnVwVL6BImccmiA=,tag:mV/G2j6v09YMWKCye4faSQ==,type:str]
            key: ENC[AES256_GCM,data:I+NoPWL3hF7tDVLdCVK0cSeOL1LJxXL+FTLnNsHH/gVxNjY5g5hph0tF7J2lm5Wjyznyn9ktt/DN8SNQ29GLwDp8QvOKRjT9HfqFa8JP2XV8L2DBayBcw6vWw1JxvKt4PfbDfDkYc1Q5ql2xnAHivCnMjsbko3fZCwUu3xJhyP1foQI5a3xGnZAulcIvVYuzBSxjaq3u6N93LglbepXirXbcYajhOT65/e+1u+FwGuDHocQz6dsQSdAd+egReedMkL+KLCWlhw2PyBSoUYSPNKqhe0iLU7k6oI40fvhe9rvhPS1JE67zTQZaJAgRhQfkGULPUkLH91JpzZJGL39BqouoRf+HfLB5PKapusnBUKXDrDb9hRyfBwFyrsf+sL5tmPFjPp2a7t0VHLjsHhj5MA==,iv:IwRX0uI6xcOjxzTpbnurtMHL1KpB7kjVzaVcXU+vRI0=,tag:fdMUzE1ZM+1YzcHiE84+hQ==,type:str]
        extraArgs:
            listen-metrics-urls: http://0.0.0.0:2381
        advertisedSubnets:
            - 172.16.11.0/24
    coreDNS:
        disabled: true
    allowSchedulingOnMasters: true
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBVSWJMTXdWL2JEYzdGcU44
            ZzVob2g1QWdnSExuS3lRSUlFbFgzMWxFc2lNCkZCQ0g0NXo1SHhoa0g2SUIvY2Jv
            RUNnL0wzdDFZdWw2d0Q5ZkV3YTBLVW8KLS0tIGxJS2hTMlpDeCtuMnFCbVZSZEhx
            QlhWUmtkT3ZieGNnU1M0ZWNmZDd2c3MKzpjcY67+hX1D1stLhDjVp41dsyGzbT8w
            Tf3neqlmz+UkWFwfIXBAuchFyyprMM9l4DcY8gItJZXFp9PqkOlO4Q==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-09-08T03:00:00Z"
    mac: ENC[AES256_GCM,data:J18zmHPUxRUFRw6xxq6LdPLEUPll98LyvShxbGtT4aDAos0U7nPUP78DcQZB4nt2y+jhUK7X9M0NAK4yp7tRtsao9qx0EqvmUTleYxd/aiBIMlFIq93AF9nW3BHSNipywatlyfM+JqHL7qIuCYyYLmJB12so6oec13Y6fPQoJzE=,iv:fKkPZczWaf7MrQfmGDSX0s1YHi/jCnYnTRCpHLZWmvY=,tag:LWFw75rUcS25C/eLbr2+MQ==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.8.1
