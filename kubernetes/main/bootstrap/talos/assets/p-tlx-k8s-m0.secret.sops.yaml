version: v1alpha1
debug: false
persist: true
machine:
    type: controlplane
    token: ENC[AES256_GCM,data:io2rUk+G99SJZXZ/c5sYAY156bkF7PQ=,iv:UCY4lxeyjfWxrD0/bg54WnLBY15Wdtvyq2H9TKqQMKo=,tag:HAoQQp/xN620hsgN1rGCKw==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:EAUZxO7kn/nbbUbU7mSnWN801lE9804S8QJxUlJjzURWkqYN8W1r2FQ6a6/EJIF170TrZsGlSwt+oUk5Q8WaFHHK25ZXhSAbo2dqVDF5/qkN655hdRU7ZcPuA4Kg5Rh2751jVXXTLvZbz9zHaWBYuOpZZdzYmnjAiaEcltEDYzkwnOxE1HhyGivTt5bokzYT5hPze7kc3Irxt3sLNPHNoonWSfU4qLkklaYL8hIp/5iGrzgTB4x0893xG3KLWfmPKjg0RyCFADAKoPx5UNu+HD4Yq68ixqLEPdp8ReR5l/UMMuwuIerHhAPYupBhhYLNtqhj5TJ1m90NbMG/2oQU72lRbzp0AeSkvN+Mj2q1/hqRGnCWkB5n84XE86Gtoz9pxXI5qcGFuA1A17M3BwV1YGrVe4+5sZS0na47e0a0jj0QyPQlT8Tzc1ZbSJmymLgJ0bi8oPSiWtjm6oV1Voxih4BPKqkMZYK6g9o71Jwl32fuwS2YXvk3XM5uZxdOKhSClkdq9u4CvF4HZHPa05LJ1RY4Yg8JfEdtLdV5+mjVuafjUHbHY9vycM1Asd7zlNhqLlkTnzfVtvbiNZMtGytL6BS+1PnhsbTI2AgNxINr7dXDlvDh/Crb4gWbcw3Pz5HbKbvnx/e0BAXCFdb+cAaj4RjjintIWyjsYuzZy1Rgwo+I8N0aUHFbY4jnFh3oAqLsCUxP2kvMh8eakdIrPPVOHxKUENu3SdWE9NeBmXuEtg65W+CX652TcjGC2RZn7ZD6ZkqF+MlLBAtnqwAU4aIdBK4etBIkUlt0bthC0YBPT3Kce3Sm/Rb+BP68psWCeY2lG/xpGI5rcMF8cinvFBPjN5KJYthmHyWblWiugRHg7y9i54R2,iv:PAPnGOhmuwxBIo1qrhs5R4m/zPh4eTgTEq/EnDehFiY=,tag:OndaOqz6k/88wkqyKJEXjA==,type:str]
        key: ENC[AES256_GCM,data:ZmO2jgb4pREm0CCRAs2Qthtp3bHpq0zOq3l1RulOhQLMgQDDmLwupVa2dlZpO+JBxBUhm44iJwSxuQb7d2okvdde8R2+nh4NZjp1wWP2+6m3XjmonMAwQZ3hNO4GK3JH+7U36oKecQTAgqhczffIp0A1Lekrphv+MHEZN6/8twVF98pHEETV0QHyT7shcycJPvM3yf7blD4/uNl9t0s78u5INd1GccrVTO9nW7Dg/Z7ZRaoW,iv:1OQIxo1UqY9U8Pl/UMEpiWZizgvvIvFOQbFc/THlRIo=,tag:RWpIszvTWFS7rvwcQc/93w==,type:str]
    certSANs:
        - 172.16.11.20
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.30.3
        extraArgs:
            rotate-server-certificates: "true"
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        hostname: p-tlx-k8s-m0.monosense.io
        interfaces:
            - interface: eth0
              ignore: true
            - interface: eth2
              ignore: true
            - interface: eth1
              addresses:
                - 172.16.11.3/24
              routes:
                - network: 0.0.0.0/0
                  gateway: 172.16.11.254
              vlans:
                - routes: []
                  dhcp: false
                  vlanId: 1613
                  mtu: 1500
                - routes: []
                  dhcp: false
                  vlanId: 1614
                  mtu: 1500
              mtu: 9000
              dhcp: false
              vip:
                ip: 172.16.11.20
        nameservers:
            - 172.16.11.9
            - 172.16.11.11
        extraHostEntries:
            - ip: 172.16.11.20
              aliases:
                - k8s.monosense.io
                - main.monosense.io
        disableSearchDomain: true
    install:
        disk: /dev/sda
        extraKernelArgs:
            - net.ifnames=0
            - mitigations=off
            - module_blacklist=e1000e
            - talos.logging.kernel=udp://vector.monosense.io:6001/
        image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.11.254
            - 172.16.11.9
            - 172.16.11.11
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "1048576"
        kernel.randomize_va_space: "0"
        net.core.netdev_max_backlog: "30000"
        net.core.rmem_max: "67108864"
        net.core.wmem_max: "67108864"
        net.ipv4.tcp_rmem: 4096 87380 33554432
        net.ipv4.tcp_tw_reuse: "1"
        net.ipv4.tcp_window_scaling: "1"
        net.ipv4.tcp_wmem: 4096 65536 33554432
    features:
        rbac: true
        stableHostname: true
        kubernetesTalosAPIAccess:
            enabled: true
            allowedRoles:
                - os:admin
            allowedKubernetesNamespaces:
                - system-upgrade
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
            forwardKubeDNSToHost: false
            resolveMemberNames: true
    logging:
        destinations:
            - endpoint: udp://vector.monosense.io:6002
              format: json_lines
    nodeLabels:
        topology.kubernetes.io/region: main
        topology.kubernetes.io/zone: m
cluster:
    id: ENC[AES256_GCM,data:/pdRbm77uM7poNz4bbuf0jnmfuxFgFlsRc8SyuJQnDmWTcAf45ZSjMXkxIo=,iv:8epT+IBZT5g8GsaNx46m1TdsUQYZgBzfNXaAy7hvkK4=,tag:vzrkx409pupou/RR9c1Ubw==,type:str]
    secret: ENC[AES256_GCM,data:mHkumu1xH8cB6mYUqAd/PTYCBXBq7eYST1euBfdAtIs7WlJRpiXhBW2GRhE=,iv:JLZ9qOUdAzoI/eC09aVBeCoo1OQXxclsNm5RnueXOoU=,tag:qFXbTrNQg+6cg+rIRa4xSg==,type:str]
    controlPlane:
        endpoint: https://k8s.monosense.io:6443
    clusterName: main
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.42.0.0/16
        serviceSubnets:
            - 10.43.0.0/16
    token: ENC[AES256_GCM,data:Skmejg+ocsyF4nWQhXpnaA+ZFFTf2qM=,iv:jjmBjuBgUV6F6jkjj6JfyDxuYa1Rr9akFfucjIoDukg=,tag:pyJ4Eh+dFm++TGjHYOqBuA==,type:str]
    secretboxEncryptionSecret: ENC[AES256_GCM,data:DQjJOcEQzJf6bIYdCQWAUoQGfWEzLr0hYxd7L/R0D4i+nrQDGrlxEPsSpAw=,iv:V0MKuFLJZBWnL3pBCf22hyMv5AGkSowldVf4hdxM8T4=,tag:gnDLZZ236V9V4wcYYA8R6g==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:1mViArRv0zjawvTZbsQMTKax+09EGl64FIoTcUDx1x2fYwD9+IffDUohRace3UOVelpPXmlJqF3H9cC3E3KcU9QFOcSsZjbRCh8X37lO6BPLMKmiv3iGx8zirv9HXpASGhO7AebnCygIQwRFMop1s3qkFUOjO+ujrxD4cHwNsThsz5es9e83uzvkKZfm7zWnA4JnCVDybTNNi4fOv5Y7eRwOzlwqa65GfAczMkJxq5RqXgpXUwOM7Tinh6xb/gJReGLpem+pMWgRY0luvXaVTJzOYSBjqN8E8UA3+I4wtbTciyqqalU+BEHbbATJwooDlX4ilxglp4dml9CNKmO0ZI3j6IzoniG3NAgscKxZhRbtO+AbEQQxxFHu+tsrYPwpQNxdDFrRAf2Ot8rVLiHz7D8xIiqPYNsn3xhDk4ImfnTMc0Us1KiD+ZLPRG+o10w2VhdhqdTS9FyWaLYNJQ5MgyedCboszShffJAn36NSTF2zmcZey9XPjecLwXX2JQnanRPdxnstbaaQ4kdF2F1gXm7JBFb75Q016Hf1S1Ol16G68Hr3dgQfw6dHM93PzmabAvgZ+dg4NW0iO99uX01ZNhfzZ22O/37NXJlCHVwQQVxcxf7ScDD1sxfbYQrx0u7u09RjBtB1TygzT7w3OwyoV2hchqg1JJM2tSUxtVmJ0Aeop1vWtqVhHpAE8akUvoXMdLrpMfxjw8IZTBxJp3QezSHhQC86uInHAZyMYIzf4+Fdx/gGMqV6HudnGphZlgWwKbn+vid/OfxxjkUffZByeD8J7o1P3kPLN/uhoNaH89Y4yVUjR1fdd4y3mcD99Yg4hp2fl7aQd+m53JT/3PxYPeUd3hKxKnvzx5AaCRleQ9N9UsIsfvvl9EvnPLxdN19+LCfLbgfEzMxq5sSs9EZ7MtCl38PrXVvNsOqpwA++vd7agTCaT0Vzi4IIzb/tI66OCTABKoSWkMVGlTDvhggwN6VBDVipgPShD3+Bvdmxn8KXhQbCWcjrYVJ4cvmuvg19cAFxdsdQeK/GDHotxAVk4DUDuK68l+lo/IqqPA==,iv:+TgUOprEoQaDEdf3L8rz9HogKhJCeSY17tiEjIVbF7I=,tag:cZ6BWwZfjHFEsBxHWwbhKQ==,type:str]
        key: ENC[AES256_GCM,data:Z3XoNowZoBRXcIjMaTmP7PXqW/nX2t8xfzaMIUJ2PswEDMbgqnoeOyZIQo8N7HLF/OfJHaZtXe2NuP4qo5RQtqn4xu+nlNbMusxMZ15wijKw0aC+Z1HMomrQymiky2Np0ZK+8u9r5vW9cpT0GYIyw/ZCxq+fyKEm2q5E92kvwRslNG/aqH3qLhQXJGettc8Iq1uX2Q8ollzkXM/6aNrpd5zzU29uNsfoZrhxr7qz6dngvI5v5Cpa3L9lKEVwe8SRnrwpXUg6nQF6KfpLWPMr7tZN5Mu2Z0SaU2CtmeCM7VnwOrtnLItGnylyMj/my5Ze4eLNIkw6x1R4trEVP/zqwydPMKcSpsI3nZYDL/TruXAiIMwAs+FmsprRe3T0HRxIYnTzXLPVGjnDCltTarmg7Q==,iv:Drjc/E188NL3N6pFytJXJmWisFI7tbV2Z01Yc7fRPfM=,tag:oJ6Khnrhlg14EUrRS8WF9w==,type:str]
    aggregatorCA:
        crt: ENC[AES256_GCM,data:WsRfvkCKA52bbGrM3agBX5a31K0fpUUvHXSqIQJPSQ2jhVzIGcpScxhCXxotUUUStw0iT/LHjo4OUBoFZujJvfmxaj8OHBI049aY3aJ3wEWbFNYSxlg1+FKW+cDojKtVO8o5HGcC2mKVq3hLai49MYwvieWNRD/Ljc+l3niJG5/JH2klO3ah80dPf77rLAF7aRlsedgPeRv3JNcNLX6y+GthH9Y3aSGQMqaXs9VxMkNF5OOpVy+V6j9UjNSTavwHHqg2BDDYAz+qfGfXr3TYSayYYol9Ac5UWFrCMgtyfvoTleZ6Gr3KNJwUcAilr0nLCLzzAqo73LUCzkUn3m8tQSWxg7+q/9BnkhQub7GPOuJSyhkINwkLeOkR1zE0OBuUfELiyuQKBdOb1hR+KWrWETMUhzDzkTdIItDX+335QztI5rD8ZWsWQjUDw6DTrrRK00j6+Wy3/nKBy21zZzgIPQf5/hFmGdgXYpladQDccD2TkQWuR/oFlhr5I+bU+lD6veyAb0vMJ/I7V/lTxN+OYKAf3VMVMV/bb/n6pLhytssum1KPP84cUnQEov/Z/YsBrehdI4U2l0Aawxw7hT4Lx8swb/2G1A0m7z0xqqWJgplDShPqDTHLcTJCRX0FEWf8vBz/4xWx29yxOgxbYZI6XWt6yGC50k1apPm1EW5ngUMoM0Nzql+F/JfkdDHB5xeKIQyMSRcnZrHmFzCyHKWQbkeoWZ5ltFXPmORautaleQz0bFo2FgeCmjUl/o7kic9VuLq5zHJzzPz9gQADPn55DIcrI/+q2g5lkyeoOOZbRHli9Vul+64YQcuw9OqNBO7AHFoXOAPozA69f2YO+hkMC/eazYPbhdZREbddlIyZ0gzv7l/h+6+sC+VIWW/ms/uaafTA+jrNKPyPucf1MeAT3tgom73VNB3J5u2AJqXXcys/EQWydH7AxhWo9aqmPTpY,iv:QHZu7dpC1mjtAh/vqkNf3K4O6PIiKHzWMtdhSQtSGfI=,tag:oXdTPxj5fFm3i6v8SHCyHA==,type:str]
        key: ENC[AES256_GCM,data:3FeJ5eeIbdNEXQZHSN5NQBcOHTgITm+ZoWJM+sddxwRwXZHc+wnzL3MQqp7lvOgsaIZ5ikUiDnx94GHQKzGV2qb+K9SxspK1lR3f+sWtoAhkqSujHI72LCKh63qkmM8Okuuez/1169gw0kGuhjr4Q8V/SWE76XDTBjP+fefswHbUyypJ7FxZC8XURK6skuhFhmMckTx+kCdS/GYmVlEwqBRwncqGYbJU6RhBWnopCv9HdRm0HrizF2dTiQc2VYFvjqKtXkpB5eqvLzNek9FKe+IOsyjyvIVMk+kdHU5fe0clZKR03XGlsmZSRQe0kVSr8W+nLothsCvd+EKflOh07H7VOZ4ZYISE7SQ0+PA+zmubaoYUhr7KhoraLV0NtJV231YRWu5RbxaSVctl7f7XYA==,iv:q0GZ9TJlwR+ssQ85oXFaqN4TO5gCvAPZ8Q7d50Bpf6c=,tag:lzOjGiTwSSeCAJJrTNrFHg==,type:str]
    serviceAccount:
        key: ENC[AES256_GCM,data:WvQ5ZJwc8qRYxBqQufIgIRv+eygdNzigrsATJ3UbQQprj5IRzDpotd16q/1aorCIvSlGu7nruItQpDd68m8ljIKy1SfhQ81w36q8weebfNSp8+U2yVeMbXXnv3Ob/b6rNNVDKVCqAixfB5OoFFXpaRfsRZG0ZsdBidK/AQGW7SOwl/G4SZVYZaP+BdxKd15AUwa03j8gjOZmG0+0xRdHyJybTmfO3AmEQj3jexTKRR/MgaRDREotpf23q51Iwtj3Oirw6hqCkj3EHNAYb08rIJypr+G5ovKi7wD2/eO3qo072jz5NQSWMcN50EjZRt/zClg7HWuOs3Q3YrFPuE+XSEl7XtFz84L02Tu60asOPR65NXf1rn6w7joEwoFq6icgFCUWCjy8LM4uCxihcAHbIg==,iv:O7NPFFGYwli8v7YCv91ibhgdI3olflWQBL8EMYywL0Q=,tag:3xHDDhyklszmAqBqtBs4lg==,type:str]
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.30.3
        certSANs:
            - k8s.monosense.io
            - 172.16.11.20
            - 127.0.0.1
        disablePodSecurityPolicy: true
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    proxy:
        disabled: true
        image: registry.k8s.io/kube-proxy:v1.30.3
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:CnvcZ7tFdLSSQoeeLk5QPTzg4VUzBdJwo9WPwfcXHiAgiwaW45iPRgV5eGWIUcZNm6dgMEa/RB8NCCXDo+noP8wINM7sn99/9hqkWkah7qSfqvKUUq7LcCpvx3tLdDyp0/SDjxObpk0jj59vM7JX3t++jFCWzrRr3bWT6G1fdZG1R0cqlFqrSwuSkHBvmB7hwK3HsOjsmA+9usap2qsQZcJ6ec2oiL+hxxyvHhoWfjxQQaS6Az3QlvdXKr3LAQRdGAcGsSInin9xNmBOJy+q2EXNIDm/TxAvVOiAHBv72RygvdGurpvGa7jZrj2Qs9gMqDKD5YbYAZgPoZ/OoBjrDW25etOZv8WaiX5laL6ETwWm06HQz3Js9yAqlBWciQnN6DfIrZ+O6s4WoGbKoQ+5QQdOycdqsc4866TkOy6fPrnqMFQUW/XOI9ngErai9WQk1Tv1NXycIz7BL09NyTbBcsMMt/b8ltHYVRnmort0IOJoYkSIf+UNc/CFokxftZSX4tBFjF4coD9f5fNFJnT7+xODgpbOMTQpervhNdA1N/VswmV3KR/H/l3HEV2BhceNTkLsoafOJS0XnbSt6tuh8hkMrnL7GGheT+uAbgzEAs37ZAftrQfTl5nnbS4CmTTv4v5dZtqEvVD89d6SjPRgbAyOXQwey5rp1l4wg/jgqL629rv9CTUrVII/Q948UnWUHzXEAXYKKtwxlJBpN1BQIvmgTLLaDWvGPMu3cxhSz+EK1qOWz1tyl+EMfEQjqBhwv4GwJXxhBF6eGpSPoFhxIKPliUdi2mVXFY79t4Z7TPYZWMpiXlyEzjbyM3HSS6eWnK3YvHB9T33D9jF1RN3bTqPtiHVSBXld4J1EHpyAjLM/sG4opVCXtHSXcMW4f3cEgjgzaDIkrUYHdd1jczpKVVqzGBzME8GtpqRBxkrzz+1MLfZ9hqL73m5kCBkU7ZuLLcfs9SGMCBXKe/+EB9fFXSD9cg/C+SYLLDNu6+JX9zufjqIWeEs+d5Q/hHKdzd5Bnwwc9g==,iv:nLHUlXNSiNk1y7zohBA8HyhtQYWnLMoHzQOG4CtKzvk=,tag:BeJC9+j5gClI3tzik4+BeA==,type:str]
            key: ENC[AES256_GCM,data:o6fhlnTAz/5ZEvfIJAsjXckak+TSok+JGGXIGk2sIu+Isypj7VDVZ8r3OI7YsbOQC6TDh0ZxWW38XfowMyXr1sOo+Zb163GAxoYVSbCavhPFysbTA0U8XvTtgiVeNhCE24BVeCNAVUQVdv3x/ZeXAmbhQfsBRGwFIoj3LUkMCVUHiIjRt8yVrwgCBmfVScmBFsu/NaaR9LIq4/aqht9hWPKI11ran0NIwV8E0Opz9Lahu2E92tM8sgneNss9QwShZFBN7X2E6kSx9+pSLx7m3LOCvfAqz7ggc/qR1fiFRVz2eVd8RsrQMaLwlg/NJpJt/NBKSBhgkA4OwchYwfp0NiWbCmyIMqXaZoeSVKDhJaP265zGil8XGgByiG+g2xJR7k7onu0ax76iWJo1lqLgCA==,iv:W+D3IrBU1H67p48MTULgCVIBEjGHA9UT5aXgZbW0dJM=,tag:KGUiSz59bmcfzKGUv5VEYg==,type:str]
        extraArgs:
            listen-metrics-urls: http://0.0.0.0:2381
        advertisedSubnets:
            - 172.16.11.0/24
    coreDNS:
        disabled: true
    allowSchedulingOnMasters: true
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSA0eVJ1YVh0SGVNbll6V0tQ
            MzhNSGhpTVduaTRLUkFIbnQ0YmJzV0JqNTFBCmNRczJTeTc5YkNOMlR0bERTa0RM
            RG1MVmF4V0VSSElORDY0dEVhMVpyWXMKLS0tIGJMMFNVTnlwTEJCaTlvNlFTZkVC
            eS9HTUhPMldxYmI0amJySGI2UTNCek0KUX5qOzIjbUR77gPVoDVY3kcJkhdT17TG
            f3KqpPjIvfpS7CV4EgI9FNV8/+eiHFOCeCcHd5U8LwbTLpSwAPV/BA==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-09-09T02:02:00Z"
    mac: ENC[AES256_GCM,data:+330mYRgTJhwjoeozWQlLLnf2XNU9ml519QU3dZF9KiPotHOnNoHcwc5rKKtNt7al2bVOhIRYtoIgAbFNRW5oabkW75+gqkqaN4+TXr6huub3ENV0POsLDllRHXU5lRg4KrsjdN2fOswRQhMwhaC4qJRApDf45wldjPS8pfm6ls=,iv:ySPjMMJTXWkTFMxknZ3fRoXvjhy0PoTmUypnAjm8MQM=,tag:vem54fK/+6jB+WeicGIYtg==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.8.1
