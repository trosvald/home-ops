version: v1alpha1
debug: false
persist: true
machine:
    type: worker
    token: ENC[AES256_GCM,data:Y6TZuXOAXPlEyqBIA0+smKXG1/vU9uE=,iv:ELH4jhOBzDUq11qC5TOVWmY7/iP/4h64AHT5vUOJZXA=,tag:j3qBkfKMKIsmE62DqBFBmw==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:PAsFl2f45k5fSCFqRXACAnoQxlQdNsnKFLsHi6dI0fsuPr5/2aoyT9zvnRjuH2FGniy+/OvkKvR5IH27AKFluBMvFOt8XZ929d9FqO/sn16H9ucJgg4MhYLVg7SNH8JfZk5DE+ulAyAFvdkKHXsMfZC3zwHOGBzlQNyi6wNP9qnggrB2C1ikFmRov2X7wmskc9JVvQ00FK/+s7wlN2l6Hk/rVZrLZGcklhUCtFaDuMf8Gyxlh5HZw6ujJcztXHykfrGx84W0MAnRVocQBWSSnyaozVn8UH/PPdguBYGquZIVTkQTI+vh9iX87hxZNwE0LQqmluEfnQHWhYM1NrzkYEvcw4ISVpp0ykN9CE/gUbI4DBwps9dZ7DEPjLeIlNr4VYYF5x2dJUpaZS2q5eEWuo+8/JAgVr+rXW8A7xi6GRC2kK0krgHU93+l+s9lFKIUaYEvhBHmGlPXYJyXTq7vE3cXeHH3mjqQtO1GMrAKH7PgP4LlJJCvbjlMUIr492759Y040jxT967uRxhj8StVjH836uvLn/29w8TM9evZ8HF3602iu1/guNijPX/+W5o1aGXcxxH9mLI/Ag0zq5HifywUdm1494IXmySpprRRlC2nLzYPs17utmoiDv6MVg5OiloOInekbihTOSpbQ8NlAiD488NfT7MzlxYI2PhcgEHDNVeFWYnAw2RqQ7ZItTt3oHCv5ryXZFmVweDVR/YfgRU7M6qPPao9XTxUOvWogreCkKlS4fAdbed9mEwTKBuZE/wkkwu6ZmO5zTpyyvGzZSrDVwCzIn20QjUND98lh5AY/3es489MOUqN41v5tYRzJCqHOl50XPxeacXsLT3ZZLSVmtn1Gv3j9dk1Q+RaCbmOLx5X,iv:dSyFciLM2W7kUKHoxGh0TK33O55C8R/ZL2wb0CnYaXc=,tag:be2aOl6Pvn7hP1g+2gvG6g==,type:str]
        key: ""
    certSANs:
        - 172.16.11.20
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.30.3
        extraArgs:
            rotate-server-certificates: "true"
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        hostname: p-tlx-k8s-w1.monosense.io
        interfaces:
            - interface: eth0
              ignore: true
            - interface: bond0
              bond:
                interfaces: []
                deviceSelectors:
                    - hardwareAddr: e4:1d:79:67:75:95
                    - hardwareAddr: e4:1d:79:67:75:96
                mode: active-backup
                miimon: 100
              mtu: 9000
              dhcp: true
        nameservers:
            - 172.16.11.9
            - 172.16.11.11
        extraHostEntries:
            - ip: 172.16.11.20
              aliases:
                - k8s.monosense.io
                - main.monosense.io
        disableSearchDomain: true
    install:
        disk: /dev/sda
        extraKernelArgs:
            - net.ifnames=0
            - mitigations=off
            - module_blacklist=e1000e
            - talos.logging.kernel=udp://vector.monosense.io:6001/
        image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.11.254
            - 172.16.11.9
            - 172.16.11.11
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "1048576"
        kernel.randomize_va_space: "0"
        net.core.netdev_max_backlog: "30000"
        net.core.rmem_max: "67108864"
        net.core.wmem_max: "67108864"
        net.ipv4.tcp_rmem: 4096 87380 33554432
        net.ipv4.tcp_tw_reuse: "1"
        net.ipv4.tcp_window_scaling: "1"
        net.ipv4.tcp_wmem: 4096 65536 33554432
    features:
        rbac: true
        stableHostname: true
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
            forwardKubeDNSToHost: false
            resolveMemberNames: true
    logging:
        destinations:
            - endpoint: udp://vector.monosense.io:6002
              format: json_lines
    nodeLabels:
        topology.kubernetes.io/region: main
        topology.kubernetes.io/zone: w
cluster:
    id: ENC[AES256_GCM,data:/had9dOB/vf3jUeLfC1C4GX73DyKKZS4Bf6ckfsHQNysv6VHkslznIbbYLo=,iv:rKg6G98RDqDLyjTYijV6XZj/P+o4vOvSetxYOGMCU6w=,tag:DvO9ZY92XDHCzrHF04hGPw==,type:str]
    secret: ENC[AES256_GCM,data:tX0D9BQn/ttb1le1Uv3b2veDbh+YN9QBVA0AqMSKehbaYtDbdRvFdCFNP0Y=,iv:cXzXGqMKQKTg4xZfArkLBptg/7kj7x4ygpsV/dijkKY=,tag:CtAdvAWHEbOaozd46/KYhQ==,type:str]
    controlPlane:
        endpoint: https://k8s.monosense.io:6443
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.42.0.0/16
        serviceSubnets:
            - 10.43.0.0/16
    token: ENC[AES256_GCM,data:Ke0OjQJK3OJCqgJ6ZC/ZbyYeK08GF68=,iv:kz5ItPExrO02c41w6KqUP84RqXt+gtaPlxQUsBH6jow=,tag:sqn5aK6VJGGSlRxSOkBFPg==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:DK53n0fe6q+9wx1Ltt0IcHRA6cVT2uZdABIL9GqkMjG2ch0u5xzNJAENa2pTIlRLhYIJUDM8w+Kb8Qzb/kflDXCeKiiPCCVwn9A/Iwc9HIQMPU3EjB/cGTFv1x8XtPHClCgtVNFmfGWvZR4B5o8yd+gctA+MDhMkzsgFmw8t+Dvi9HyPjWsENIRD6mc36BFf78FZsX9OSZdKU1EPp0zfwWZAv4USbsmP3nkdyTIWArXxTh/umbDaKUh6G5Bh4Wlt8uXBsv93v0Dh5QayX7afZRCeBzS7kL2akqWpy5svrPRUUmjZqHEl28QHV7ADbbZBXpftW5rhdPr3zV5yPlHXIrQygZfb13L+nyVpu6pNnq4FYUwD4J27uh8LY8xqQBvNhP2YNGVRDJg5RK19CnSXdOTcBe5bBs4U9YiI609zPdV1c6YjqcupqpKxamERudS5lz6Chp6l0lshT/sHdd8MZljodzs2cmQGHO/UeiujLm8y/+Tq7RylfRscyL5UXCrHfPwpPXj+3koiBC+FpRc9ewbb1NnjrScoC9hxKNj5EvAy6VtB0BfmjenvSVfUA6qjDzrmMcaVOb1kld6+Yz+QzrZZKFIB61BFniMmUNZsLIjhUcyLd/QgjgbJ6FnbE6iG0KIoJet++OOuCQrbOxYF3paDcg9dcTIzDeGCGzQwwUgfYdXv4GzTrbsLWkRXD6e0M/zNJH8W7Ij3p3NwE1geeHkCmc5mseAGh+x7zAxZ4RzeuFq5Q6z4LzWqEbY80HylCvGY+oA73rOQsDr6+vXRc+jMHbw68aHlsNEyy5KFml6GNteauH5DGvrtLFm2inZmdB5gR7XfTXo2U78hl25X75inz1w9zR2OJ1Riiob7IJmDJfS+POYrwZqYfSnQ6/uhSkMgrR5Fxqus3DXTiTlEfm7ozWOwJFunbKx8WizXenG/N0vj5NSSvcVGruEy1Lt9T1RVjSL7O2zITIdjHQbapHEHRvN5LzfPzbR80sO6V/yJgA5FvFE8nqt+oIwGdpwdxhCPnLZiz1daH6O+MLMdxRwgSKbiDYp4rXPASQ==,iv:0LjGToC21VSE2CkMVxxYWasIcAwRnxWJQisSOqOGSWA=,tag:eKtsTVE8/MJaYNmlzRA98g==,type:str]
        key: ""
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBKODk2TUhtcGRBRThHVUUv
            ZFl3eDBKc1pDQmU5L2dMVUd2OHFueFlWQ0hBCmJlbTcwUGZvcjlTYkt6cFNuL2xR
            K3k0UW5QOHUrNVU4SkNmN2N1UGlIU2MKLS0tIHZNMDBSUFJpeGJrQ0wyeUthTlgw
            ZEMzaDRaWFFkWDF3dTJWZ1JoOCtTTDAKjZHJ+2yGZIUKmFq/FXV15vasb6mJNIQN
            PTsPY9silWtEvU9bFSzagPXGdJsWY6m1XcKR649GuApwp7LJYJ/0LA==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-08-20T04:17:51Z"
    mac: ENC[AES256_GCM,data:/k6nj8A9pbFEded1wsDZLlYcGy43mDqm/DyGC7t8HqR8S1uebecMQKfA6E6IIYkwQQGr6jythinxSIpBs4aaIlBUNXfunEUNP7vO6pnFwP6jJd2TVz5JRkfhpRxg7EeZMjacITR8vyacc/2r1JMhC4Y7AfituVNmKeDtGwJgQK0=,iv:UWb6r8NIL1X2tKd59qRF0BSOQ8htyRxPHWYJqrgg/6Y=,tag:NalgZ0uX3zXzhtXYnoeDZQ==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.8.1
