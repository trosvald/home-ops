version: v1alpha1
debug: false
persist: true
machine:
    type: worker
    token: ENC[AES256_GCM,data:R3HFZIPb4wAN7IS2OO574vXwU+8lMxU=,iv:sKefk8dVbJRttH7fKKPDfRwnDY5urG37JSeeFaw7V3Q=,tag:/KOFzxUX5RVMOtq62VNjaQ==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:IFa8BfCLxdt8JYk326rlRngM993wAI8ka3nsE22Idzbrb5Pyhx/qi/ee5120rhNqMa6gxOLlEJHQ1/BBEpVzetX69ihvkr2ieNuSzUkkWq7RVVvUleKBnMszG+5nHylTJe6KPUs20cVnSdrHNYDCXpxkBcM0ut0exIjvL2dAhzvtEXUAj0TMpGU4hC5eaxGvxSA7a29uAr2qSL3px6DLPBZ2Z35PF/7waGuPB9T3xeGP3FpxX/TjwiL/aHOOgX0JO2NdgtiEPw2/ng0CS3eKlGFWtYw9W3GSd8OKVm53tqFUK8Ot6ZWztaMIuw63xPEkIa8CPwLiNaAhyEaMugLkEXVYo+b2y3bszibhkkJkmSpcAJgcDqmQ3AWnibpcIYhpYWguvNFowzQV8cldc60Mp3IqXkH1tBiscgxo90f3FOiuEgJxSHVUd0OYeXY+3V9KgCerEje7qXa1WiaNZG9Avp3R61EAJwpMeqzLzN7EPNoPiXya0nGWoKGtVJyxNAC9gFJ0UogZfejnej4jaKEsR+D16szLHRRDby9/bMS243LrAT+y6p3ea7nhiAKKvTcUgULl8ZfqlmGblxLoVw0hqPPkgq2siohIUWi3O15WlUXk7W+nXtZEBVDHyw2axdlksMJXDjkIYQkNFFz8F1IjaiXen2POugWiRz5RyreqVGh+Ew6WUu9il4ccL4DlGNt0UvGAS+Qs2g87U/bfypmO0dA7LIP97nn3Z4hyTQU5vCkrnVHfucj+0irgvbtDPwThJt9QvQCFF1Yu2Ra6C5GpcmGcocFcTH7oD3bKfINXBsOvdb4231ooeu3MBO1pvyXq8PU/WZBack2swumM0u2RT1QFOaCOTUj5SNIW93S5R76QZ4ID,iv:tNfmF0RM8OdfnsbQfy5PsRgkp5u4SbsMQTHKke9nfkY=,tag:kBijTZ8YVMNJhxQkJgnSEQ==,type:str]
        key: ""
    certSANs:
        - 172.16.11.20
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.30.3
        extraArgs:
            rotate-server-certificates: "true"
        extraMounts:
            - destination: /var/openebs/local
              type: bind
              source: /var/openebs/local
              options:
                - bind
                - rshared
                - rw
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        hostname: p-tlx-k8s-w1.monosense.io
        interfaces:
            - interface: eth0
              ignore: true
            - interface: bond0
              bond:
                interfaces: []
                deviceSelectors:
                    - hardwareAddr: e4:1d:79:67:75:95
                    - hardwareAddr: e4:1d:79:67:75:96
                mode: active-backup
                miimon: 100
              mtu: 9000
              dhcp: true
        nameservers:
            - 172.16.11.9
            - 172.16.11.11
        extraHostEntries:
            - ip: 172.16.11.20
              aliases:
                - k8s.monosense.io
                - main.monosense.io
        disableSearchDomain: true
    install:
        disk: /dev/sda
        extraKernelArgs:
            - net.ifnames=0
            - mitigations=off
            - module_blacklist=e1000e
            - talos.logging.kernel=udp://vector.monosense.io:6001/
        image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.11.254
            - 172.16.11.9
            - 172.16.11.11
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "1048576"
        kernel.randomize_va_space: "0"
        net.core.netdev_max_backlog: "30000"
        net.core.rmem_max: "67108864"
        net.core.wmem_max: "67108864"
        net.ipv4.tcp_rmem: 4096 87380 33554432
        net.ipv4.tcp_tw_reuse: "1"
        net.ipv4.tcp_window_scaling: "1"
        net.ipv4.tcp_wmem: 4096 65536 33554432
    features:
        rbac: true
        stableHostname: true
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
            forwardKubeDNSToHost: false
            resolveMemberNames: true
    logging:
        destinations:
            - endpoint: udp://vector.monosense.io:6002
              format: json_lines
    nodeLabels:
        topology.kubernetes.io/region: main
        topology.kubernetes.io/zone: w
cluster:
    id: ENC[AES256_GCM,data:y4wrzUionl3I3bXv5RZvtT0wnTDn/Y8Se8cYE/guJTImAixoO6QwnyfWzaA=,iv:5o0bWstiUfei65okD8flah7lfDbc2lFyud9sTg3Khq8=,tag:eTDJhcW2TbGAwsy6nZ4oug==,type:str]
    secret: ENC[AES256_GCM,data:XV4Np3wneFoMZe6IZO4zBW0kJj7/X6lYVb3W7ROIfUKujqocUj6/UUNoWeU=,iv:6+nGQKgfDhLPN2M6Gi69bEnDDqQ3B42J1dNw7d/CSdo=,tag:iPtW6LKmei7bI14olkQTTg==,type:str]
    controlPlane:
        endpoint: https://k8s.monosense.io:6443
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.42.0.0/16
        serviceSubnets:
            - 10.43.0.0/16
    token: ENC[AES256_GCM,data:VPWD2+6zov8J2ECzxc8c2apST5VOBLo=,iv:w+4Tg5ZBcmm4fRa7dPG6JM9jbxuboLVSC2/KA+JvF2k=,tag:BnPRLWwbDGiLX+bwcYiaMw==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:AMrYut5blLBKSo1v/MT+DACIuadI/VCkPrCxAsQsoYEYEM4UmiLGuP0MZ3XAnA1Om1qc0o857Fy2vQDQeQuBPMdTdqof7G9L9neajQD8uFtnQIoEwqaaq0ii2VmWc2o2V1dKq1N6wXsq2T/Dp8TSCzp/geswwC5RjZ0nQIvslSKMLorLqp5g5nS8dzmLlxXyr3f9BVkS9brlFFz8/w9Rvptpo4ydv9emh/oE/6hI8WOZvHWELqFzl9bKCkAEITuFsFidGEtmCZHL4I1Z29+jDvhb1OhctGQNX8zHzAoqGlscWIXr02rgB9xW+eC3f+ej+4r9eqd/tEvRNlYexO2Z9uYNtrSYfj5bDHKXpCmcno1SemZaH0QvRKVeHiuAwvQT0NBZZiKESwwZCg6E1W7WeidMVv5gVYiVasINA6Ne6X672Lp/dgg/P+WraXM8Fq2IPLBl2R9GYdmDoQ6UarMRfHrd0MGnuPUhfPLECeyfA4Wt1eu0fSb/CdtSt4DjxejpbJYgdb8nY8atwNJolDf5o5v/kcifiJ+Ci15ps//OZY9g63ufymntAO9hjh3Cmi5TYuk7CN5ZSPOUIWKQOUecY4IE8gYXRVEmB4ZH1aLNKeoXA9BwEEdgeIJpJz2PXhaN2A/IIn7fZDblpFZEJZJQdtqjucpYZgOG8h6OVw12WXmUnudQdLd1KEdUP4yGk1c8Rwz/NfHucFeqOZiW3skn29e/RbkjrDcELx0iOjMDlQ+YUBWLKybwgw0tkAixTjWqimVRJdJExFyROzfMqbA5HgKjeojW8nw0Ey5hYv1EwcWDDrgLcygGqsDARpUHKj5JhozRnHnoW5J/YK5htNcnKq7gfdiFe7Cdo9UeKbd8ljkA3qkow79x+SDb8caXShCS2Td+HU04nhY6Uazfsvh/hR12fd/gqicC/bEzW4Vu3dq4t4eXOwOZkduGYotgYf/3iy4bCb1FpwsNaP86d/ObirAIEEZ4lOjocWNkDK05Zsw8qKgNj/f9c35cBo/cKp7xOpFt1Lf3EQ50RbRFMSGrcdpu6uWHd7kko4Bb+Q==,iv:oERgLsniA7sytSntq3buXOGnVO8zClevXfEfjZWEPYg=,tag:wxLXKiLjC88FmSKQB7nW0g==,type:str]
        key: ""
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBnOGpoUjhyczdKemdVUXRD
            ZmVTajBDdm1xc1ZvZFhOTHVkL1JhaTRwaEJRCmVTMEtZWUg3S2JZdXFPWHowajZZ
            ZS93S2duTGNKdzhtLzNvV09iZlNIV2sKLS0tIGZJR2JHVnB2WWlmM2plNXR2T0JY
            RW1tS1FNWnVndHlJSHVQQklhQnIrMlkKhTnzwkvcbfDdj32V+DPjLoOB9SwWrKFM
            vK8Xr9WeEFzglmJ02g4xrDLIWXB4/ZB38HTEDKSuuXZlO0iP5RL8Rw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-08-18T07:56:26Z"
    mac: ENC[AES256_GCM,data:ezbSeBAorZKOwaQJ04BlJlYOzaQoflJRcj+4EXawwXiWMjDy8u4g1sgNvpSa1Omyzkiy894pK8kB8mB4jpLcoS9Ckn8K8bW4D5F0IORpZiLUmp8LlWoQ0bneDn/Z0yJrlE65Pvw4/x0mJLBFmEXbzGmd7vb3PoL8+KDt5bwkZLw=,iv:pkJ5MAoE3yZ7TaYJDLcfKbyoiljuwa+JCYwX+ZirVvU=,tag:fSAXJrC0HRcNUl6cYaoDIw==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.8.1
