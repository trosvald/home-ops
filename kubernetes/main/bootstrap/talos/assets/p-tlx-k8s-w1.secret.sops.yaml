version: v1alpha1
debug: false
persist: true
machine:
  type: worker
  token: ENC[AES256_GCM,data:80nzNwUuqChXZ1jDMepIIlmBNcGR/hg=,iv:HP7EmPLQ/IaaeWtSo6k3E2gxxYjegNYYzJky809mSik=,tag:innljog/wbDH+9fmz99vdA==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:XfW8cQ/CeTeb41HU1LuBkk0QhQDLiggoGsvFLvktWXwFrwkBZMpfTU5EofgnSPBqeKWJvQl7IFn+Ax+/jNbUE2lPcxbdI17W1ptF/Ltcin4dftUT1Xd/f6W9ADgROvufACwACXuyS6jfd59em5auQCVwJQRhVEEOpoLUAwDZfsc3DzY3z+h4IgOVhKeRR/L9UiPgO6WDe5CzvSGagd0JO8S87JjXNZCZx0WHwTiPIZ7uJWzorSeWmiVpFPDFCK7cNx3vvsFOHPM/xwLcisvkcDjte4FT64aK7DxEy4ZfmiK4bYpvb8EZs2gsf/Z28lFvkxw0MXyFUTLPic9zPwQJ6ku4zbd1TlXXkHOeeoZNBS14adgVLlNQq8ssdGYWuNRy5NoPFAxwiW7GVFwJ/pLCXJTqk6PFKVCphWj5YfZuQSNjRHSNas9aRePapQaKrnYz2HCq1DPXbux1vg+ZMrf5tLQIE22r0IHtBcvsCOXFWZ3eBGzP3/GMG+s/YTBAW/Lk7LHhcCESfJtUElrlmT14aJvTsOUb/gO9apH9oP7Is+0o3n82WM7B8enU6ysAlmnXZUTIRjaYBHc7sdX1MMqU3/bLK1MGdaZoye0qcAs5c4fdbCIrWFJMI7rMaNydNBToBP3cRcZ/EPceq9cQ75DJ6sjKaY62XvihlLbA6TNU0gPAHCvE2BOowAlMgzEpjfxBfl09hD1GWUr9OQJnvSrV6G6Zi4oNjmm4EuTV0nQd6vqXE3dCD8TvKsKqFs3sBDouJ2P4262gBeI5zNNZ7/ZCAP7szP8WBVD3XwKnZ1KAFYEPUzKfJ8wmNV4BCJAMjLu3HljAVZm5ic3qgLxLe2cnCPtWHyjwzV2wJm0k4/fUDAW18doD,iv:3SXSdbCrnhLpfv7za2ol7FU9wfF77EvpebI2i8NvzWU=,tag:fI9Nt5jVa06A4CwG3Wlj+Q==,type:str]
    key: ""
  certSANs:
    - 172.16.11.10
    - 127.0.0.1
  kubelet:
    image: ghcr.io/siderolabs/kubelet:${KUBERNETES_VERSION}
    extraArgs:
      rotate-server-certificates: "true"
    defaultRuntimeSeccompProfileEnabled: true
    nodeIP:
      validSubnets:
        - 172.16.11.0/24
    disableManifestsDirectory: true
  network:
    hostname: p-tlx-k8s-w1.monosense.io
    interfaces:
      - interface: eno1
        ignore: true
      - interface: enp1s0
        mtu: 9000
        dhcp: false
      - interface: enp1s0d1
        mtu: 9000
        dhcp: false
      - interface: bond0
        addresses:
          - 172.16.11.15/24
        routes:
          - network: 0.0.0.0/0
            gateway: 172.16.11.254
        bond:
          interfaces:
            - enp1s0
            - enp1s0d1
          mode: active-backup
          miimon: 100
          updelay: 100
          downdelay: 100
        vlans:
          - addresses:
              - 172.16.13.15/24
            routes: []
            dhcp: false
            vlanId: 1613
            mtu: 1500
          - addresses:
              - 172.16.14.15/24
            routes: []
            dhcp: false
            vlanId: 1614
            mtu: 1500
          - addresses:
              - 172.16.15.15/24
            routes: []
            dhcp: false
            vlanId: 1615
            mtu: 9000
        mtu: 9000
        dhcp: false
    nameservers:
      - 172.16.11.9
      - 172.16.11.102
    extraHostEntries:
      - ip: 172.16.11.10
        aliases:
          - k8s.monosense.io
          - main.monosense.io
    disableSearchDomain: true
  install:
    disk: /dev/sda
    extraKernelArgs:
      - mitigations=off
      - module_blacklist=e1000e
      - talos.logging.kernel=udp://vector.monosense.io:6001/
    image: factory.talos.dev/installer/${TALOS_SCHEMATIC_ID}:${TALOS_VERSION}
    wipe: false
  files:
    - content: |-
        [plugins]
          [plugins."io.containerd.grpc.v1.cri"]
            enable_unprivileged_ports = true
            enable_unprivileged_icmp = true
          [plugins."io.containerd.grpc.v1.cri".containerd]
            discard_unpacked_layers = false
          [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
            discard_unpacked_layers = false
      permissions: 0
      path: /etc/cri/conf.d/20-customization.part
      op: create
    - content: |-
        [ NFSMount_Global_Options ]
        nfsvers=4.2
        hard=True
        noatime=True
        nodiratime=True
        rsize=131072
        wsize=131072
        nconnect=8
      permissions: 420
      path: /etc/nfsmount.conf
      op: overwrite
  time:
    disabled: false
    servers:
      - 172.16.11.254
      - 172.16.11.2
      - 172.16.11.9
  sysctls:
    fs.inotify.max_user_instances: "8192"
    fs.inotify.max_user_watches: "1048576"
    kernel.randomize_va_space: "0"
    net.core.netdev_max_backlog: "30000"
    net.core.rmem_max: "67108864"
    net.core.wmem_max: "67108864"
    net.ipv4.tcp_rmem: 4096 87380 33554432
    net.ipv4.tcp_tw_reuse: "1"
    net.ipv4.tcp_window_scaling: "1"
    net.ipv4.tcp_wmem: 4096 65536 33554432
  features:
    rbac: true
    stableHostname: true
    apidCheckExtKeyUsage: true
    diskQuotaSupport: true
    kubePrism:
      enabled: true
      port: 7445
    hostDNS:
      enabled: true
      forwardKubeDNSToHost: false
      resolveMemberNames: true
  logging:
    destinations:
      - endpoint: udp://vector.monosense.io:6002
        format: json_lines
  nodeLabels:
    factory.talos.dev/schematic-prefix: 03f8321e7acabf80dddbde44cb693f3c
    factory.talos.dev/schematic-suffix: d7b4d4a571bab9ae5cb74be79872a6e9
    topology.kubernetes.io/region: main
    topology.kubernetes.io/zone: w
cluster:
  id: ENC[AES256_GCM,data:R7bwKe1DhwtJce5j9wIP4RF5b9IqkTJHXAlv7DJE4rilEk+iDplIKBiZhZk=,iv:+9m0BUgZ/KR7S4Aa9y3Gv17aK7hyoxHlxUZ+V9V8Jzc=,tag:sxgvJHT0TpdGB4dnIe9Mpg==,type:str]
  secret: ENC[AES256_GCM,data:u5O925XNbzuTuEyQZ/H/cEeGu0HT2EeRvRz3baCwgh3YkdGOa0Gw3YraIKw=,iv:3p1XXsWMglADU1uQ1Yj1vYKZgVP6ZhYHdMIb24uB2uM=,tag:nq9kMvZqplOStQFfkKSETA==,type:str]
  controlPlane:
    endpoint: https://k8s.monosense.io:6443
  network:
    cni:
      name: none
    dnsDomain: cluster.local
    podSubnets:
      - 10.42.0.0/16
    serviceSubnets:
      - 10.43.0.0/16
  token: ENC[AES256_GCM,data:aqYUtjsiB7qgaihQn1CoAlroMcGByJ4=,iv:Terrhu/kgCV3BbxSCsfhTh00BRJMtarKao4pcH5ZCks=,tag:MFqj1fQ0RijhLKz2lpvufA==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:Hc0F49MCF5Shkc7Tqd1lArMLRykjib8nnIFZd6Tm8mE0OSdaS01kX6FN5HrZC1vdWW0Dl7WqM/Kz+eSOS6eKYxMnebHJGmghZVr3wNjEEqJ2XZ0f6dP+2pl7kYeM4xk8G9ikuxiRA/Vncw5PHBk2zxp2yl/FGX4e7ofVMihUmPRP3exdYCB96/4kdlJEL0+9RhNcwhVPvG/LtCHGeoybOi5de8MNz9Gyr5LVOkeG8uZUiw4wpsUoJ8oA0leW8Ls/9GzvRQfcaNqIhH1ynKe+mvAu1M22GdRY4JKuCH7ogitQEDWNe317bV1qYkPuxf4nM3W41G5OWbMWgiZ3Pc9LBDr3TdcnrH4huLkK7YbccJ2vZEy4/JuHQP4in4T38BWVt2CUyjqozC2ZwGwnpvnQDyhrlu0a988/IpK8z7gzS1HC5X+UB4Vw/u05aQD+cXNBWDU24XH6RAGeC9IYThRSLsLpK2KAsiZNBkgrnFFqwK4d/gveo+hBXw9T/J2iTkAqWcDwVZU4Dytuiex3cgpXiyXAjWtZKVBC3xu7xMrNsGzui3s7Xp9LIfGT0p5VrHK7uBrIYxoCyjLb1gwJVf7WMwd1QVZkB603F4GeKpmtgL0NB6wTTA9jEQqC+cfc6jBU01qRamMj0ksqLOmaRg1Jd+KOIRYfXt233GhkIl/XrRYyCzNUK6Gtaa888OOzNLcWq/f/gFrwcod1qtermRwQQku/mvQnzWhJED/86fWdZqIV/tDAvKliOlT223pthDUHFlgDMfIahDjtn8DJn4o62yy3tpzjV/zO70ZF8F3pG4ZMSiYAk2mN6dZKGrg5nQPqfdA+XrXJgfsDNA2llPQQpvueABWTypyGLPyxb4aBQ87QKaESiYw+Xz/DVmPdaeKZdqB3h1OCYmhM39gR6QlbNu4S7n179cO8Y5tp3gp763z7r3iyUvrChl+aAX6m1rskYY2BCykIyILMb+of0Z5AFiVPHCq1hOcr0Qoxx0My0UkWXeDAfMHga1WZKc+Oqme3jUQPaG/bY9osBxk0gDOOIpp+yf1Hwpjv+RO7KQ==,iv:HSN/c8TPgR+JPDJVMzZrJSf+jxUQTAtsnWuKxRWImac=,tag:X0QFuImXEzWvCSu7MIzMAA==,type:str]
    key: ""
  discovery:
    enabled: true
    registries:
      kubernetes:
        disabled: false
      service:
        disabled: false
sops:
  kms: []
  gcp_kms: []
  azure_kv: []
  hc_vault: []
  age:
    - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
      enc: |
        -----BEGIN AGE ENCRYPTED FILE-----
        YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBQODh2Tzd3dUZrWXZTRS9Y
        TDN4STdtZEU4OGZobDdsVjJDb1lyOFA4Y0ZFCmtNSTU5Zk1hY281M1EwL1ZlVFZQ
        YThCRytlaXg1S29UZUtaWHR1NWFrdkkKLS0tIGIyOUZwUE95NTN5eGswaWJxMmdw
        RkM2RDFjZEEyczdEN2pXd09GUFBnOUUKXnHRBv8OhoN5P9oaw6OS8UY+H/AdLbG7
        tnxI/CF9OqbhjY9WUq6y7R2+c0t2d3E1NZao3aJZdAYQXluBRs2uXQ==
        -----END AGE ENCRYPTED FILE-----
  lastmodified: "2024-09-17T01:37:14Z"
  mac: ENC[AES256_GCM,data:frCLSDeNilwWkwKrla1lNb6U5ss2FQzX7Evu9krx9PGt+x5Gq12rQwKDSNTkGV8zQjRR2awh+pkbBzdG1LepHngzuiBr4hHoJ8g7YnebUo+zsIjqBkCn+KgXZmr4f8DCSNc9HaL+scdj8Q8w3p7AVny4LsIYibAqSDWa3Lebqf4=,iv:o1N2btf451t+Yr+sQA5zpLcGCPibeHprkJbSQOmiFmI=,tag:fesF+yVGZe/J6KM7SAekvg==,type:str]
  pgp: []
  encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
  version: 3.9.0
