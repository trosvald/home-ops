version: v1alpha1
debug: false
persist: true
machine:
  type: worker
  token: ENC[AES256_GCM,data:I+eBVoVlvgcjmV2urPzD7825XaLCODU=,iv:c9g+INyXpzUXm9tBg3Q9eQSpmK1JqrK7hb06spqwKf8=,tag:f/eukqwXSQ8QKtA9/rzIJg==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:Y5rx9gmhhZe055/Cy9/dw3h1GUmxlcRObgWtUSTqf8uDYkFFk3IW65ai+/7FOZfMfdamvoaF0pRrx2BjJMUwcXLCBbJLFEokzJWThJ2UgFDWODc95t11D+2vtF9b5FWO/J5p2OxO67syC8DCEBqda+M7fQCrD4TxRHZdad5CVEEQmZhKlfH9uCZMFhtTRIU4rEBtPLZLsB12haWkDZmyy+9OoNFNL1Gzp4Ie67OrhKJuQYF+7rY2wSUA72MlIhf2YKSfvXjm2XdFi4qXdeJxQfFrHGt83b6H679uE+n1YDtzmoNuYb7/BeosExcQP2aCAM0Kl999yHALzp1BWEY7LT5Fb4WOgEiuXfY9rR+C0E1iD5RF7vX7oiPvou9LElWhRP/T3bFPubpJTdQabzdGbn5kylqVzOXf1q9u5cYTFh/6NQ3eWBTX+bsC/Nt+HPDDtllLBvvVWLoavIjZI5vRQR+g1xp3CwCO0qZysDE9idNcyas3oSu5Odh0FZd/3DyMcjX/TKq5Acd1qdsZZr+2D4b2TrWU4Nonky/9W/6aihC+EjiGJj1YA6yfoNbfm/rb/dYzjVLUwrQKV/ir6xOTQ3mobdPBSc7RxZe4V7qHGO0RJY7RXlzXkWO0gjoSuYx1xtL+mkZPCQRBuYHBTY4fzniACMJfYb2OduBws3EqLk01Q7HPg6RP2RtITFhmJmkO4i7CfZTcodSz/TdcrsvRnhRKcOmvhUF2q1PdJtOE9wz246OYr/VdFY4g5SUKGhsgtSuotrhyNcF1qhfzsI6iPlOM97O36atMwK8mxM/WjUEQ3dRPLO8i3gz8+xCrHpp1vzWoGdIZ9F7sWf7UBoDDP7vD/foy+bt4bSLHJGZx2AUUUgPI,iv:KT95CoYMpubm5bAP6f/Q6E7xUsw6K8QWq8bPiJD1YBE=,tag:JAHXJ+uM5vQcS4VCEWlUqw==,type:str]
    key: ""
  certSANs:
    - 172.16.11.20
    - 127.0.0.1
  kubelet:
    image: ghcr.io/siderolabs/kubelet:v1.30.3
    extraArgs:
      rotate-server-certificates: "true"
    extraMounts:
      - destination: /var/openebs/local
        type: bind
        source: /var/openebs/local
        options:
          - bind
          - rshared
          - rw
    defaultRuntimeSeccompProfileEnabled: true
    nodeIP:
      validSubnets:
        - 172.16.11.0/24
    disableManifestsDirectory: true
  network:
    hostname: p-tlx-k8s-w1.monosense.io
    interfaces:
      - interface: eth0
        ignore: true
      - interface: bond0
        bond:
          interfaces: []
          deviceSelectors:
            - hardwareAddr: e4:1d:79:67:75:95
            - hardwareAddr: e4:1d:79:67:75:96
          mode: active-backup
          miimon: 100
        mtu: 9000
        dhcp: true
    nameservers:
      - 172.16.11.9
      - 172.16.11.11
    extraHostEntries:
      - ip: 172.16.11.20
        aliases:
          - k8s.monosense.io
          - main.monosense.io
    disableSearchDomain: true
  install:
    disk: /dev/sda
    extraKernelArgs:
      - net.ifnames=0
      - mitigations=off
      - module_blacklist=e1000e
      - talos.logging.kernel=udp://vector.monosense.io:6001/
    image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
    wipe: false
  files:
    - content: |-
        [plugins]
          [plugins."io.containerd.grpc.v1.cri"]
            enable_unprivileged_ports = true
            enable_unprivileged_icmp = true
          [plugins."io.containerd.grpc.v1.cri".containerd]
            discard_unpacked_layers = false
          [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
            discard_unpacked_layers = false
      permissions: 0
      path: /etc/cri/conf.d/20-customization.part
      op: create
    - content: |-
        [ NFSMount_Global_Options ]
        nfsvers=4.2
        hard=True
        noatime=True
        nodiratime=True
        rsize=131072
        wsize=131072
        nconnect=8
      permissions: 420
      path: /etc/nfsmount.conf
      op: overwrite
  time:
    disabled: false
    servers:
      - 172.16.11.254
      - 172.16.11.9
      - 172.16.11.11
  sysctls:
    fs.inotify.max_user_instances: "8192"
    fs.inotify.max_user_watches: "1048576"
    kernel.randomize_va_space: "0"
    net.core.netdev_max_backlog: "30000"
    net.core.rmem_max: "67108864"
    net.core.wmem_max: "67108864"
    net.ipv4.tcp_rmem: 4096 87380 33554432
    net.ipv4.tcp_tw_reuse: "1"
    net.ipv4.tcp_window_scaling: "1"
    net.ipv4.tcp_wmem: 4096 65536 33554432
  features:
    rbac: true
    stableHostname: true
    apidCheckExtKeyUsage: true
    diskQuotaSupport: true
    kubePrism:
      enabled: true
      port: 7445
    hostDNS:
      enabled: true
      forwardKubeDNSToHost: false
      resolveMemberNames: true
  logging:
    destinations:
      - endpoint: udp://vector.monosense.io:6002
        format: json_lines
  nodeLabels:
    topology.kubernetes.io/region: main
    topology.kubernetes.io/zone: w
cluster:
  id: ENC[AES256_GCM,data:uuhLOsAHCQC8IJEdRtM0rAviUOgC9iiaNREBq4MoaPtDkJ7tLipwvhCTL+0=,iv:yC4oMfsAdE09FqLmm1dPeu//6KlUoG86sz6pgejcpU8=,tag:ACoG3LzzSkv/bjDBOPwWlg==,type:str]
  secret: ENC[AES256_GCM,data:uHZyqrz2nKlsFmeDEO7py6f7bvOQ78bc76PX3siw/rVOoLoJCEDGh3zL1oA=,iv:S+1HVQf5pMDyPZojTlJ4qGQNG5huWlqojbcuz74B8RM=,tag:p0vFGtv1GCH5bWVPbzzuGA==,type:str]
  controlPlane:
    endpoint: https://k8s.monosense.io:6443
  network:
    cni:
      name: none
    dnsDomain: cluster.local
    podSubnets:
      - 10.42.0.0/16
    serviceSubnets:
      - 10.43.0.0/16
  token: ENC[AES256_GCM,data:FCQDUfVMWtTf2IWmx7b+S3pcTC5bbWw=,iv:0P97M1XYO0K3SZikys27VyCtD7uJfF7U8j1IrFvB5PA=,tag:b5R52WaawtgYbygdFg5yQA==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:LLbOrKU2DVYb7bV1AxUKjqcRSSvTqo1q5nokn6mTj95wqFkE25jeEn1cBHYngJ+dILwJnvZ9mStRRmv8nM2tPmegAOYEBXMRwJ2+aj5gNAKONcl9CStymnZ83Efz4R5eymOzK9GAOPM7n/YpVZg2S97O9gXrbSyBLDAJlD936T0q6DUR55vumQcyxG3TX/rXHrRby0GeqUNTMPKRGqLsk1OPChzanwf8JhLbITQVI2umRRqyiDJS8Z8Fyd2GodMb9vM+fSZKi85Ol7DqO2LFEMU0yrVJR5VnpFb4kXzIVv8PNY8auTd4y6y+V2SzZC0XvU87sEiqluHMW2zoHBILJ15F+5Dg9adS5Jv+P5ozFS88O4B9Tkw66GkxeKdcYtifPAasUhGn3TusA2QTQS3siX7HzAAcVr9RMbqLxIlKJZwOLk06uyN1/HIEpiQMMur0hh5V03wyKsrPkt/SGmnYZ5BGX1/25ingq9fdxkYMFvxsCB0VSu6WMXznsOwr176QNwKOQ/woWZunmGM22pDHWJtpC5mvbQufr1BEYfq0J8aR+XK3xloW5cer8cirSZ24I6JSLGOe3nmljyj0M8Kuqr0k+YQ/vqa6sxrANXoPXZastWms2iA+pzDh8P5OuEmfASz9NFfUQ1MPcf56jBiqMxhqG+/yEsmoRaahoEprB8fFdG4ngpF4rDE1DxBHNCecxup9Q6jyRRo5TfDO0hdb7+JydNdVOal/avvuCvpsbrG1OKFn6wXXFeuckdF1rxUYEqomsRsaK9BSbRX4pugVYffVq9EIUjdnyTp5d6+FADjr6PQ35a2paDCc2xsn2enePX463im1dAoVXJuQQ7asobgmpDX+rMzfA8Uaky/7NsyEfZFsX2VyoJ8QDFvEor46fRZ0RzqRfKYvYuBpqVYUVBoc9w40Acd0SOhPrO2KOZVT1Yp2J2niULVCKqOm0udKQYkx75FKHXh+NfUwJIEL2hHajzx0iy5BX5xdibAmtNGG1Ly20Zq1OtFa9TPk49YSpJx8DmaYl3tSu89MzHLzcMyIE6B1dx5P4HeF0A==,iv:2/7ccdTRCTfE04xD6luvLFnrDmCJ5a8m24vugrCqCcU=,tag:4W0O6Ak9f7JlDScKiiWYlA==,type:str]
    key: ""
  discovery:
    enabled: true
    registries:
      kubernetes:
        disabled: false
      service:
        disabled: false
sops:
  kms: []
  gcp_kms: []
  azure_kv: []
  hc_vault: []
  age:
    - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
      enc: |
        -----BEGIN AGE ENCRYPTED FILE-----
        YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBvT003a2RsOTMxUXpZRjF6
        Qy9kZ0s4M1NDMlQwamJxelhYWUVNYjBFNVJFClh6bUo2VC9uLzBScWJLcGo4RGNV
        ZUQvVXpTZCtnbDZzN0l3aURSMkRoRmcKLS0tIHBIdkR0OW9FNUtBQTFYRkNjNFRo
        V2EwV3ZmTDhjNDdqczgxRjd3cHBNK1EKPt46PF1L6/UeU0fSmAN7YKjoj2GqfKNE
        ypJL7id5xMO9ecapQfqWFf0/7T7zmD7XT1Lw3H8Xjm39VmsnATzVFA==
        -----END AGE ENCRYPTED FILE-----
  lastmodified: "2024-08-19T12:36:17Z"
  mac: ENC[AES256_GCM,data:6F4hYflWpPLmiqlIC7qleA/rP2/MVmbo9wAAWsI6MqcX4xv3LJetfbZkjx8IVB4y+h9/aXZPDSsWCrUsM3/Sic5M0bcnCHKY/DSzCTcuIOB+0WlAsq0nA9MOPJoCBCH8djCWi6WEvZWCsugV0JeMDHgxwEYjovlVw7n6orN/GdY=,iv:LHaW03qXUTiTs5531ioqmgi6vdM+dOBunxFJMT2RBVA=,tag:GTW0fTw0G1YqjC9gjdLVqg==,type:str]
  pgp: []
  encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
  version: 3.9.0
