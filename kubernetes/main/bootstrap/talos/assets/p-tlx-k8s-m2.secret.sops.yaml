version: v1alpha1
debug: false
persist: true
machine:
    type: controlplane
    token: ENC[AES256_GCM,data:LynfGzRxKIpvbT44EsuffDd0rwr5ZCg=,iv:7vB/ACp6jDjqyff2YATuaVMq1ctTTED1Nsz9S7G3lZw=,tag:uE6k2zQjhkklbvlp4B6c6Q==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:/MxLVyDDKv4BRPdO8b7CLBjT7ov4iwrBAdLVOG9oz2cvTOit2KymxrbwyWi734xaAqEJqpg+Iap/LuEIMY6VoFq7i9fhmN06Fy653s8HA1i/L3XHjHvCrAX+d7h02eJbR/IADwd/9C4VIdNRYtxMUbp1oJWkQL6TBHKw8R4AXc4IQvmr54O0TnNTrKYHof035KKjm4Y17NOLxZZKTzWufZtCJTx2gXglDBBYtRaXDTnoUr1S6Kmkyueg5uH1/XqRK8uG6PkQ4Hh86mpxTsnKyBocOuGq/z1k5KpDQPx0lPjuoZf9QA+U8qawT/SURYrpmuLJd5Xux4+PIVjUEckY7c8dSsmRQFjVa3pJnxUuKhKltxZIPNBbyEG3UpKgsNf2I83pxgQ6D3Ggsdsdl98Buf47ThRND2N/irCkgxhftEgGyEAmrCy767IM6Lk5UqgdCFl+iUMmRzQdItqjHf0gBBrovop8+kF2e7bbP7f58iwBkRN+PeObPBop9L1w2NY3UQWkeuouhLcLMHusHRfNNiSJiAgta0lGn0K+qPk3cFVvCoA3ulJ94uyKZh0QGwIGZpTosTEmtpeN3cZqioDfsEvKzD7n6es94o/EhhAxfWFycqWuZXMuLEDqO+TmzUSd7uuAGlu0efaCcgOUwmQm+gQ6UCMmUKZtAfGPe+KPSmfr5+NWXiluFWuW4+NUYLoj8IXMXFJ7nd3ps+C8XBCiqq/o2QtUwVsvxJ9/N1y6eafeA12ao2OU9x88qI/boV98nMAH+XTBBmBGEYA1Swj6M0dmhzJz8d42csKWk+L2DOsn3UYnAXjegDMzmA9/864AZTd8GezTiHluvFlTKbp2APrwJ8v4SX0zLItKRrwg5E09zzpx,iv:eOz3nkutkvUrzIHbtJJaiWPd6mi+YRN/W/I+XAWqGQI=,tag:ZlfJMKoD6jfT5wdr0CgMtw==,type:str]
        key: ENC[AES256_GCM,data:NsFfjThZ31Al7yqhBfYz+wHZ3jU4HmzsCux3ljDttUaPvU7MVJWd/T2/L13Z4dpV7DpJoCzifzxz36mdOFVC3kPQm6O2VB3rK3KQc1KC7DzUIK3N75IjD42bV1Z8/IPyFmghGAYBTjQC69pBC2pqj56Lmzk1Y9nMM0/Oxwil/1vzHx2jhs7Dh9p4mPhibipOdlq3au9Nl393dghqWfosJLTNDWpIlqT0Gzn0n2/QW/yBYFJJ,iv:Na0GRl1Oe8ODD6pOkuu/YbemjqMaGTlzNqQEUR8vlNk=,tag:Mvdjj+5DEO4tyYJ5+46Qhw==,type:str]
    certSANs:
        - 172.16.11.20
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.30.3
        extraArgs:
            rotate-server-certificates: "true"
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        hostname: p-tlx-k8s-m2.monosense.io
        interfaces:
            - interface: eth0
              ignore: true
            - interface: eth2
              ignore: true
            - interface: eth1
              addresses:
                - 172.16.11.5/24
              routes:
                - network: 0.0.0.0/0
                  gateway: 172.16.11.254
              vlans:
                - routes: []
                  dhcp: false
                  vlanId: 1613
                  mtu: 1500
                - routes: []
                  dhcp: false
                  vlanId: 1614
                  mtu: 1500
              mtu: 9000
              dhcp: false
              vip:
                ip: 172.16.11.20
        nameservers:
            - 172.16.11.9
            - 172.16.11.11
        extraHostEntries:
            - ip: 172.16.11.20
              aliases:
                - k8s.monosense.io
                - main.monosense.io
        disableSearchDomain: true
    install:
        disk: /dev/sda
        extraKernelArgs:
            - net.ifnames=0
            - mitigations=off
            - module_blacklist=e1000e
            - talos.logging.kernel=udp://vector.monosense.io:6001/
        image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.11.254
            - 172.16.11.9
            - 172.16.11.11
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "1048576"
        kernel.randomize_va_space: "0"
        net.core.netdev_max_backlog: "30000"
        net.core.rmem_max: "67108864"
        net.core.wmem_max: "67108864"
        net.ipv4.tcp_rmem: 4096 87380 33554432
        net.ipv4.tcp_tw_reuse: "1"
        net.ipv4.tcp_window_scaling: "1"
        net.ipv4.tcp_wmem: 4096 65536 33554432
    features:
        rbac: true
        stableHostname: true
        kubernetesTalosAPIAccess:
            enabled: true
            allowedRoles:
                - os:admin
            allowedKubernetesNamespaces:
                - system-upgrade
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
            forwardKubeDNSToHost: false
            resolveMemberNames: true
    logging:
        destinations:
            - endpoint: udp://vector.monosense.io:6002
              format: json_lines
    nodeLabels:
        topology.kubernetes.io/region: main
        topology.kubernetes.io/zone: m
cluster:
    id: ENC[AES256_GCM,data:md/iPTOGbG7/kMrlU4LNKEpPiOh8/RBzNorh7sXOYqQAM3FUAA6/jp4uvqM=,iv:npVFuu9LOJXenJB5exeD9UgzUfTUZ2ORmfkk6PQOYDQ=,tag:RENonQHxd/LXYtTlxntOng==,type:str]
    secret: ENC[AES256_GCM,data:ublo0xhkl2GXJ30/K8/oRV4zfTmgy1IZRZBL61QSO/Z8B+uan3+N0A/fhL4=,iv:awKU4i0LJ5OGKDWSVEiJwxMRqhYOpmXjASgWpMrlwtw=,tag:BvmBzlDuXkwwxMjNA+e2tw==,type:str]
    controlPlane:
        endpoint: https://k8s.monosense.io:6443
    clusterName: main
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.42.0.0/16
        serviceSubnets:
            - 10.43.0.0/16
    token: ENC[AES256_GCM,data:N4BfBSf6jkQ/iyl5tkf82br1KevMeL0=,iv:CK6VC503kWICyp0ow/4CT0IzKgs5RydAPzZqwpl8Oz0=,tag:UHpT7K3qBFgzL1YoLG/6HQ==,type:str]
    secretboxEncryptionSecret: ENC[AES256_GCM,data:JByHa7uobeBGJ9EdK8KgPD7Kj3ttftuQJDmvZhf6S6wazD6zwfeya5+FlTs=,iv:XEBvY1s4UOEi49+9us2OYWStqqgbIXOtUUky3NcjwM4=,tag:HXayIn0D9S3C/DnvG03xaQ==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:eIZ4JJNPcKh1UEC7eYkzS/Ecx//+hu/qzBlIZcwWF9lh3o7Cf34AdEtS/N+kJlnuawXCDxqd0IE9Pmt0fNmEhjc8P9ar7dox2e3q9usgs/pQLWvLyYVC133yRLALdG0L7ANUGkXvE+Hp9wHbtQ4qjJrZ2FQ2+1DXuZ1eNWm2IIvmTxP2GN/MQ66IPCN1lZP9U3O2m+6Vdhu2GCC6SuthyTfVPbXbo8ffT7DrkAGNWREhsChqIdeV3S+c7nupfsM3wtl+Q8ZdwBXCeL5xaV8Xz2siRHrMPMdZXdhAhLW+pT2PcROpljcgPo/FM+79wmkeGJvFC3gXx709CvWARJmiPjlWyvX5Sy23PbqHJ3V/vCA3hNoFWeLWIbGzyDWlt5N69PzqJ7NoSiYqi+Fh7/JXg4uH8cfU63vg0rTl25dtyyxfTRTEK08JBvCLXKh9OcqAXe2AI7FckmxiMQ45QrcorxMqctUSuThb79V0VmnfMJFCKkr+yhnSfrueBA140xeFXwPbS4NEALM02IH1L+yE3b8FM667WWcMFxS0GtTIaWKvsn6NOJjjUmiTLklJReso+XfztQS58bdsmz1eswfDsTmKo8Azu2d5D8S7iND+vkNUBENsc7iW0XF47XUUoowW5YujzS+n6lxonTSWKMgyMxtoFhyFdvcTwQq9sSOMUXUqISUi8nPgYhfItRo0uy7zzGgzp57MydV6XXaHeUoKg4fDaEbPF82U0FxurCXnLMK5B6PvHWEwIK0ls6a2ruAn0TQXPEk0xb7id5urn8zeSZDPUmfFv+Im+fEQmrd/YU16QzJjLnfgmXGB9rOWbLu7zKbitUbi8zuZrPQqQLIBAGKa5Oan9ti48amDNNfDVl06EnG57Hx1DKh9WSRcmAKBlyfjGbH95Ly+YwqxAonWhU7W3rkS5ujNT320Bg0HZDfEsISocGvexg/VgFDSplI+S9M2cBt0Y271Ky6P2b83UnogkADtsLdSFYAaecKfB9EG7bZO7vzmOaE6+uGtJn3B/9mRrBRJL0PwbRXk9cCESBWlT3X6hwAkYDgJmA==,iv:aP616NGNGfv/tI3jXUqeigYcjlnKzge3j1ObhP2tyzQ=,tag:F5EuaGl/O9Qm+FJLCFJ1EQ==,type:str]
        key: ENC[AES256_GCM,data:B6SbKQK3pvh81wyPF2jVgC8vOwpjOUFZDSYNDdM4CZO9croMPGYv6kqE8IIukJMz8YhQuMrhwEeRWdZmG4zQuAm0XDiIxQaqTMDejfEvv1Et07z1y4RIDCEBajgpIv8ar6OWbjEENA4VG/dpKTSHdyXnoMPGTvc894ORfQW1PsDyxnmUNx/dKvEc771EztBFZs33wQQH7qZuuI9sowhe/dkIrcJGcw39fhY8AjMop9lwB5KVR9eO3UUpgy+wEP34fvc7ClvXK7DUNDIQk8ktj1dM5khVOXCOoGa63dXcnoRbw/HflgRI5Dsyo8vODUckAXFRruPSmsoCm/uyfx2CI/3pxnaUYgsdBkfKdOJyvq7FPPWYd4gz8ZygUnKSuQ9TtOsThC2vk9NLELZTPTiZnw==,iv:B/jwlHONu8yPxNxpax/UZn1FGMYP0ccJtpsfusb/AfY=,tag:jM010etrRcHoJ68fLTwk3g==,type:str]
    aggregatorCA:
        crt: ENC[AES256_GCM,data:nKd35R1pLqDylqS/KIwhuX8i032snGW7bf8U5q4gRnSgpDLnX/FzCDr9RLByYyhIBAFIui//7sWK/RyzaUq182AI4kpIJk7S/SqfZ0kSS1nH/dBbhOjxbkT1nKPctazUkii89lHekkTd3MUGAwnTvRT632cQ72ZD7Y0pXdor4b/Rla3ZXsd4fK4EjREClydYlkvtBUEpF8qXIEd2sJYmGHCkl7JAzhU/TBQ449VoDHTehc3XT3PCMNi4JHX/wj1I2IhhGoTL8Muk7YNBmwkCNcJzorSTuxBxxewC0exU86nRoyJpsTy54assDIEMch6X0Xm5Pw4q5hK+V00JMeOlAwMNvV0Ybai2R34id53F5Owmi5gWsBd7WrD5ZFlIyaAmEyW1OzMSzyALbdmqMeyi+kAdSu0uxS+iILbHmTTntsiLV8WLyrOeuNbmfwPaMAUD30f7ohGXEZ/N3Y5JK3qH7dtdNYQytvV0XT3uLM6fYTajoMvhyWDwi5xlntLoU5LitCBmdex9NfuKU2UMN458LAYh78GJ0JMNQIPDSgoSEOwB4ScCUCA1aEmnJk3u7Ft0nRG6i42yTAw/EbPMid04XEfU3mMjQcXSGnEJqW8K6z5hClDgkpAJVLrrbf1bbLEnUSvm7BxU9QeAwZjjWE9b5j63LPCkBV3w42XQyRpKQ+AyD5jyexxGpeS/2zMkawdjLAR5srCNPY8pWyc2Hjlw5gPAUuK5Q7fylOiqhUGlVwUyvgo9ASi6g9HLXsfQS4X4Tmqva3QldYhqtp4GHSbEDXo5jB8SYDTJtkWkc1sOZAH883RAjRISlgKGc5nQsOBe/54s5BUPRVDJw7j8c2Dk30hlOb4eWIBJDuPITDW19hUwCDDaL2+Bv5PryY0qhEpdF1MwdxUcz89zA8M2cRrkGnxgIoIXkctuJ1MYCkaqEGiFWQ8Wm0/CUPy8O7ZZvl9U,iv:BX9oggQ9bmSRGp+KBjPWfh+TpP4s3r4da988nZreEYc=,tag:bym3qgk8DzEtjLc7SNQO6g==,type:str]
        key: ENC[AES256_GCM,data:Pne83oUSl3SCQvJTpzmNJwEo83BEIms7BSrs0YbGcdL7DsmjQc4q+X32ssaA3o4HOXem8NpghGprhSjyPidLYiiTwKLhQNMAiIJ4rkdB/EuJ2w9LaHnmQP+L5u6K7esK42Rcx5G0xljl7DZg8PWhfiDJi9pkPWJ1XMz3374EzU7HQw6jergOJsGiwasHo4zQUSo2KBBmAab/0V9y6o+y53cXXDk6NtG4wen3KfA6/Sx/zPY7sHemUZYm9rrKFOymOCrTU7pp9ksf+5SdpK4RXVDBRUokztl/2k5zgYKQr21wt6ki26Cdd6YZTqgncQ1IrY3Xp5PuVxhmjTfjcmqRw625fIOKP/fyGha3wzLPGXuEzpfqQyqSlidzu5Bc64pfd2cxstFJvt+6TFY3Zs+biA==,iv:c57IVsmLWLxSLA47Dt9qA5rzFUTk1JyqEUvVQp1Jitc=,tag:wI2+UEr6dkU/AoK4nqDsrg==,type:str]
    serviceAccount:
        key: ENC[AES256_GCM,data:6iy1JwT65iZ1UEfQsqqoInAyEMBYh+Da4yr6tH6WlEKkh5WYwjO3m8lu0IXrkpERufHznNRBX4QZK1Tc0OCDN+CvDRj3zdEHL1kQ7SX79Ol58oYHzJCZ5E4Vs0c6/pqtES3N8jC22gAe7332ozPx1uYZmiZK4AELyYaEu4V3TgWDe0X+AajrExz/D4TUqhMo5QzcEi/n+seS9R6QJsJhesSDhs2rzIO824Mi1VqE2Tcc+E3x23pCNLMt4XSdW4oPUsUGZ13wT9mxZc7tH7F96JDobvgWmHd8zidWFabotG5/EMnnt8q7IUr6YycNKJXC9c+B8iotIWOZZNOGY5Xq90Z5/4ZaFOyVjmnXiiiVl+tqSeoHKIjebpDOFw0+HhHFtumXcOuaxNnGiqMxbXkK4g==,iv:vshK1lQo07E9kjmTzowoiNRdVgwEztrCYHgeYJ1PKCs=,tag:NF4C0qFR2xjMZDUIxSNf9g==,type:str]
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.30.3
        certSANs:
            - k8s.monosense.io
            - 172.16.11.20
            - 127.0.0.1
        disablePodSecurityPolicy: true
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    proxy:
        disabled: true
        image: registry.k8s.io/kube-proxy:v1.30.3
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:/2V5Osp79lT15NIHiJ0f2XYp2QBprhu0srmbY1MKLYdEg45twEGAv4pwdnDNUuGDc7d6o1QDnABwLFUbtNAGG5I5XN4GD4zuZNbCs8bNcdYmDNCQtCafKgS0VzkaGyJ/NMQiNTy5PYTT9bWAvglJe17Vw7mFCJv3/GCYr6haytdF9GQyvP0gJCJ8lZK/LdN8EcypGiMCcf8EtbDak+LgjZRXroLtXUBtK0zi7TnWv2/0EQlGgAzHKWShy6PIxfhvL7HxwnJdj56jIxzDDsuQNTvVnapAq0ehuyd5XMX44perXjeLSimkzr8e4JVYjR4+c+rAxbzYY28fOH2TIMXMEV6hpdMHT5Z44gyC5HbNAy8ivUXL7w4xj4ESvYWMWtVtAtsHiVsphIoCpImRrU73/WlBLnBqmSLk4Qt7ThvOWxh66lUxqL+84lXZWMACTrflFpwYQGhZDI+y1BEmJ9p9Ymh34nemG7DiRcaACiob8lIdCRIXqAy7UwoOYydJOR0bKYy9zouxsT8TzYax7OTqFQFyBW98iJegc/rf5FaP75ZNRfBLi5KGBfFG9XUlDsWBeRBwdQ2MGL0HWAJdYcBPhklRmGLOxmDsoqNw1bpsHajq5N4YEophs5TkDNbp7dbIX/oMgZr/ICnqk2bVWtax406AusjqPT0d7zx/VZzIrindWuwrSY2aRbH9PRTxIoMhpwzXnJAhYgXUmD3PQeJ2ZGFRa4JuJAYYSzSfAV6Ffd7rbBpFBXTjagFDjYGngeJimSaEdl6L3I7uphFJFJk+qcCun4T2/d9j2uURfm+ZKmztAo75lrNGmxwmEieJCFtM0U04GIbMPnx5NOAyXbNTLvE3cLpIFMsw7H/ihjHHioLPb449VX8cQVabOd4BhYxDhx8EAFYWgB8ehNUmj558Budqizk/CjRaXyGNfozgs4+xgCeEDck+M1VN0kyqzEJsBrn0uxvhsEsEG99Tj8iaguFEydFV5PWx9v0R96Sn96cENuMBJ5/Z/6I5u97P3mit/WNyyQ==,iv:vZVA92SjMbdLvKb7XgPM42HA1Vd0PQkjJsHAMIyUvv4=,tag:ASUcU8hiBVIpySEjqLDH+A==,type:str]
            key: ENC[AES256_GCM,data:XViUP4wc+qMs7edS2/JBwWJEEGyG0l3PRPQKLDACgLv2LuJRAJVsQojxUMxqS2VW3pR8tPHGnWkeZWbeVySE8I65Lt1ew3djIbdPZv4Q7afoZfCfPXFhkYDUYunMYkjXBFvHwXzsKkVtgD3kZ9r3yh0Z4n+m1wsK57UGZAlSg8McGHSn8YbeIY55gLr+LpLC1woMr2u49Kg/EakNJtQYWajB9acvezRl/lw1WDxZ2jtAw9qoaz+H6BMM84g481yaLuYUPvguX0WA9tVmPaKYCkwC6uZjFzqYV3P4grujYQLrMGYCrSauEypW52DGhuJjLnphLSlVg2vFrXfUsVF0BUHWU094yUATMV05jy5F/JFt7r1qvQ+0ck9sAgwc6aqBk/hS/Y35uKisoe3G4h+mNw==,iv:4z2TXMJ+MbhgrOraHuRCb9xXUXO8j2pv1zJ3Rwb8Z2w=,tag:/1jv/f63schQFaQIKLDNeA==,type:str]
        extraArgs:
            listen-metrics-urls: http://0.0.0.0:2381
        advertisedSubnets:
            - 172.16.11.0/24
    coreDNS:
        disabled: true
    allowSchedulingOnMasters: true
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBvdUJQY1dWcFJNUWdaVyt5
            THByNGw1S1d0NjBKV2JtRGZuZEpqQkZhYW0wCmZQSTc5NU9BMHlrTG5JWHlMbnBU
            cUpLY0o3ZThydDZuVVNaZDdRT0x2Q2cKLS0tIEJxTEdCSWRjTGNSUWZQUnJ3Yk8w
            RG1kU0ZhQUl4cnBmZ083cnJXNlFpT28KWwA1j/+SQtzo3IRiDY1RbZ/iN5oEZ9dY
            j1PTUHkEKWFJ9AhBROfLg9c6DD8d09kSAMNFt3raz6myc4HiuSKPCw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-09-09T02:02:00Z"
    mac: ENC[AES256_GCM,data:o7Cn55cd5rXFXPNnK+JpTvkh3wOx7ONkSCDO4D7WBqtHHXCXIXqJtbDv5SeISHmDU/mOKG6d7wTV6wQN/1/6gr+pUi0AHCdUD8ayG997bHUuDUfPKwzMzGmvtUL0CYB5fQ6vIkI434JCxW2/93/Qn4ZDn4Ahpwk7D0t3jVCNDBQ=,iv:kc2cw5Gj11104MmQTe0mz6GtOCM1M6MLZmp6uB4rs6A=,tag:o8kL2FGxw6UnJSh1p06Jvg==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.8.1
