version: v1alpha1
debug: false
persist: true
machine:
    type: controlplane
    token: ENC[AES256_GCM,data:1r0NGJcvIVM3l9JyJ4Jjy8+h1GaWDP0=,iv:/VVGQGTR1iLavAjIcS+RasNn+C/u+qA48xH9eIANOrk=,tag:vPRDl+kW3WapPOaPy3gT8w==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:DKfclO75ndg8n6NOBltm4rI+AbiqZtopoxR6Ta+gcSH/cNZjnePnLqC7K5G7COyOz3oG0+YxN3hO8o8UOmedT59QxHtmUx0eu2b1sese0xzjP0Aqfd+GLGVZmlgmlkTtJWX+p9WwYA67FJrOf8k0E8ieCoHaeafFxsQpFyTfzy4STJorpraHdcGOm9acnLm1fldEPRYWxqnPmix9bHbZmGZf+gaqE4a7tkyERaHP4JlX+9Rhzj9NdX9Zejy/vZciwhzLMwO5l91EKEpiOV08UZEn7HKC7I7+nOeocTn2oHB2wax84L0WxEvDCMo6crNxQLRU2lHQqVFCyWmb/xms4O7KV7+dhjWPXau86bOXZeoyP3EIbrKIMAYNzloOhXLeehHcDOqIqj9V+LE0jPRTLJ57Q3fFWXtAdjARSIzzlRgmGUp1oNcESpwuMOCmDuqdHCq6O/C7y17N2NX0VIMxv5eoZlsz19jt5iWJz0/qI1UdslVXH32IEcfQwcgFo86zSHujrWcQfxQsSHII5tRh3ZX1E5MM3NjkQ9FyhsumD+sLEDDFafnWrkU3UXAx+18rivHUCX4qqjleg8E2F/3OtZ8q2m6I0MsuRNXFx7PjzgPskrqwKNP9qYF/Ked4oqPvBd8qgg/SYBlB+YWDiwx1T+A8gnqvE5Cwrk02EFRBrQasClLCsI9kj8ZyCSLL0TPvwzuSDHQ/o5EM7MqXEnEZoFbByg5bCttJR8sN4113GGYGkrF07P7MYN97/xP4OruyhpcUdx7zDwRbNSqrDZ4uXLCDprAv+e1vvzs/kfSVKCZ4G6ptLsFDwQ9pOzpRPaBvMi6pXP1Jcxaja9dyKoj4kY7ojlBg8m/57ea/GLWtw6Q/vjkA,iv:sSF2Nj9D9oZnpdERh/xFW3nI/9XL4nYeDsVrTFln8vc=,tag:wvqlpenQ+hTv0C3mcou8jA==,type:str]
        key: ENC[AES256_GCM,data:2XhvjRkQ1V/3+OgilVjLqDTEQVkjxug6/FBdeRRYUVEqUclCpJUvGWPv1CeI7POfLGvM62D9ogZGj9SIypZR8GHgidNC4Ht+6fUnbaR/CYdt+9j9f6ywUcCP9KTtbDx+BqrsFnxDrz8BNYE4qJ2EpFmrTnmGUCN6uCR4SZ2xsv51DV3zXS5gfhedtvKCSUSGS+wSUxDwyv5EetTzjWsmRIWXwJDm3BzAWliVNLqR6jZa6BJv,iv:a5qnt9LSVxgsVZcHwd9mwGGXKscqfGCPM7DN1Zu/hpQ=,tag:oFjAIn+3s5zsWtzA9Bho6A==,type:str]
    certSANs:
        - 172.16.11.20
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.30.3
        extraArgs:
            rotate-server-certificates: "true"
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        hostname: p-tlx-k8s-m2.monosense.io
        interfaces:
            - interface: eth0
              ignore: true
            - interface: bond0
              bond:
                interfaces: []
                deviceSelectors:
                    - hardwareAddr: ec:0d:9a:00:27:90
                    - hardwareAddr: ec:0d:9a:00:27:91
                mode: active-backup
                miimon: 100
              vlans:
                - addresses:
                    - 172.16.13.5/24
                  routes: []
                  dhcp: false
                  vlanId: 1613
                  mtu: 1500
                - addresses:
                    - 172.16.14.5/24
                  routes: []
                  dhcp: false
                  vlanId: 1614
                  mtu: 1500
              mtu: 9000
              dhcp: true
              vip:
                ip: 172.16.11.20
        nameservers:
            - 172.16.11.9
            - 172.16.11.11
        extraHostEntries:
            - ip: 172.16.11.20
              aliases:
                - k8s.monosense.io
                - main.monosense.io
        disableSearchDomain: true
    install:
        disk: /dev/sda
        extraKernelArgs:
            - net.ifnames=0
            - mitigations=off
            - module_blacklist=e1000e
            - talos.logging.kernel=udp://vector.monosense.io:6001/
        image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.11.254
            - 172.16.11.9
            - 172.16.11.11
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "1048576"
        kernel.randomize_va_space: "0"
        net.core.netdev_max_backlog: "30000"
        net.core.rmem_max: "67108864"
        net.core.wmem_max: "67108864"
        net.ipv4.tcp_rmem: 4096 87380 33554432
        net.ipv4.tcp_tw_reuse: "1"
        net.ipv4.tcp_window_scaling: "1"
        net.ipv4.tcp_wmem: 4096 65536 33554432
    features:
        rbac: true
        stableHostname: true
        kubernetesTalosAPIAccess:
            enabled: true
            allowedRoles:
                - os:admin
            allowedKubernetesNamespaces:
                - system-upgrade
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
            forwardKubeDNSToHost: false
            resolveMemberNames: true
    logging:
        destinations:
            - endpoint: udp://vector.monosense.io:6002
              format: json_lines
    nodeLabels:
        topology.kubernetes.io/region: main
        topology.kubernetes.io/zone: m
cluster:
    id: ENC[AES256_GCM,data:5MZAzbZ/M2qPEhQgIo0xG6sjT8+7mr5se20c/UuS8p3R0ldik9G9Ww16Vgc=,iv:lcO6wMkITyiJC3AGvtL/035wP0DoQAcVG5l72gmZ8L4=,tag:sP+6Qr5O3zcDzURfAufaYQ==,type:str]
    secret: ENC[AES256_GCM,data:UspSJl+A0sKqG+nnhRbVY+yEUoUjN24DgpEGqGlaqv3oKZHKnNSRdSQODS8=,iv:U0wyMQFuhBb6pBdr14ZYb7+kwtKvwYoNiHaZPQk3GQI=,tag:r7m6rCJI5rRcSf7X1OO3bg==,type:str]
    controlPlane:
        endpoint: https://k8s.monosense.io:6443
    clusterName: main
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.42.0.0/16
        serviceSubnets:
            - 10.43.0.0/16
    token: ENC[AES256_GCM,data:0NorbrY+kkdE8od3RJjIW1mkZuKiQN4=,iv:0BpgKgns8RIv1o3MPeqTahOKhb6WnMkg0+OtqlgvOk8=,tag:0bJaxuwkxb9TppYAWXr6Bg==,type:str]
    secretboxEncryptionSecret: ENC[AES256_GCM,data:6lgJ5b2DazeyCA+mI1RManxfzg/vpZGwgEWv1ZzK252l5JpelGw+HKLGHKM=,iv:5vIPOuq/b8SOU5fIkLfODoptcZGP6o7Ycn3hI5fqgpk=,tag:40nwurRUy5nOKu5lMrmcng==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:kZygVb4JWgt07KNtJT+rGm1osbTxRXVBPz3ZYOWrte0z6ffUjwfG7nJLYf3JHndA/Ui8nuRWJRZP6XlO9HyWL3Fcso8ACFrCI64ByJg/PQS39qh8LXd4+++aVh4gJTwxlcTVreNIjyAE45uX2O47wVNTjokwJ/xaQrvVHYQcJ0+dc3rLeUKzRMwZMfHNDzcJBtnnoTShpboYrQ9jVlA5cipWjBHbBsr1/7UsRB1Y2H19NftQUCQ2v/0HsC/ghRK7SLdpWsNuRK8b/APfsOP6rnBRq3fsYZaL4cbyrA87h3UtabnXdsSGRs23QaiCyNoT3YNYhdRikJlWhW1g0Q3974faSqSJxP9G0AvqF2ZClQ3DfOaQQ5wy1Z43/AhxXzO+it/T8+75G6anQxPJnV59t3C0FJq1swMpJXXSdcFHP0FW4LQ2nhGHRam4n/VK6SZwTW6JPkjUa7sCVMQvnqJDCc6sLGMOJGkC7DcuOTjPCoYEkg8HrfUs6MSQbKpqy8i6hKp9oU44hsoSdQ/TpL3fb25jKzaE4POzetTRSMBWGm0NayxmaC0yePHPbjn1Rv/YFLJI8+4KOIqyoY9F5mlWzGYV2yKmpoQl4h+pcW/HPRlo4XsaAzMcf7zC64iHlV9wWmuGJIE0tRZVI2anisC7ZxZnt3p16FGO6BLFR5iNbB34R3p2c+rKuLWPUCHlXQfinwDA9MOCNx12XYc0g843OOtnCcmHcyADmBLOu8GbiuBA4cJrZH90rwlz6HxgrCtbb7k9HnW2+UAo+bbF5D8bEOzH+DGqJ0Kwj7doOsGZ0NbbUl51XRBsh9RcqN7kjblpOalyYwjYKEeZdTggbRNupTjO8dhfchNqoJDv8jXKLW/RbhYggSZ2Z2zhRIalEy4v9p3GoaWLFJTbseXWt/468aDSdno5sJARq7SWQkkAm1jSJZcxbPg1lgBsf67XA2RALPMyyQjc8iDDVIQu1vBphcXAwwCDXzzEIigtxyaCeUe0+tHfnmR4EOmPGDJbD4lsgovSapd87kSb0ywmBFXP0xf35cx8qRIPpsBuSA==,iv:0H/tqVIBNQ6gYDxwD8mMamFzrot1LZpspdG22mXsReo=,tag:aBTYvG/zqs9qoXDo3zdD5g==,type:str]
        key: ENC[AES256_GCM,data:hbc7+DZZvUhOyCRYDZ49v1SS1kppUnUgJvdqlSOTntDWzGHLzz5sTGWFHjDwTVoYpwmjzK+g3wuLlJ4zuyI9gWgjK3PaWm3xYkGvL7TrqtRvbUuBogpgyKuyM/dpB12Sd8iMAP5rX5WjFzZEx1WtTgtutx20BHEBPClkTLnmSgtoY7HkbYrrdxrrpg77LDTTdH2aXz1DpQ7o64Mf67L2z+brearw7rm3TpBVNOrgWuzJbtER5Lnvp+wjYokF1vyfkGwpSwGr5iLQLV1sXlnXPxML6rTQPtZNl4fhsK9KWh8ufyg8Wcru/gfwMZZ9zpnukBTIwm0Oed74GqKixr6pb5fXzv0y6OhhM7g2s+Cg6I7BhXpxyUbIxEARyRLt5Jkx5zKqnKGHkNwCBvfOOgBxsg==,iv:LbPKevgdoWgNJF0JvdTPoYcQL/bzQ4vSoKZiSbY3w84=,tag:xdboAmm7ajA1hUu4Xuan3Q==,type:str]
    aggregatorCA:
        crt: ENC[AES256_GCM,data:NJPhD1202H/30VVb8q0IAlL9MF5d8PSamuxOfraWknjAIe183mNJGoMcb4oj7IOzI8sVWy1qZ+dkTx1t/DBW0Cc7pLUYJs104r6ssaHF2xxMbFELKeSMSZ6dg5J33s6MHx2/j2bxCWyjNxWQ1FQk84MXRWXRH4llbIY69md1rLSPw7mvZqNSEBdZKwZPq7TKT6m88dU4noun2X6fzYH50NeMvspH1sOSUOCDQXIDaYXWl7AZZiSY15YvEMk6auHhvil+TYNMSYzGWwjyq0mZAaksUVYhH4Zl6xRKQ/PyxMcob7z8trcqqUEFuQnmshuzciofnbz0CjLRPI7Zil7R6luD/l8YIuhwkPVj6YMjDkSAgdT0xkosavNQP3T4aIxNvJQfp8J9p6LNmgUYjvOtAigFmXQLHiCZDDNmNmIZId2UfvWNJdiGIOIZic4pIBI3or0EFcK6mUPxhhOCtlTLIl+cdNCbMbhbT+t2wpG8W5mH1UotN2ux7PndEtVFvxkgnRk/1NDpKKiHPQheqaD+DO12Tjz+ViCD5Lz5WSLi4t8GDYUQLok2HzzioJ5O4lwftjHwennWbOT8H/C6dtN01SrMNmARrBgYK6VVVQ631wF8H2am8RWqF+vBn1dSolcax7x34U0z11MCiX9EPoIKZUEwGAwOeQsj1mSwBMg/2UwjY96Q7zZGTUoWo/aviA2lE97/5fp+ggeFgkXxtrf4W764r1zFBp8KDDKCBRfbLQIy6Gi4g3urf0m0h+NVphJndlzwN43dxyAGeMI6UBJDlWMpqbZfvR00JIcpRspkwC62py63Z10R8tj9D7OpJPrOk+xGSJFIj/ZI5pWyUpaH6r3HiomyO2WQQuOmHlDUanBm+/WvLZsIj7gTpEX08zPKIT00lat4aJzYcm+e+Aq6qOgZxtdb9MKETDEUfVObqhBudV0hDBSVRBnVFGLI2oeC,iv:3x7TX4BUHevuU46XPhx/orIf9oEDtb1T2PxHJydGWIE=,tag:hDQLVYj8bweKDUDDMogxEw==,type:str]
        key: ENC[AES256_GCM,data:qxpJRAqVHYKe4tJN0/2ZBjVsHUpZ+NPrtUvmEZVpyIvvVPD1V8CQy9hlScyjItc3GwsjzL6EN7tiazHcVnRFqHa5DWM9w9uSrXCXhjdt6nubhJjJBl6rxA+a+DwnuVhsRSQSKpRu8Qkx1tc0xH0uqPUFpcBSdiNhC77CKHZSIOp87ks1DoZpuBR7AHwMhtoNuJVaFnbZ+Bd9vK/pqL5q27ZUYfau8QCaz9SthKyLixRdpdPnv/nmJ1XNVlvsdqTGnTar7m91p9dGmIggQWtsxE0QmEJcZT7ucWWhdbKQS7zPb2+fybeKGltNRFLN+xguQEAu10dY6ITK/rftxBym/il5vS2uyKa6uPcdSgB1uMDftvGO1ozQYYtjKLlZaHTq379TcFmIQ22JWxXafQ+M2g==,iv:VEVPxFpNu12z9TtxNaxUmgZGPk7HgmwKMs/zZedOBXE=,tag:/yoqybDNrvijrotQ710JzA==,type:str]
    serviceAccount:
        key: ENC[AES256_GCM,data:kg0upAETmWESnTj6BePswIRnFUwwEFVBLgl6IlRuU08fC+UZE93cwuqrkndPC8jSRhbHSa+GQxtCJRGrfgN3Q3iGvvwavAWtmlJLjfe5wru7Sq7+SKBedcqrTTbEwZM86khFnwUan8rGUaXnWB53y0KEZC7RvJsXMkRdx99Bt3ydzRkpAmgJ9XP/43a80ReKtR3Tm/OZRoH6D6HTDBjAn2mV0OfHIYhvSr96E0yP1oL3320K2/Thdoh4TBZf5L29kU+TaPfhqXDgm5FS5DvtlBZn4mBlnVTjE7LADSSo7GVxKi1v4Eefd8cm+gjVnWnB/Lec5KeU+hXlEM7tVcZLayg7oS5U28eZ7JOTiRSP35lscNT60ROdPQfb8HMvVL9njzd7yEc96AMt5XZwbNkzlA==,iv:abD9Ej10vtjjCgTWAFaCUqqJHoBYdqNfRGAXfWwknAo=,tag:juFegyxb427D3rwDpwobzA==,type:str]
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.30.3
        certSANs:
            - k8s.monosense.io
            - 172.16.11.20
            - 127.0.0.1
        disablePodSecurityPolicy: true
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    proxy:
        disabled: true
        image: registry.k8s.io/kube-proxy:v1.30.3
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:Tx5nO1fox+7UCouBEgd1Y+eDuBAUSxAMnPdueHmUtQQCLEovuMhE399cHf/QVOOkY64Q0qYnGWBHUJgr8Gvk/JeoGkVcmOSRvCGuFhg01aYeAvXswNQvhAkjrchiV39Akj1Akz5jwV9yHxaSg+gmGLb6W8wz6uy2Um3Sq3J5Mt2awTZ3vpL/sLXThpZcM1goWJdFbr/zc25Z+C8MvVBF1dC55P5OVWFUDjBxhhqSsPRh+X1RtyjCHV1H9eTtm+ExS16pcJNerSTM8GE/Cp9KCfbA1rjMURDOYpW50LNOXEdzpr139JD2nsejpNyRAdHjynC8b2D0DTTKwetrUhTwVWdwIIm9wQKGKecxru9mGrQD5EnWF+TUKej5+LqiT9/duCeZdl/Kg4jCSCMv0PUOde017erzC+Urjdz6hZdQ61X/OlH2KRZsJWWAdnIQkifTpXFS6ZAC+o2cQW2EYrAHKcncPrLWATIcmW05is7KJ8S1RTV3ZMMblDZGgYYDjW6HvYr8XFZWlItF6vFD4QS8atTm2ljjRTe3HFh8u3XxBgCQ9Ayjt46Ly1uduDMavZKH/czj8mlYsZl9E+ukCjpT7qLmMTHUayibi+FzVTXAE4k6qEtu8wQ2Q2Dd1b9vWp6cxNGHU9lSfYlPsBNC0FIdFEG0bVzJZzCasErr5nxr5+5524FfcuH5Dtzbccr6uASHlV0IwdXUuWZdyJGTg1tvTZbzRdDfy7qtflixN7yOpcijCaU0HUUtXN7Je+N0HduEjO7MibxjkWA4t2AD2MfsMTr9czTH8ovy6Kqjzu5Ah0m4lmQoa7LAAVmOtXivmLvtQab6lXs4s5yv+9S6vp5tJX472DxrrExss0nVKz04XsjIio/khV+WNPG5AbhXad+tiF+iMAc3C+5baC3Edy2XIgVEiJOmkVVAocs4ymUGA5ws2uEqOEEAyGku8bRoW8/A02TsyNjibXJJianGqXOETIZHsLflflHGZX3qKNoACId6PccVeYV8y0lYb7Ggz1UbTRZg5g==,iv:xzUic1HzgVjIp9T5QQcXa9/CC/wcSZmCbqOY3aYN/f8=,tag:n+CIZTphWSlJPkyQael09Q==,type:str]
            key: ENC[AES256_GCM,data:4w3pyhHGtv7b53cBsPmHH7GniqR5veshmtHCtfbKi9oeAwp839WBif8qmA4CLEbg5Wu6e3IsjRbYZMRyuFH+qkUy8Oa5/U2pj+HpRmcchaU0Z8f5xVgobz6ATORH60o8Z1MKfYjEpWdKNyyvlgGdLwx/ZoFWdN3FKV2MPO8U8KvntukkzI7MxFyheR6RJs8J1B9fsQDSiBsT67GTcGxeRMLYJK6P25Tfp9KaXDNULFzmzX1mYuSIKYODyFMufFxStaixhItWGLDcJ5IUhi2RgDj/iCqt5ewEYNOgV+ZCbJyJt1Xp2Q9+xt9BBw88+fi9ZBlyEWSnkdbhrsOookqlPfBHadO0xQz+YPRUrucEceiRiKzbxj3AMMWrwbFWM3RDzuzATM5T+xwPlWo1jBCeRw==,iv:/qvyQKuag6OI8Wk3MzZi9Wi8CvKgptSOv90Ac5v/8aw=,tag:z+bPF7llCk7W9kNLmEeHnA==,type:str]
        extraArgs:
            listen-metrics-urls: http://0.0.0.0:2381
        advertisedSubnets:
            - 172.16.11.0/24
    coreDNS:
        disabled: true
    allowSchedulingOnMasters: true
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSAvbGdCRmZMTi8rUC9iNXAw
            alRFYlNMMDlwWWRaS1RyVm92MW56YWhHT0FnCm1zQmdIeXY4eHBDOUdGU0g0eXBw
            ckdWaUhOZ21QaU9SY21xRkhtQlp0T2cKLS0tIHdEa1U4azdVVzF5ODNacThyRWRx
            QnpGeUpDSXBFaTA5K1BsRGVwQ0RMWFkK5Qoz9x7jX/EoBPCZHrVWiIyA8yw6vr9d
            sM1F8XvU2OHn5QDUkP583APNFysecWt9n3APmLDjKzDUJR4UoNMGeA==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-09-08T03:00:00Z"
    mac: ENC[AES256_GCM,data:uENoZT19JgRnW7BP0F1ar6rewz/krYAykd9JMg853muSyGV0wi8DHihJx2mv0S9UY6VLnMC9Q3AdMwYoUg0l4//bimacJ94Xx0T8ert3BilyVFO9vWOW4UwumM9AjkL7HEaH+3AX1m8QkmSDf4w+Pp4wxxgRrsgvp7hJ2aJoLZw=,iv:OQxJiXaeSDREgEFzaIqD0Lw/gRoz0T9ychM5zmdFF2g=,tag:ZcjGew+o0YiRJpR6F5PBTw==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.8.1
