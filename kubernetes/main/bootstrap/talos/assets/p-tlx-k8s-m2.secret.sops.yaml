version: v1alpha1
debug: false
persist: true
machine:
    type: controlplane
    token: ENC[AES256_GCM,data:gMbWL7gWdGBp4RgxqfgilQCoo8yxX3w=,iv:SAK04JDnszlIvqKNQj1GRoqpAqNg5GVCTu7AdsqY71s=,tag:9dwgXQGnCbqmSN+TmsyVOA==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:PwetvvGyV0sZwt3OrLhwyZWFpehW5+Qe2xmHULydokxJW5Am+89NRRMAddK12dD3AughMzqJAIQd4hIAheON9c6dkfuUE0mRFFAtZd+FIwIDs3YSs8lEVwcPs8hd1GL/5/BNH+15APdzBDI7ic5p2//GvfqfgH2B7baHm1HH4RMMYKmgboTGFn8HCg5btDqayOcHkPNmqCvjkY4m/ZIrcX7BmMt6bhdIQ2Yk3uN46BkVbTei86s4rAvujLznlj/aM8RR37pTwKdbOGz6b7V37tnoKNpq/4CSYtmHInBNpreRELoMObJF4axI3SL7s+VUGbsMHby3HsekGwj5/Xpu77mbkOaQPxoiVXBUYIrYvyvVCSxOzRQfsWZH1e+oFwRFvZ07qAKwMBrLd24HFMaAxq4nV6vOE8fACm7BzHPS51mHbk/C3BZEKj0rj0AeyhKSQvE5D2MsEPq7lT2evEERTRRuwm+1M1sFxR0O/HceTnIvqoIc6GqkCbWg9wrqihN6SZp4N85GimI1GLAo+kfh6idg01sDyUqfnDm+TrdybYTbOUZ0oTf/FXSR0dZCpAonWQzWlLb8wlLYTwf0GgtiL97nKWl96dwwM+3VoRkJSCnu+azH6G/eh95zMYj3KCF3CIirebltFVBBUhcjEYJSZsUDqdnDz0GxiUFuyjWHsantwBj/Kx9Nqh4hjvxoEGwIhiWr0bgyRJx6pJS3GNly6X2zmazF7LiBVWNSbeIpVxIlfDtU2Irrtu+VT9hlgJKtTmHWnUFcI9KYHNQASXLV1rxCoamYmcYkggwAekUos2YO2BvL6lVJpeX1uKsmAWJIngi7aGasI55FDF0vhvczWiL1OksS17mc3eOmtfxdVn01CfM7,iv:B1MjXAse9LBsfOXts5xLeTOR4moUMSzplEQ3lOya3JM=,tag:2mLy8klhGNZe+uVYNCSuyg==,type:str]
        key: ENC[AES256_GCM,data:tGiffdfJuDb90PkzDybjCjIapHPDb3nVXrSQRGTUK69d6nm5vGYdKyhKciBwQMY7W4mCFfSjwu+DYY1jW4FpTp+MyKdd0r6Odafaw/QXPQ5n38WlppO2VazDapqdBRdq2EVdjmyNobcywZla+NVs7igxW/eYlGS4p0kUnU/ssbMIuKWs/TN5imSXOQv/OvdSNgxUVjCtiGPnqIOUkgFhEcau3fPgA6TeUvpFhDYjo05MkhNw,iv:Y1qQn8gjBjOd9nUVLYHTCJGULtTrPEvUp/0wSvMg4Sg=,tag:ewUVvriCn/dZU5fqktqNqg==,type:str]
    certSANs:
        - 172.16.11.20
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.30.3
        extraArgs:
            rotate-server-certificates: "true"
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        hostname: p-tlx-k8s-m2.monosense.io
        interfaces:
            - interface: eth0
              ignore: true
            - interface: bond0
              bond:
                interfaces: []
                deviceSelectors:
                    - hardwareAddr: ec:0d:9a:00:27:90
                    - hardwareAddr: ec:0d:9a:00:27:91
                mode: active-backup
                miimon: 100
              mtu: 9000
              dhcp: true
              vip:
                ip: 172.16.11.20
        nameservers:
            - 172.16.11.9
            - 172.16.11.11
        extraHostEntries:
            - ip: 172.16.11.20
              aliases:
                - k8s.monosense.io
                - main.monosense.io
        disableSearchDomain: true
    install:
        disk: /dev/sda
        extraKernelArgs:
            - net.ifnames=0
            - mitigations=off
            - module_blacklist=e1000e
            - talos.logging.kernel=udp://vector.monosense.io:6001/
        image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.11.254
            - 172.16.11.9
            - 172.16.11.11
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "1048576"
        kernel.randomize_va_space: "0"
        net.core.netdev_max_backlog: "30000"
        net.core.rmem_max: "67108864"
        net.core.wmem_max: "67108864"
        net.ipv4.tcp_rmem: 4096 87380 33554432
        net.ipv4.tcp_tw_reuse: "1"
        net.ipv4.tcp_window_scaling: "1"
        net.ipv4.tcp_wmem: 4096 65536 33554432
    features:
        rbac: true
        stableHostname: true
        kubernetesTalosAPIAccess:
            enabled: true
            allowedRoles:
                - os:admin
            allowedKubernetesNamespaces:
                - system-upgrade
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
            forwardKubeDNSToHost: false
            resolveMemberNames: true
    logging:
        destinations:
            - endpoint: udp://vector.monosense.io:6002
              format: json_lines
    nodeLabels:
        topology.kubernetes.io/region: main
        topology.kubernetes.io/zone: m
cluster:
    id: ENC[AES256_GCM,data:memIAO6z8jAp4pKrk97r3MzLTEhqJNanqmWa9gkkxsjipluL7HTZ0BOoMUw=,iv:5HnKgMHFsP2EqPTeMU8pbWBBU/BZbxGaX9JLS6PATfY=,tag:p8NWSgQcPgp0vUOXz4FOyg==,type:str]
    secret: ENC[AES256_GCM,data:UovCbw4aiydCg+Int1Mhr1DPFCW/iirhCEZUv6OorfnXdJpdOaAeQpyyc3w=,iv:KXWQoxN8HvfCJfuvfoTvGvTDegE5RuMJcgqt8hrOjZA=,tag:VJlRdnaqSC55CacPYhnr9A==,type:str]
    controlPlane:
        endpoint: https://k8s.monosense.io:6443
    clusterName: main
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.42.0.0/16
        serviceSubnets:
            - 10.43.0.0/16
    token: ENC[AES256_GCM,data:YH0GdchaJXXPch7dxZ/kdc1Bu4lijus=,iv:0wbad4B/0q9ssZx7jeruNdstVM1DU+NLgBLgYNhVO9o=,tag:L1cTcLqiU4lmlVxilWsR1A==,type:str]
    secretboxEncryptionSecret: ENC[AES256_GCM,data:ClyRBBp5Efh32MNiQkpPgPy6CdZJ+y9A56clbvYcd+8mU3H1b/QA8gMlMzM=,iv:JIDakBPjZ/jZ27yAnZcrqIVZRJ0qbaebYcDIlu6VBO4=,tag:cYCW5OAXVUYoEJekm38oCw==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:Cx8xtxvJAsNXHhkelDF/Jcb3kQjhUGk/wHHLCstQ9R3LIBn3KbQ7L4cIct93+zIxAwt7brM2ETMfb4MJe2fBaTDiiyCIBsgf2Rky/NC66E9zJFs3a3JwbJ5WragUKQ2Dt1AsW5zvDLlXCLBmTQO79zI2SpE30OhNyKsPhtN7p1Twhk5nyDZjqohBnM6DcQ7LpbdUD1l8yhpOXRF4p3y78x5TMsAAvd+LeRFlS2VRjs5mSsbrsJzPPFTo77C13ZylWUVUYWQ0v2n0IZBhBixpvOM2acr0mIafrpm2ot1a3qqv6/CpMjd879A7yYfV2tEk/xvqJm6bdyi5CXxEmegzzvhFCAT0oJ1TfpAx6piyMxb2GqvrxZ79CKVaeq35sumuJ8dqpyc1VRuldqj20TD6mUeec0af3au0NJwPGqZnQixxx/OBXxQCWpSL3BzZzpUr5Cjyi4DcZ58oUBgFksIuP63Y7XO8i0TH1veR0Mey/zY+maIe/R/qL6C+Eu68aD844FsniAJLUmGPqowaSDalo+Kl9kwXDcbdKDvka85oslkFuJUu2Yqn5WadYUieJJ5VPr2Yj99PNdrYU1SJq6nR9KWP3XwDfP90JLjXHcb0e2LuV9C7c2TEUCm399xLPRsc5WdVOT1SwDMdtdSEawFEUX33zw0JYsZLLVCmr7bMT2LwXMy0FaDy/OMm8uU8nihcxQ3A7ftxN/oBKMaM+ggdos7RyGs9vXESxHUtU5+gnV8+a4bwTlR4PME7M/oHjVgfjKZdDVVanSDmZ/0VcgQoufNp+RO64lhY8Igm25ijycRq7uvFFMDyEBWowYwauy53B6IxxskEdpfWTcwAQAJ+taV+/w3qeubLbCn0DjhBYwN4IehdrJQLUhyED8eOlRxEQUEDaKGP1sevuiDlm26WItJ4XfW3nSqaQa8Lh7WpAYKbG/CCGn+kdMuhOvt9jPCasgK2H0IdbwAhuOvBh6FeXCF73xbbqLNDp9ugMibKMMk/TfAg8TJTkv2tVfq8C6BxwJ/ejUKWVYvc2i2tU/MEVj+C0hn/P5loF8hiLA==,iv:OaVQ7M4Hv4OF3fabFcWip0I159gqueqwZ1Kr+Dfzh4g=,tag:U2AmxFd/rZKv20tMIdXABg==,type:str]
        key: ENC[AES256_GCM,data:zV0uKcJwcGYDnfRMmVGhXKuYNcDcm51wdlxe89UaZyTnKTs0LpjFVzhsf6SFBdaECablf/OTTlMyLZbF4uhksZfeo6u2JR+H+3JFtoFsWXO42Tp2jV0jwci51VCaIXf/BTxNTyArbqXJRdmHTGn7msN0onKyz46D/e2YD5d+PZK2qw76GiUhmh2fLP0DSjpRgfUhbVEFsdlEqPfxZjM+zOUolGEgoOh4AChxn/4FR9ZYVJleXXv6typUMSpHITRtr1OXag+7Xl5K5kDEMWx+6Qx8q5dls7a7EbzMo1i1n9WqCKnNGrI5b0rgqMxsX3sQ8bz9JtfYeQOTLIU0RIBgl9Hw7XBJ4d2GJUNtVlM+//8Sn66ncuo6a+JoaUrW4i8ypdFwgiNkEU0PQy2ufhGAmw==,iv:wSGzDsckC4Pjlyqcvyml40lA9oOrPA0cT1oTCEO+jPo=,tag:/ghiKsoyQ2HAexmlq2uaWQ==,type:str]
    aggregatorCA:
        crt: ENC[AES256_GCM,data:uTcY8KM7rsTe8JuCAj7qGmBllmN+VH1WARW8C3NSlLaqIPmTxAZMzRqA+EvFaUiZo+1ExPMZTCXeffhk71jqrFxzvrek88BKYNwQb10/J+MOrysvz2k5pSGRH6Z63RQYtgS1acNe4kjK/1vWTrginsoX9kVw9h3Ine4nWtTRl+lv1kIY+mr2X5hhQRC1Jvp3XBAbuKlfRA1T21uhQJC18096wiNLpDdOK1Mq83BmI9Z5Cm4OL5/u9sXanl0gsp6trUapORhSiqkfZIbkX/tS04CkUshUNA7D07EAFXDyL9nTnoEbTsmZYRYU2FrLuSFXkLVzWEW2ogAR4/lCTwr+fpu7JFZjm5MQ8GQLVIibB1AQoTPvvZDfgbBwABXYXFVv8LPDgszDW4wvzPYx5QZEYfGjI1/eys6FhJXr9EbOBhUkA8CAKLXWBb6Fy+g+9WQRNq1f7pB0y6Ol+V6qBWpNr+ZguvIVVyE1NSX6RcvYGUowFp4M0NFdyETzgpEldk9wS1yMiGwOjt17JzsbHrVep05P6gL8Z6B+Hq26NyvRHaAli7CJyNgIesdZCkbKZA7N0+a7cKsvEii9MW+RtsJcCxF//80mkr4i3rJFuJi4SWsLg3Kk7y1PJBGHKJAnenA6o7PQtfN8+Eq4ZIqDbyqV0wpx9GEmL2bX2jMIfi7YgkH0H7YNcpWY2UkFQNsbDnTcXBlX28ssFo9r6KsCBULNslHNadpDLOugasUlJnqZLAhBROImseHbiaVMo6iBCrSr5/dnpaZmV4bAv5zIldITp97TPSajv+9ydchbsDKTGHEKIfgJvV2e14fQXU3bSOOXajsKzgJVPr3DKYz8oIx8otwD3VVfV6CUQN14ECY7uYCZsiD5IZKZ3GxzUI0j4YiCI+vUJjWoXmwsymp9rFFSX3zclGV7EEqIQtsUGtq94ng6ghpRnfj9qxNqWBhuOORj,iv:vzZedO2gA91I8u/ghRHoNeEZqrPkS1gLXl2S+VXOiQc=,tag:0lcX4B4P2HpCSuSHYSUblw==,type:str]
        key: ENC[AES256_GCM,data:gHmXEWKH+AhhAXGvqC3F2QGGcJlF1eaU7W0kcuyuIqI8JFTyyKgLlYj64Wje/CmKDNsmZWP4VlWiCA+WehiedGhm6FYNSpVzKES9iZdG9TEzoeUk4Yj7Oiksd2vKokMQgttUSRQG34xeQPivdMcgJh0eDVlkqX5veQisD116V3aquFk7DEsUjt9NmYK4c7qVmcOny7DctLtptjAQNmaN3b5nLIyj5i44j2jZaUAN7+58Muzj+bKhz8bSavckhJlkLR5eA4Egsg4icNjINRoxTZyTlMTeelOwNoPb6u1RYIoOfJkcfbKXY5+1rwI/jfM7YEqGpkdjezK/GakkHNexVeAgVy439BsfIWR+SMIZAgAKqtoTCipmRMHMfI+3WM0QgmBCNqcSxQFBLToGh9faUQ==,iv:N3qwvVHY+4FTzckMSFTUGDRcKqlHl58g+RL5xpAIGAA=,tag:8YXJYWLSm7S59SP6Oe73GA==,type:str]
    serviceAccount:
        key: ENC[AES256_GCM,data:1T7UWDrfWnpCwqsF9gvCwFa6kmcRNp3eX+cycTdXjDK8hwZyIfjlLMNN+XcKhaCWq4nfXYtptCuM7sR9dTtMTjS4/itPrFMkhQaDqHTCEqY3p9kibqShUzcg+kcy0QjoxW7rZsG6pg04CdBoHtoEbXvW/Yp4CFINR6UKsNUilM2cws3ASiTHIkZOmsxAWRa98Mw6iHKFOhwK6D8njMgIPOiv4QSbJVj9cSFd0gUMHXiqQkGhV3TMoTNLzKkl52wLSqMdhnLnH0uFRLx/6SZ4M54uYB9WAO2Guf0A6O92iEdwUd2q9PidhX+EU8Es2mFCqDJrL8h1z5AQVuScDEkkL+nhcbfbpL5u2pDko8+D00I82EAYH3fko4gYz/hQa+DYVKh8Aktxaoo3OYC0VFXNXQ==,iv:eMaXe6SdPwJhaTiJw4L22yladx2YGHLvomh45tf12KA=,tag:bJm7kf9fk15ytJRpDEWl8Q==,type:str]
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.30.3
        certSANs:
            - k8s.monosense.io
            - 172.16.11.20
            - 127.0.0.1
        disablePodSecurityPolicy: true
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    proxy:
        disabled: true
        image: registry.k8s.io/kube-proxy:v1.30.3
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.30.3
        extraArgs:
            bind-address: 0.0.0.0
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:adpYywTLlFR1I7aaVWmptCb6teMTwjOdGyWEoo0hSYIN0LwNEePtxnb9Z0gAU/Mvxnn4SM1WyEn+gzRgAq0qw+q5QhfH//V3dqlyEexHfgkJ0irrcJVrs0u7vmx1EGys9GqenOzWElSMg/dqIhr9OjS/LehhKcxRWFUVAd3op6Gp9G2xdJZd9O/HnBllhJAIytkYFbXjGOoj4TjU3A1seUIuQfGLi036R6k3RFScRUNY0qsodqMlrzUG3gsSbEMvdLOOEJ6v6jyE7BLLwDQcsRWDkBZJoAvYy+bH0cnaLnJQgkRPnFyiuCOcVrND6c6zynwieKSoFoKmOVaOY4ubBP1Rx/tj/WTla49rPpmsx0GMDAlVTDEZeDcxpDYWOgNehT1Wmb+GiVJozIrt3X8w8JwW275BvJi9VhwrptTWBw45wFgZhrq6vm2xUOgwLajjMApwBGhVM/C4NxI2BTJg9DNlIC7ekVOcwLhLW9b9xOIKl8neBuvHRcEp3AYGGkdp+7uKH7gM/trAhyukxPqdF5npkcqRW1zn11xFQRg0UMZquKC1iOhQuDWySfdQsbvnD0s9/1G2LfScmrc4UdMDOLy2wY62hov7ct6I3BoVTYYlqyOCoV5srdh6g+JlulGVPl6Qe7BMZ2KjXjOACEh4LeMd1de+ZuArsSdk73eeh38B1L3mgBrnD3Y1/qlSebts0baYmcuMm1somvrRriXXyM1XD79aJUECuZXQRxhPpdtKbDRB2cji6taty6hF0Q9kOerT8XosF0VEIlMpU4HEvub+ZXjf73Uk54Sj1a+GHiO+2c/kdsKne1gUmGB2eYTueDGpy4JCi41+H3SUqfueYLTWBfwSs+1fUQJGRZek84csgU+sjyXnD6jIkQWo50MM63QK+PQ1OxggVz63B4ZYPYN03uaTag6Q1lzUOYDQGLmO+goRl0DLKmsu9av26KvDRCU44yPcwkHarOTobzVpgch+ASylW+ENlmDeS6la03+u59zAAo2oPpm92qayARTTCbiQ/Q==,iv:NnU6T0AUVZqYTr+FqMVOz8mBsFtsxC0f5ClWlzA/RaA=,tag:cTOeg0/g/gh6yn5zXdeDNQ==,type:str]
            key: ENC[AES256_GCM,data:GSDtalR3A0ImwXYaYccw5EyL6gepiFWPCUyNG5GQKxMFtr/1BxhiZisHkx1qT2FZL3PWz3UKCTQXfMJ9P7WyHxn2bPLypD8wq+Ep51ws5K3Ame2vOc8MB6nm+KOM+6ci8PJTUYu2/fzk9xe4fAfIBHFg4hDVvRs4TRa8WIslrVRAF7YDoU4UBuSGmKL+cX69oLIOBVbIgt6FEj6qUwE32v1PZV1WGzZQmtbdPzUEAQQWdcE2hWy1c2Yvj39TS3YBOIQttcshv5miszQGwvAgidHTORE9vwPj31HKgMvunr8C9btFmXlZrIseaMqvfiS/t1tIlUrZ75+b8q4/p1I19qX6NUjpS9db3s+z16xNb0od3DAOI/Lns2JaG01hbSUqBA+jc2XjVa+TXiofxjI3mQ==,iv:L6j9C7wxEuTCmdntiVqI/t/264lKTXWTfjON4wOiK0E=,tag:cEeD7syj1cBgbHRIup8owQ==,type:str]
        extraArgs:
            listen-metrics-urls: http://0.0.0.0:2381
        advertisedSubnets:
            - 172.16.11.0/24
    coreDNS:
        disabled: true
    allowSchedulingOnMasters: true
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSAvUHRMTHcreGYwT0lXL0pS
            QkRvUzJTNHZlbVBaRzBxbzNCcFRVdFN1ZmxFCit6djNTd0tyN0I0Wkp5YytNUkUz
            a3ZmU3FBV0hzdU9CMURoZXdaY3RaZFUKLS0tIHgzSDZaUjZpR3Zycm1ySHRMbWx4
            elpFQktsTnZpRlZYUWx2aldMU2poQmcK0xPFCOvmL3CIPuubp3EQpnaED3f7iJet
            W4042mANno9hPj5rJnn4YMuzbicqZ8Pn8rhNGU8ZdFC+7iNZLP+SSw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-08-20T04:17:51Z"
    mac: ENC[AES256_GCM,data:9OmFRzrTKevDKXTwqTGLsZL8yHOsFuxp94aInNi/Si7xuFq/D48JRAxF89Xum9K980o+YGXgIwtPXZZlR18p0iat4JVaMK+9R/U2f93Y9coup8iRU3NeHIuf0EaXHzCGrIo1uh/UNYxAou6CaAI9pbjx9i00ATYUK6OHb2isGHQ=,iv:S5YlYFNO4u+3MaVgXcJlGbe7NsXVQr8Pfw5pKbNrU7w=,tag:WSbQBo4y8DwsPJjghaesnw==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.8.1
