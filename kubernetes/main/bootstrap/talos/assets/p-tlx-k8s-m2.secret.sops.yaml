version: v1alpha1
debug: false
persist: true
machine:
  type: controlplane
  token: ENC[AES256_GCM,data:azGL6+5AaARLQ5/g59qtzGOKKAQrd30=,iv:PuC/zyn2QthIygEZ4YL5Vntn6hGXDI/uWdHDnMGl284=,tag:pszN7WpghHaWf9eXzCQkng==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:hqxit79yyb8qP5I3xwtcdP8ZgZlLTIoJGzAxf3yynUbGMv/2fmGZWsJzlRknojHwAFx5zxDWcBojrAeosclXqsWL9RAYl1/fAZxCKTmOYpKX2euDIPc5vfTdBlK/NmkJY5xhlwo17egcgAg/D9+eQYJF1iMdv+tIVcOSD1Zg8stLjF/XyMJ0RVuhYGY1GoDeDLF+ZAWFvhER7AQ5Yzwt/JQpJ+qglVNOuXRq1zV320NSPfi4n4zZGrhqQMuk5j+yniBc6EjbJPszJ2TJ+lo3obtIOEGHxhkJwPy+pyUMeDNTyqHI5OuB4UgvgPGd7uUme4I2W0v2JhZAA6/FWmziRSeco0YYFPl9PT0iXEcYS7VA8S4OJe6TMrxg9MQRuctjUvRse3a17HyL4yoIpzS1eA3Cgk+I6hhD3OjWt3UbiQcCkmvbb2G1980gtGMXgdw6GF9MKn5fAspEn5uwvQT01GjpTZ4IcQtPszxI1mZ5gV6xQbW0Daw4Dkn4W/zvn0XmIkLW1Oxj4qG7mUvm1uc4BtpQTd5fiBbJawYE0uMMJ/E8++MkEyGCkL4moiKGt1XusDhk8iMQCZeNBhUU7VUjYj6Dz+o7D/BqqA7edCF8WlLRLczrbfhQH+5LoWdfZOX8p7kGqBRoh3RBRHDKnpfTBXvQoRLu7n1eJwk56J7V1Su8Wwo965SsJZB6u35tMcZL71s9GwaNn1VY7tAEHC0om7i6Gj65NEo37K/Jzk+xfsdoVvd+ZTV8jLjuXPnSMD/V9MNEKRRNObmkc42HKmG4V76sSBnO1kdZc0wMBsUGrGnmFCqO4c29f/rlmPWt6OnW6ATr3CW+jS53xH2ch7fh//ZS6DCZwYufterCpHSlRz0Uil6q,iv:8Frl3eoZsW4xMaXouxQYii3BSGFCg2sk4DDSCZayIks=,tag:Re8b0IKeboRa6DtYi1NS2Q==,type:str]
    key: ENC[AES256_GCM,data:FJCHs6aZBUJpSy2uk1cdJW6tQo2sqLjZZAUYUd5pxnhWAj2bQbp4zLsaTzai/zuUuJgZ0gENzzHtvBXZK/W1FXLjKD6aOaRH4fKHpB8IVQMQ1ZSv/bKwQWAJ8FdKAvG7p+Zw8NFGwOvcxCvlPJFpwTUOUH3V5pIp78bxHgOAZVpGWuHL2FweDD2CDc1HkWTb1wZJup2mS0B8OrsDRvJi/4v0wKZTrPup++BO29taZV2JO//X,iv:42vuYkdnZ53qymuQ9ol8S4yHOptIz6JJrM/x4f3ckWA=,tag:6bVR+u0m+WR6QBnm5vCbSw==,type:str]
  certSANs:
    - 172.16.11.20
    - 127.0.0.1
  kubelet:
    image: ghcr.io/siderolabs/kubelet:v1.30.3
    extraArgs:
      rotate-server-certificates: "true"
    extraMounts:
      - destination: /var/openebs/local
        type: bind
        source: /var/openebs/local
        options:
          - bind
          - rshared
          - rw
    defaultRuntimeSeccompProfileEnabled: true
    nodeIP:
      validSubnets:
        - 172.16.11.0/24
    disableManifestsDirectory: true
  network:
    hostname: p-tlx-k8s-m2.monosense.io
    interfaces:
      - interface: eth0
        ignore: true
      - interface: bond0
        bond:
          interfaces: []
          deviceSelectors:
            - hardwareAddr: ec:0d:9a:00:27:90
            - hardwareAddr: ec:0d:9a:00:27:91
          mode: active-backup
          miimon: 100
        mtu: 9000
        dhcp: true
        vip:
          ip: 172.16.11.20
    nameservers:
      - 172.16.11.9
      - 172.16.11.11
    extraHostEntries:
      - ip: 172.16.11.20
        aliases:
          - k8s.monosense.io
          - main.monosense.io
    disableSearchDomain: true
  install:
    disk: /dev/sda
    extraKernelArgs:
      - net.ifnames=0
      - mitigations=off
      - module_blacklist=e1000e
      - talos.logging.kernel=udp://vector.monosense.io:6001/
    image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
    wipe: false
  files:
    - content: |-
        [plugins]
          [plugins."io.containerd.grpc.v1.cri"]
            enable_unprivileged_ports = true
            enable_unprivileged_icmp = true
          [plugins."io.containerd.grpc.v1.cri".containerd]
            discard_unpacked_layers = false
          [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
            discard_unpacked_layers = false
      permissions: 0
      path: /etc/cri/conf.d/20-customization.part
      op: create
    - content: |-
        [ NFSMount_Global_Options ]
        nfsvers=4.2
        hard=True
        noatime=True
        nodiratime=True
        rsize=131072
        wsize=131072
        nconnect=8
      permissions: 420
      path: /etc/nfsmount.conf
      op: overwrite
  time:
    disabled: false
    servers:
      - 172.16.11.254
      - 172.16.11.9
      - 172.16.11.11
  sysctls:
    fs.inotify.max_user_instances: "8192"
    fs.inotify.max_user_watches: "1048576"
    kernel.randomize_va_space: "0"
    net.core.netdev_max_backlog: "30000"
    net.core.rmem_max: "67108864"
    net.core.wmem_max: "67108864"
    net.ipv4.tcp_rmem: 4096 87380 33554432
    net.ipv4.tcp_tw_reuse: "1"
    net.ipv4.tcp_window_scaling: "1"
    net.ipv4.tcp_wmem: 4096 65536 33554432
  features:
    rbac: true
    stableHostname: true
    kubernetesTalosAPIAccess:
      enabled: true
      allowedRoles:
        - os:admin
      allowedKubernetesNamespaces:
        - system-upgrade
    apidCheckExtKeyUsage: true
    diskQuotaSupport: true
    kubePrism:
      enabled: true
      port: 7445
    hostDNS:
      enabled: true
      forwardKubeDNSToHost: false
      resolveMemberNames: true
  logging:
    destinations:
      - endpoint: udp://vector.monosense.io:6002
        format: json_lines
  nodeLabels:
    topology.kubernetes.io/region: main
    topology.kubernetes.io/zone: m
cluster:
  id: ENC[AES256_GCM,data:fD5+V1Z8KY29ldeq8RGuLTI/tmZdjzrqbF6rS8xykVTk5myGD10idGu1DrY=,iv:FlSd/t/KsfsdRxhip3Ot+S5UyGM4TIUUPW8d0gg1axk=,tag:vMMOpSk1erOkR+d7EIiwRQ==,type:str]
  secret: ENC[AES256_GCM,data:FXadHLFGGV2MAZESaamDigiZUTa8V3eb3S41zBXu/PoPYhopV/MZ8zLciKM=,iv:PxEciALx2UtCRDMP8YrEAafDRAwRaG8Gh7/3rESJN0w=,tag:3bXAtSiJm4cCPAo/RDs4pQ==,type:str]
  controlPlane:
    endpoint: https://k8s.monosense.io:6443
  clusterName: main
  network:
    cni:
      name: none
    dnsDomain: cluster.local
    podSubnets:
      - 10.42.0.0/16
    serviceSubnets:
      - 10.43.0.0/16
  token: ENC[AES256_GCM,data:CLmwzxBLcYhJJWL4PAAhVg3A5+IrakA=,iv:kL75V1NisagNSaxL1UMV85jPpdRDFcfmf9AXzbFAbRg=,tag:5vXivbBQYyWl/gN7bI8pcA==,type:str]
  secretboxEncryptionSecret: ENC[AES256_GCM,data:V3OVi9s80Sw2AulwtYxzlb6W7piOZYQM3WFfteZ2aP5wzDet2/BSQsBvQFw=,iv:nvTcJ+mhO0aL4C+4yvh0oWfeFAVNrYD7fNBkPmpnBIc=,tag:G4baTCdHqRhJ5l/GYTB6Ig==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:X+cSKUv7XMAjlzTzxgwKjaPVhph3V6SU4qZPJ/TPZ52gRDi4zMU0lRTxbQU1iRl3ruQ4g33UZ0Uw5M0JdowZwLzNGh7kbWYKPzWvjBG8g7aZ+Nu1N2Lw1QjSOm5YykZF+UBz13tTPSt0v1mMIMhxPIHJQBO2Qk21C5y22NtraenM23slT8Qgst1fHnRYAyYppnH3XsO5xs7SeQhXUx/NPoIICH81QvQNsQjNpvmARLrfIibkOpX+mksanUqsajjrOCja6CORRGvaW+5gz74prqc7g3vaT8sQKX0QWySQVdkyUBlkd9KgrkDli3bpQp8072S4UHEousGvrP7oPm4wrfYkKVsU3/EPLLkJVP+unQPGKhPrYVoZrQ3gaJ1SVSowlRZzKsXjKHwwlxfvLT6iWD3kexAyYrOSAmpHhFM/o7mdsR9JstZQ2GqAaXVnNoWnewMrSwszF+9stIuurUblUwzLF9auV6Tse0DckmYkS3CEyY7tNiPTtb8oXhGBchiKp29C1Kp+bSRxf/WqWCPnLdrRJWcss3xluZC0snIUOWbvz5hKWEpiN/m5/zBFDOEUj5Abd4v1k1UKGI2tiuTaNJsYiO+H14ayShU3mcibsrJF5JJv/p4eCK1Mn2aLzjqLQzoCQ8HchHdGcLMtpPgpKtRef9AJj6nc0wd8bkwDMAAA7P3r0Vl0wU9BKuD60NTBYGVl1zTxhtS2p++kodXLDIR3lrRGnFeyj0WOLtUVInl7bgiqck4mrCvknTwGz5T8YIc2eCGvvawP7c4lQYRUGZJeAxtorY9ReEqW9ISmWfLp7smAHhJgQAqqrfeOP3qCdT33mpXSvhIXmkpp7/jMmI0VRVG3Pp4oybUzG5XaCBbq0FbQO8ar65KtD2spwCHdrwOpWLNflcTo6C8x7Mc2z6/LTJZ3yAjKQ2McT/tTdcb9avbkxKyGKuz3vABPgn6OKXFeTBrtTD1oU4Jo8MQX7vkRHFGRbfIk7U0M9i1hmUHhB+d/PET98Wq909LYwgvUPPK5NWsKL+4GfOI7TxL0NrBNxE+/RWkzEPYHHQ==,iv:c9S/6OQw/G+LSRPRqIWHqOChYd/ykL+d66EA+j71Wdg=,tag:ttID8uPz9gnu3FDwCzI6vQ==,type:str]
    key: ENC[AES256_GCM,data:0GqtRA0B8mHpZ9ksl22dJDS0KWe5TtlFp6S2nmktw2lUYTQ2TMFmZMKJI/nQU8Uz8jJMHM3iHy1+cVjI4WYyDS+g4kVOOSuwFfjotJN4PBU6lQMi+5Dpmx6ruywXkvUpdEi8sYxfnpDF7DYmCZHN1/HVbxVZXAL1P9HWiA0glQfoFp7Z3a2qToqiNAhpLgMAlxbRblFivVwl66DW/KDTEJpU9rfM1YwOtwmFE6l789NFYfxfUOyvPZ1zcvYURJzm1e2bDkPjATsjlTbIfR47SIclvH2bthtVkV4wubE4vkGEaxrbsEPJKw7TdWMztSyITs8wWdbtU3zZjdPXFlxMSuvAujPeVto3flxFACk7bCKPCyvsHI3TCqJ4a3ROCWqSBvpY0xCgffl2Y0OuQ1so/Q==,iv:KxKeVXhBWFIPB8zDP0e2QzPRLpQY6HN8eLowAjXOi7g=,tag:QD8XgC/S9a8pj+PaTUOAAQ==,type:str]
  aggregatorCA:
    crt: ENC[AES256_GCM,data:LNI50tklabYM2P5GcUGpKSQ08oUTBSCWGZI4DFFXSEv6Ouk3xN0x/eibH18TVp1KCMtndFJ+pFq94ephA7RZO7uBeoDrOaWneY3+WV9epPMhgn+J2u817WAqwOYHL2fanelUhitwr61tT5hcviOj0L6js1NcMEP5j2M6GqXBxQSWrO2iVEfHh0Jklub40abXG1EKDZJLMwLMhvmbtbeDHBwGzcThiEfCG/Es59TfURQC0jjDqMvWeMYpIrL0X36tr4AsnE7NjBcJx4VAg0zoiiAR33xVBJ0MWTDEHETTlo/TbS94rW8pgnpis0N90D4KpPBtV8Vr+3ckcnX5qFHjg3AFp8fDKU3w3IlCRR7sO5S/KPVXayyr7i7u3EcqS82Ij24mD2KoBLSsk6Jq/o4SHNwQYaUBtWl3EDEk+RtZ3LvBg+0M8VnmnPCFL/dr5P/cPsRDSLyCLNbOaM7rNs0+PMttJ7ddpG1dmUXmgz8JUosYfRyvnr9iWeGfqQdsjnR68fN/vqNMizaZWHAs51xF+i/7vBf+q8qmIfWPxqIFSAV9GQpjHyWC3pmUi9CseW8vMS0HnoqczXUvRP8Whtrtn942HhL2EGxAZu3s3ubXbLsieVcYRDi48kpIOg34OKkh4WEwvcJVsh7Mask00MAO1zENAD2tN/6HiT+w1tIdL31bgwbbMgAEU6tCu7/ReF/uwSsg/QVbue7M26vQiM9v/OA06iFYj2/05m6FrnLwvRabkLNmXVO63Hcr2/6tc9diR+ruI/itA600JysDHEy0NZ3JXe568HmCX3evHIOKLjOgoc5HW/Qql5EJlvfF5BhgA1vdsxGKi9lCReIPe20zj8uiH8YdUlDe+7YP4mmGUNOO1QIV2fnlCiQE1iDZawPhPUfy+sse6TvkPzprgid6ivOZClkzQDtmX0SxzNZY7rAXZto60zwllzoL4sadoEmz,iv:ylaQOSGQW9BO3pJCOYg8VAqd80k2wllT+V6G2EKDRLM=,tag:/BVBautgIlN6c7zKHL3+DA==,type:str]
    key: ENC[AES256_GCM,data:rT5YNrEx4ONyUF5dx5zlo2l19ISev5MWl3iPGvFC+GXkXkhOzp9fLpmLFN5lDspYRLAt9tCRoWSUGubCzqIAyOQyMhz8MlFaYIpAtd3ElMRLvMkh316s8BlelfD4jcZgQ0RmzYm5prQO9uxsSONakEt+Qp0C9HjEz/moBUv/isr0YiOmT3ulAiGkao3ezvs9EyMIoGjZzk4EG8hACskLtNo+j8Trd588goHVBNaFQZLS/c89G7fs6B+9HwxNvoHfK83cW14x63RPh4dQxXzCSpT8gNEpfi3mu3AoNvzZZnHn0FqtspznDX6apIJREiCAiHXpcBiHwJU27g6RSDQVEgNO5u2QNcYBnKNBRA5mt4chAJXPpZlZgPfk8Yhx4P524QnNIk+F5nYTGoDvsfAICg==,iv:izdFY+NnAcyvpcsIhaiwiPkhT0SjPxdylNqQomxbCwQ=,tag:VtbUEmYf/9mza8xdSFh7fQ==,type:str]
  serviceAccount:
    key: ENC[AES256_GCM,data:uaWLlK//xlGFVQWEmAsSmnb2BzI8ZLpHDex0B94clDwq9cfYA8VKLQ6+DxuF18Oo13PGmixqk/7BN+vsdF4+G0aoNc8Q66z+bCWp3of0pKNf+QHEJ1HkNnT35JUpzh9ispttJzc+xQf9oLnUVt0mEkY2yokS9R9e87usowd+vyx23CSPL7qinun3RxOPQpI08mhGgliCMHZtYZV2B9GTB/N5GGxnLKTtg0KiTnQw+WkUbH+d3E+fgXztcJc1/ccs7AT3lsNiXsVRk+dmNr0cGt/epnnDL1VfUOVkE6if7e0nlRpHr0scOy7CrJJvoPC9vbvXxOGXJMiSuUHOac2Bk6C3G4NSXsdYmZ78doJyIGOGm9tvHg4CEmRILwflD+Fn1rRY04LpWBROt3oSiDEjlg==,iv:i1SdykavEqFTKgOBrFTd38MHghYKlf0XbKUUL2UTL5c=,tag:Yh6jcxpBtBwBTsW0I8tuag==,type:str]
  apiServer:
    image: registry.k8s.io/kube-apiserver:v1.30.3
    certSANs:
      - k8s.monosense.io
      - 172.16.11.20
      - 127.0.0.1
    disablePodSecurityPolicy: true
    auditPolicy:
      apiVersion: audit.k8s.io/v1
      kind: Policy
      rules:
        - level: Metadata
  controllerManager:
    image: registry.k8s.io/kube-controller-manager:v1.30.3
    extraArgs:
      bind-address: 0.0.0.0
  proxy:
    disabled: true
    image: registry.k8s.io/kube-proxy:v1.30.3
  scheduler:
    image: registry.k8s.io/kube-scheduler:v1.30.3
    extraArgs:
      bind-address: 0.0.0.0
  discovery:
    enabled: true
    registries:
      kubernetes:
        disabled: false
      service:
        disabled: false
  etcd:
    ca:
      crt: ENC[AES256_GCM,data:3DHfNtvNzwpIdb3LYHa3pyr6ukz9DoPkLtdkFW4KjSFe2sgnpQaPLM0Omt05gkJaYlW7cYh+FRF+FdKC58Q2qtTgbMo3rG7dCpAo5u2vHJ4BNa7I4sN2Qms/78VnxBhCv3WHjAdpZnwK1O+iYzHuLkuCJad/eBYG9F8nAEWv+G8ZnrnEbFG3Sal8+XPPhs3CFPTNFtPbmyP59Elqwj5UvGffBNJuocBBiFhoLz3kg7ZxbD/pEgx44AqaN///P6shv7rSP3aplPdbVILCeIRYbvV0MmuygdA5txXBk/u0v8eX95XlXfEQIKw/rMZR1jyokT/5Cs7DZut8c5XAOaeDBvq0mq78kYrGqnYtePwO61jad7VZdiSrPEo/2uDaEzGHA4OfXkXcW3BrVILTvnqsY8OrNnh4Z3OM8zLQqVZSCRRnMI/6DT2P+e4qkHc/VuAKV4xPGMYe/kNcSrmo1yPvuM3heApnyJ4nIdODersavRv466B2t9q/2cob0bJbxpHjhXCPPZVKHEQpvdhG5yFqVwSJCJTi8TEVrKcRb/Nnlbc1ZCLUfwjX1uEaVhnoqPZ2qegNlaGR5rbijEljV/cg4ViAZ90s2FLY/NzzZTv6hLXIDm4Q0AyZbaKPHBvNeq/R3ZrWCRl3LDWpUWhCiQ8CCUjGkH7xgfziHgQ4OkJLuv8MAVqb5EAyDILpGuxDzyvVbgVQl9cpzT2x88WGvM1P4cqvRtWacRWYX0HxrWauRGjIa4blRAe08j/3eWhfCS0MXV7Iik6Y7nmydVdE0gnN/mZuhD41avNMviS5G2pf+lRJaypfQX9wT8wdvc0pA61XkrHVFJLiyb9nr6Qam9mqpHuVHkSOC9bfP+qrFww+9oCBoSytdGAycDfC9HTH5sl8Mo5CSwBFw/STi2TwUswHNKf/7KtTxPam7fe7YbyQVoHnp7l6YJcm5L7vNEqNlGqP2mk6EWFnUoMBDUkUKmfU7a5ZZHeVcsUFWbMpQHCTuJOknkDObRU5f5zSB0sxCW66zX96dw==,iv:xrTehBTEBpKN7jZGwlfn5wu9tNmK5rVdMOYRjJFkz1M=,tag:ClE2bRrMsnBhahhH+ECUAg==,type:str]
      key: ENC[AES256_GCM,data:ng1tffXQ0DLt3ULqo2Sov0biIp798tR63mmeMuN+D8zxSpGr6Cq4WcmxyJ4kgAWDRBGF7qrOjy/DGDv/m3fKBCFORqSKxyzyPH4OLD6bwYckrBCFdlqZ6bplhyAd6Z5mHn6qrOZHKPZXAzRESZXIM9EJIrhn7Hj0tgl4qe8z1JPeDrrYuO2M/Y7JfeDjbgx2dbYxmI+F2kkvm03/p13yQo35zu58yXX3yORBUN6H3YGmCAD/+MSG5YPcnUfVlLu1zho50F9O860llw74TSnoC43XlW/thooXjBP0MppRnNMJvtasttHxz8uLXRqejrdSdX7wT14A7PcrraTKmw4BuWiGT8VA21VemVl+i98MFGytgFu+vHstKlTA2JIR0WM2VgN5SwEIDSS8sfT6YErcHw==,iv:TS2uIhlZ8ZngpWrNTLt0DcIXN2hXPPsUGZU1lscVMC0=,tag:gCVcPeAGopXmpYJXymE9CA==,type:str]
    extraArgs:
      listen-metrics-urls: http://0.0.0.0:2381
    advertisedSubnets:
      - 172.16.11.0/24
  coreDNS:
    disabled: true
  allowSchedulingOnMasters: true
sops:
  kms: []
  gcp_kms: []
  azure_kv: []
  hc_vault: []
  age:
    - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
      enc: |
        -----BEGIN AGE ENCRYPTED FILE-----
        YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBjKy9xQ0k1dm9JS1h0U0dG
        cjY3VUVEMUlDOWxxTnBNNTFTelkxQWlUamxjCjJ1dnM0c2Z4eFEzZEhERXJJbnJH
        eEU1eEpISnNiSTh2NDJnNEdpZ3M2dHMKLS0tIHJ6REhRNld6WmZpRmk1aXN6bnFp
        OGtuRnlWYU9mU2l6ZC8vd053MUNDQWcKoZzOYYCleQ+LuLV47CgQpasmJ88y9vwp
        5RsoUUQPyRg1RWjX1vVub6cTYcvlUNPHv8aZ6TXlfrXx/iJA/P3erQ==
        -----END AGE ENCRYPTED FILE-----
  lastmodified: "2024-08-19T12:36:17Z"
  mac: ENC[AES256_GCM,data:fFeoG8urH4scnT95L53wrhf5hl5FlbssDywY6v6ZKtrR9eNn+tkO4sXIDfOqYF80FbdYLwDZocUCAEdTO3jWq02XUm6/W3p+1Q8lQhrb6Nr4XIogXv0gEeScR6c9DZat9Q4n3P8fRxpabuzsLt+tfGhxMvU/Cjcw5UjDH4MKqdU=,iv:jH+ck8We1PeAF/Eh58/FFM4P9G1L6pUi/R3x0ellNg8=,tag:ps8433FovEnE+k0EHr29Gg==,type:str]
  pgp: []
  encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
  version: 3.9.0
