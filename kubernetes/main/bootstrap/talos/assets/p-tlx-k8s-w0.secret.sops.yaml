version: v1alpha1
debug: false
persist: true
machine:
    type: worker
    token: ENC[AES256_GCM,data:Au9zdDWn20P/s+FAYGNk7ezxlM2aVuY=,iv:dYhp6qfen0H+b8MgUf3gRNFdn7feviQLCyivQqPKM0c=,tag:wPY/bDB4BpmxYKdxPxvhHw==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:w3pAl0tXjk3FNFRp2vhfVvKAGDnyWO/PQYURoSzF5tLEaKaW3n0j/SwHl0hHhQU79W3QJQmUc9AzLPZxsxt9lS5l2PAShor9a+C/FN2V1JNPuEotHigB9v9O2PXKxuwB/ZToENQXxHa3Q0MpTgiaKYrdFcDVxFGjFDtsuwRtyEmY1vzvIEillC701FfxF3bI/mq0TlPEyUY6Jfg10hBVQHjE5Uf/X23H7W2kEgxFLwmh3KEiAYQGs1HKLHkoJqU4v0nbLXH9u5bKgogvLYXVtMJBqsh+5ewuNEU8/IxRBQBvXuBbTV4GVM88BDb5Lr42pSDs5L8JkqRy9VZdK1HAKFkRFzaXV0O0MfQSN1u7vwRgzQimuk3qOzXRxjZNt1HGG1FOnp1yKw/HeGC7oV3BxzgJipCHRaruDEprzgXSMh9ZUFlVbqBSMcSM8NpgIJeX8i7cU+STrQmnY7kGpF99xMPIis+UPkeIRrQYXmapetrrLmjuz+lpajw6j0J9RubkdzsulXlkz88WXCUrxqWLi2eciG1Ctn5IWPtA7DujJbQT8Qt6e3JaGemGNxl2Fde8ChY0upZBPc694swC2ejycrXU8Qvd4dCoZtuSyILoQ8r5kFY1V/A//iCQDOM6PXLz7BNLxaL2sDymTIn+HqxLZIXMZ73AQ2YJHPQIUT/ubwIYHaPjW2MmOYqW5Vujo7Dwo3xNEV6A7iXTvf6PBFd3CUkeHJyUY5DRon3eGowFiJvGXpjYmesiT/jRgZzvVfvU2PJgJNwHL6sJe/2VQY/9D9brR1DGcQeKx/+6cfVwxN7RdwA2JVNUo9+bXeJbv5SJ/BLULj1Y4NLpXNa4vd/9yD6MQnGNaxic1CPnywmcT9se+2eT,iv:alCRrvh2HrPnrIPa3UaktZEtut3rR/nRA1Gca1TTm2c=,tag:AcCP9r7NCnuS7wyibZ+uPA==,type:str]
        key: ""
    certSANs:
        - 172.16.11.20
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.30.3
        extraArgs:
            rotate-server-certificates: "true"
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        hostname: p-tlx-k8s-w0.monosense.io
        interfaces:
            - interface: eth0
              ignore: true
            - interface: bond0
              bond:
                interfaces: []
                deviceSelectors:
                    - hardwareAddr: 7c:fe:90:a2:c5:90
                    - hardwareAddr: 7c:fe:90:a2:c5:91
                mode: active-backup
                miimon: 100
              mtu: 9000
              dhcp: true
        nameservers:
            - 172.16.11.9
            - 172.16.11.11
        extraHostEntries:
            - ip: 172.16.11.20
              aliases:
                - k8s.monosense.io
                - main.monosense.io
        disableSearchDomain: true
    install:
        disk: /dev/sda
        extraKernelArgs:
            - net.ifnames=0
            - mitigations=off
            - module_blacklist=e1000e
            - talos.logging.kernel=udp://vector.monosense.io:6001/
        image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.11.254
            - 172.16.11.9
            - 172.16.11.11
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "1048576"
        kernel.randomize_va_space: "0"
        net.core.netdev_max_backlog: "30000"
        net.core.rmem_max: "67108864"
        net.core.wmem_max: "67108864"
        net.ipv4.tcp_rmem: 4096 87380 33554432
        net.ipv4.tcp_tw_reuse: "1"
        net.ipv4.tcp_window_scaling: "1"
        net.ipv4.tcp_wmem: 4096 65536 33554432
    features:
        rbac: true
        stableHostname: true
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
            forwardKubeDNSToHost: false
            resolveMemberNames: true
    logging:
        destinations:
            - endpoint: udp://vector.monosense.io:6002
              format: json_lines
    nodeLabels:
        topology.kubernetes.io/region: main
        topology.kubernetes.io/zone: w
cluster:
    id: ENC[AES256_GCM,data:6MdL7elpQT+iAiS2qOa/lkhuKMYecHpReTlBFExTfwfrEkqf8VvwYfJVF6I=,iv:wTiaEkA3Zn3c8pdiLkQAz+rPOgaH2IiS2UHsLl1ghV8=,tag:wcQ+G3ckwtAahqKrX1ki6A==,type:str]
    secret: ENC[AES256_GCM,data:kRYL2VWn+2g2RebueTGTDyWCcuKuLpr7MMADCRb13BYW1krmMQckwHNJJd4=,iv:zTEnAjxokp/9WmCP5bPumR9rU8nY7nULfPuuOJiwWBA=,tag:uoIZm7OFpN3Ux+SJQSFQdA==,type:str]
    controlPlane:
        endpoint: https://k8s.monosense.io:6443
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.42.0.0/16
        serviceSubnets:
            - 10.43.0.0/16
    token: ENC[AES256_GCM,data:4Bp7Kf4pPmNaG8Q8PEA/+1FKU5uvIRA=,iv:/pB9/bcuA2qGNk4tUOkHbebKxUWcmaCmbVFjz2rjCkM=,tag:Bn35ephkCyAW/iivrK7Ijg==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:tHu7YDE7l099OkSxCEWigIg0GBaPqs9qwojpuuw84ryQtE+Nw8spBYYU2GKBiYetsYO4VSrMn9ycM4J+5bJ3fvOcWKRE1rZoGcA5WRtQeu1hfu/eJpqWpkvL7JdwYJs1B1n9uHnFRh6fOAyM4i4/IdJPKv8VvKfFoEx9Pqpob/AEEgP5AnI05h5ovLGKwd4jDxtUcgIwXatGW9gfOWGuIwJE/ug+iB1BgV4ANaOnN/aQPP/iPd1Jvb6ttYX7639nV4sxochyw8FN9wjFkVxBPOHsZf9l5iAyvq5nhhSNXYwjUJhyvAxFXJUwKrgyUXhT2vT+3EvnfiCJKqe+WnaE2dETL8RRarOZqCsFw6mfoyi595bvS26raJQiIOsJIuE0Btoosa0Ck7FGsL3YqEwq1IBdkfRiqqcTm+toraevdVDN86ub0QPsSww2CqEj5gxV0/ZuO1e6QNI7f2al+yN8/ObtivYLs42xbJk06bF+QVxDmyF6Xo2pZpp0WPucKDwvfMmNhRVx3SkeHC4KLuKUO/5bDJ4X0EkVx8TjiUAl2cLzsqHJgb4Im9zWZHPNkKI6Jer3YDMEfb2Qh4qARRdONmSO0nRE7xhXyP6cgxrdtyaZwRL7Imx/ZHhYVqxhdOZQqffGOA34hzmZXpdscOjqciakGG1ZfBHNSoPOkz4eh7U2aMr14n0fy2gO7Hc5zXPevVea72sywfbm0f0/VJ24YMDFVJfc5JOuWahSmrMDBLtle/DOvw9sB9Tcxx/ZN6BXdu/bjYw9F4ztrOi3a4JmcluJnmLB5LPr60u6P6Q2xCuMUUIcFY/9EFqdjO/5yUzNfrXf96AMUnxBmgEGKmsK2fpdK93LKSfEr9Lf0ptmrHWCN7KiJNMiQUnUOvbzADL1+tMaY1VlUAMOX9HtlYQE04Og1VMBvhIZcqEb6i92E4FR8Y6DZzU6+bZY/+6ev0p8vEMR5JRGad616zT4ZKhamugPZb2+JxENNJZbUbBLyxOsb4LbgDf+NRDZzaIM+ejSP48Q/GFefUtZPGLLYwtKb6xZ3s3Ao4Ga0A6v6w==,iv:iTPilTtuJgA6afIZYg1GYKqOVlAzda301DDZ0R4dOzQ=,tag:uGOs56QSRepaeiIbK37wVw==,type:str]
        key: ""
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBwRFNxL0hKNXFxNytEaWkx
            QkJ3MkJ5TmdtSjdCdk9taFlqUlZ1UkFtRnl3ClpCb2YxL1ZDaXhmdlBlbUVsdFcr
            TXEreGxZRVRYdG9DNHlJUGk0bzVRK2MKLS0tIGEwNkZIR005M2ZpbXVtTTVIS0Jk
            TERLV0NJaE9vbTE5TmNRa2ZDRVEvU3MK0V9syi8/cYBybBorWG1h4BuX8S1DzUlR
            AB7wWdjVBeZK98Kb0EMpLr77g5NMH/pumlYXpVkNjIem1f61iuhUzA==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-08-20T04:17:51Z"
    mac: ENC[AES256_GCM,data:5kAGaSY8CLfyzpySqtiDWxCQNdc/xKxGAwgl7JodNQjZ+V0W2pQSLD2aZWiZbA3B/VdgejkMw9z+jvmASWAOLiUl+WvSx4fosM1rjkbfDlPIHc8+aerLCeipXUBrtIStPz9i7HiLpkmF2dOz02N2xDjjj+7676YgLarROkQRlTI=,iv:s5F0+ACKOJH9gu08znlDFq5er5VREFKG61WIINiO+KI=,tag:bxBDrD/yeVy3IWaZWZ7v3w==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.8.1
