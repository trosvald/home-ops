version: v1alpha1
debug: false
persist: true
machine:
  type: worker
  token: ENC[AES256_GCM,data:My96qECKVZhZFXwR6Y9bht9YQSPJTtA=,iv:Kg+tR5V0uXHtnRw8evXDBAFQXCHHns6ojR4u9pxnuyo=,tag:4SUFwqTtKgFYnpmjtlAdFw==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:lnQBmHI2phfBgafDnO+y//CvKT0fUKfZuKtL5/nf/w3JGapwx+FuweUBnX6VQ2KwDwPafnVbAJG/hM8TW6JSvlUuNeC8b9MDvUq2GVZl6fqf+EMFmgEuaWGCV0FTP/zmJVxFeuj8XUzVYT0++3QIz+EwoUElbVTxDYcbUddtE8OuP/dhMKmrK09X+tpksa9wwLwYTzU6PUMvRzlhUfu3C41ioKtKnz4W5DKbQyVGKMhTr3S1e0swBVG/QYjEr8Wpuc9QoWr0sF2UeRyyzv80lLxlnCAeyKr+6seLaN9PZ6WojTx4sX9zjgWI2qFK5YyOnsEjHFkoZ+O1kQT7RGNOktbkERNhnqQUO6agECIDPQ3wj8GP9FRG5WWkN7/LtU8CRyMz5DrQOJMmkR6EMsT/UVPrgRs5uhHtA85W5NkUxKoMj5mXr1/XYcURhnPZ5wmeupDVL2SJGZ0L7wdOKYPq3BQ51GOfU2E3MsUUURuGxBfGxwzmQNMYYnlr9g7UBSVPe/re/Mm+I/tpSwaEU3kyhTbJkX+YPY6iqA0xW9hxz0gkHh9/tcpQ5a++3AvCQBiRSsiilGd6zux5vPN4hfJTPPCM0l3swaqUkWDbDn39YydBf8JyFwJwXpof15CQKYdpm/fNMAy1oQMs4TgdaI2VB9Y/uIJFaQnNVe1EMuRvC5XMycQfHBOpyVtMQdQH4CFhqkpXLwK1AjnQpdMmRBHqi2L2/avuCVMFfyoegCVVBIH/8rwrNqoHKiLu6cRMsAuL5m27AfeDlOAsMfC56inwrqdZvNX55+/p+pzfNxYFwZR6fZvc7vqcq0M5LMio0aM2LGY+53x1ZfyU4idE4EZ187nETmHl8xgRDiyBWkwR5OgOGCwJ,iv:hS78Q7HgxW39lNRR7VPQxy6TUzaEru0FbIBOOjegFRg=,tag:/uxrEa4dRvyrvKwhhXAmRw==,type:str]
    key: ""
  certSANs:
    - 172.16.11.20
    - 127.0.0.1
  kubelet:
    image: ghcr.io/siderolabs/kubelet:v1.30.3
    extraArgs:
      rotate-server-certificates: "true"
    extraMounts:
      - destination: /var/openebs/local
        type: bind
        source: /var/openebs/local
        options:
          - bind
          - rshared
          - rw
    defaultRuntimeSeccompProfileEnabled: true
    nodeIP:
      validSubnets:
        - 172.16.11.0/24
    disableManifestsDirectory: true
  network:
    hostname: p-tlx-k8s-w0.monosense.io
    interfaces:
      - interface: eth0
        ignore: true
      - interface: bond0
        bond:
          interfaces: []
          deviceSelectors:
            - hardwareAddr: 7c:fe:90:a2:c5:90
            - hardwareAddr: 7c:fe:90:a2:c5:91
          mode: active-backup
          miimon: 100
        mtu: 9000
        dhcp: true
    nameservers:
      - 172.16.11.9
      - 172.16.11.11
    extraHostEntries:
      - ip: 172.16.11.20
        aliases:
          - k8s.monosense.io
          - main.monosense.io
    disableSearchDomain: true
  install:
    disk: /dev/sda
    extraKernelArgs:
      - net.ifnames=0
      - mitigations=off
      - module_blacklist=e1000e
      - talos.logging.kernel=udp://vector.monosense.io:6001/
    image: factory.talos.dev/installer/43b764902da02dc235cdb9bd53b143114b6d7f0aed6d9e4dec656ea7c8de94c2:v1.7.6
    wipe: false
  files:
    - content: |-
        [plugins]
          [plugins."io.containerd.grpc.v1.cri"]
            enable_unprivileged_ports = true
            enable_unprivileged_icmp = true
          [plugins."io.containerd.grpc.v1.cri".containerd]
            discard_unpacked_layers = false
          [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
            discard_unpacked_layers = false
      permissions: 0
      path: /etc/cri/conf.d/20-customization.part
      op: create
    - content: |-
        [ NFSMount_Global_Options ]
        nfsvers=4.2
        hard=True
        noatime=True
        nodiratime=True
        rsize=131072
        wsize=131072
        nconnect=8
      permissions: 420
      path: /etc/nfsmount.conf
      op: overwrite
  time:
    disabled: false
    servers:
      - 172.16.11.254
      - 172.16.11.9
      - 172.16.11.11
  sysctls:
    fs.inotify.max_user_instances: "8192"
    fs.inotify.max_user_watches: "1048576"
    kernel.randomize_va_space: "0"
    net.core.netdev_max_backlog: "30000"
    net.core.rmem_max: "67108864"
    net.core.wmem_max: "67108864"
    net.ipv4.tcp_rmem: 4096 87380 33554432
    net.ipv4.tcp_tw_reuse: "1"
    net.ipv4.tcp_window_scaling: "1"
    net.ipv4.tcp_wmem: 4096 65536 33554432
  features:
    rbac: true
    stableHostname: true
    apidCheckExtKeyUsage: true
    diskQuotaSupport: true
    kubePrism:
      enabled: true
      port: 7445
    hostDNS:
      enabled: true
      forwardKubeDNSToHost: false
      resolveMemberNames: true
  logging:
    destinations:
      - endpoint: udp://vector.monosense.io:6002
        format: json_lines
  nodeLabels:
    topology.kubernetes.io/region: main
    topology.kubernetes.io/zone: w
cluster:
  id: ENC[AES256_GCM,data:YVl/AUQP0r3UErWLuCVdWsiTIHi+KjCIbFnrcA27oCUv16y/GsOibFkW+bQ=,iv:ILjMmfFxCexI0ilCDiLL0Iwk3e5W6Pu+7eMDMWXHFmE=,tag:V2NTqUPDboRO80wFd7IM4w==,type:str]
  secret: ENC[AES256_GCM,data:7PrGtNNPVH78aRFu49erY5BppSzfwOSBfmBIBkf+WKSJYVfR6G3YBoRcZ4A=,iv:jgnLDEfei+jELz14uwBCIkSSjVQKyXupeEqrUnnUy9U=,tag:DSpw4W4JEZCms+bac+hy7w==,type:str]
  controlPlane:
    endpoint: https://k8s.monosense.io:6443
  network:
    cni:
      name: none
    dnsDomain: cluster.local
    podSubnets:
      - 10.42.0.0/16
    serviceSubnets:
      - 10.43.0.0/16
  token: ENC[AES256_GCM,data:PZ0tdmi//F4I9gTkx7NcDb5HxTTWV5Q=,iv:ynB461eUWRmCNDAdNCTeGUPjiCHSFENL5oBrnValtfk=,tag:ThO/iim6pcM+fVA4Un4Zog==,type:str]
  ca:
    crt: ENC[AES256_GCM,data:f4f1EdhHTiOfm+mQ3F8plp13F9pZ6nBXwzfP1xm1VW2RYI8Hh4pmn77gQ7hD282phk+Dr5+XBVTZ8avK+rnqRMKk1uS+Y2r36AQYN2DsgnLrfG32zi+Q5iCNke70kBkwRrWZeZ6VmSwrsIzapi8feMMMCFYBBjdpgVGd9HhLkSTL6kLel23oIDGhQqGCm/G/xrh9qdwcmMdOM5D/I7VOZwavu4Cq+m05dlbw4+qWpehmkuRqD9QCl2S6bbx0aB75EkX1RCMmOZPQoJoWjmrYy2gNzDRRBJvEXXhcHdvGio3xk6HBYjAxkySo8tHbEPXwPWozSGiZ7zJ5FhRDb31IsCJRWnOFvVb1IHUx5svQlbjYcaKPrCUYMl8Y9zMALTK1MDJLQPpBcKN/4yd9v6+O5k5zY9xA1wDV1ASlbifY19sMswN5kE0qWR5Ck8hwCTenMdMKZ1CPoxFwUBZJC3h0XLhJQPs1KoUMVSvUHfvugQVZmMWWC46Vn6SyGAlAX64DPGf0Zr/3F1jq9eorhXVqiQ1Q1ryMAbqMd+Cr8NiGYpui+24SGJlYCzEp+rjEY5YKAXygSiku/pj7xUA49YFdBC13Ji+lMyd/1stMD6iA7bd5U4Gq6SCkYVR3dAbaQOAjIBVuC3TEjJU1HBDrR/DlzB/IIbUpoABMbe5I7NQsu4grH1S3GVrG79l3EoTRxp/9WnAg827OnXqHleGWXaC2i3rI6eWs22lu+NLDyk6EmqiD/lA87EAs8gOC5nX1EhA1XwXHuju8StK46D5WXnkZYXPuDF1/Mku4c76nDHKWMfzIciJBUggS/M0IkwUL9qvbf8v+XyBVJcbX4cCw4Wq0koQgjkObIKpkhf/Efcad6McTBSh6DZHWpoLnaNbZaUju1JdkLy1wpKoFXZ/qdpsWXhdjN7nYeZcplkvTtZx3af7Wx5Pb2Ro+u13frDPRJQW8rgbH4MDotiVkrctIndz/KRQunH0EoFReyZ0aecR+O5DAREByYx6ilRqE3se8Px9476MoteGL+4xjIwT6iWwu2fkYI66LQJMSSGy1xw==,iv:WKTSAL2/5eq+QAz5yG2k7zNq+CwwZg3oRCgYgRzfWxE=,tag:l+J24a2S+A0lXH6zdrvQ4A==,type:str]
    key: ""
  discovery:
    enabled: true
    registries:
      kubernetes:
        disabled: false
      service:
        disabled: false
sops:
  kms: []
  gcp_kms: []
  azure_kv: []
  hc_vault: []
  age:
    - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
      enc: |
        -----BEGIN AGE ENCRYPTED FILE-----
        YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSA4cFVyWThEbUtjY2dudXc4
        SnZOMk1HZ1ZzZTJleGR4ZmpQSWw4RXdIbnlVClYySjBueGJFaS9hTmxGZ1ExdHlt
        SGNzQ1JJTWx1OWhyREw2SU1jbEFETDgKLS0tICtQcStrenJCb1dvMzBpdFJTY2hH
        UnJ0RXhvT3RUcG9xMmJOZ1ZEUlRobU0Kh+2yro2pxOYFS6SEoD3h17LVLjw/RH4X
        kOJWhSt7RgpWkKCvCbeRLJbElU4mJyTdjXkT82Mu+rBikM1RTYCvBA==
        -----END AGE ENCRYPTED FILE-----
  lastmodified: "2024-08-19T12:36:17Z"
  mac: ENC[AES256_GCM,data:JHIMdil8ykS0Igv3LHkFLJz+3eJelDXFT6763lf1//JS09/tmK2dvVQuDiURDq70Gheatg65oKVFekqeXxv6DFQGLKIfYmO00bZcGIjKU80X8B2jnm3ya9o6YZ8TVNkRjPstnVRd9LgTPuDo57hjljA+/zIGbx7by7xFGL07hBI=,iv:LmeRcpsYUr/nV0tHwFmjR8y8B/s0tQCggLJ8AeIDS2c=,tag:2h3uxEhlxk4mbOnD51yoFg==,type:str]
  pgp: []
  encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
  version: 3.9.0
