version: v1alpha1
debug: false
persist: true
machine:
    type: worker
    token: ENC[AES256_GCM,data:cy5MCEUSTG2k+9SJrafgjkAkULbceY0=,iv:CpzYVB4mU7cyxv4ANA3aGhn8/+IFW2dMrad2JlYwBkA=,tag:cGQkVFP5xyKu5KB9Z0hrag==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:1e2hC1zBAUp/YBgp/jdJ5QCqUCn9LQzMgvw1BCA/jI70rroVU4Mll1hsZhUDsgRIs16l7EnVV6BYoxUKEI+MMjjye++fOKPrvdEQOkmOIC/u6xKn6vVX6PrRsxbggmxobB03HaAAd52nM8G46j/vjByS/IWLRHkpRI6a9cnOUDRFttPVIttBxY0ltoI1WxXzsb/rrIrSrj5F/0PxvsLhss1bKwKW23BW+5SATQXEH9+XYrgHwwgU6UphwhL/EHaZ1z0o2DBEyaCSM78Dx/QLEJNha9H4aTbpsWWkp00B+XQ+RrkZ1oncv6B0xPSqSmBKv6z01+YF8P/0zN2gBSRpsWidV1b4t6ARYRk/mvRr3UbaJiy2t7WTqWx75isSGSa963Qda8soXD25yfy5lTKOUyXn8BuqGHsREyQk/+Y9y+YaZzRvqWSyOEjBAeDa46gkDCA1KtE0Na0jPQGLKACuURzIYdiJ4ANue00vDcFj0hmSRx+uNQ2jgO7KmXt5zvcSsd8SZw/cnFWGCMDHC2WFsyH/aqlvW8Mu3NkIyV+lkizAfveR0skkYpOby03htEAEFoielrT4Ei/M3+sd29s76K3borNIZ8mmjkUoRcWbIQqu+o+U4dKWo0pjVSH8JQ0VxSjRHew5jm60ciaadLwlcukhJruNL3rFQGHxgJLXKyJE2SfL/1n+Niw/9SSoflN+cT6t7t2Lgcyb87bebX4n130LUueut6re43gffZmwnQjjGaBsNrMkW1T3+qtjU59C1Ru8dw5Q3Utc8R0evdGcnvrItkgeJD5u8ljCz+sX4P4GSankhsdmi31/ZgUWBZrXv4UeXpKtR7esG8FI7d8w27EsrxIR66VfT3QOCqyW39CnRewL,iv:DAXvuJp0rZ+ZjqlWtHt3T/LVBjvFRSti2R3J5orMOXc=,tag:YN2kygm8iMyVmAondMNSqA==,type:str]
        key: ""
    certSANs:
        - 172.16.11.20
        - 127.0.0.1
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.30.3
        extraArgs:
            rotate-server-certificates: "true"
        extraMounts:
            - destination: /var/openebs/local
              type: bind
              source: /var/openebs/local
              options:
                - bind
                - rshared
                - rw
        defaultRuntimeSeccompProfileEnabled: true
        nodeIP:
            validSubnets:
                - 172.16.11.0/24
        disableManifestsDirectory: true
    network:
        hostname: p-tlx-k8s-w0.monosense.io
        interfaces:
            - interface: eth0
              ignore: true
            - interface: bond0
              bond:
                interfaces: []
                deviceSelectors:
                    - hardwareAddr: 7c:fe:90:a2:c5:90
                    - hardwareAddr: 7c:fe:90:a2:c5:91
                mode: active-backup
                miimon: 100
              vlans:
                - routes: []
                  dhcp: true
                  vlanId: 1613
                  mtu: 1500
                  dhcpOptions:
                    routeMetric: 4096
                - routes: []
                  dhcp: true
                  vlanId: 1614
                  mtu: 1500
                  dhcpOptions:
                    routeMetric: 4096
              mtu: 9000
              dhcp: true
        nameservers:
            - 172.16.11.9
            - 172.16.11.11
        extraHostEntries:
            - ip: 172.16.11.20
              aliases:
                - k8s.monosense.io
        disableSearchDomain: true
    install:
        disk: /dev/sda
        extraKernelArgs:
            - net.ifnames=0
            - mitigations=off
            - module_blacklist=e1000e
            - talos.logging.kernel=udp://vector.monosense.io:6001/
        image: factory.talos.dev/installer/373392515ac3890a73d3b1f6cf23d4b96e20aef2dd5b42cb00bd73de1b0e07ff:v1.7.5
        wipe: false
    files:
        - content: |-
            [plugins]
              [plugins."io.containerd.grpc.v1.cri"]
                enable_unprivileged_ports = true
                enable_unprivileged_icmp = true
              [plugins."io.containerd.grpc.v1.cri".containerd]
                discard_unpacked_layers = false
              [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
                discard_unpacked_layers = false
          permissions: 0
          path: /etc/cri/conf.d/20-customization.part
          op: create
        - content: |-
            [ NFSMount_Global_Options ]
            nfsvers=4.2
            hard=True
            noatime=True
            nodiratime=True
            rsize=131072
            wsize=131072
            nconnect=8
          permissions: 420
          path: /etc/nfsmount.conf
          op: overwrite
    time:
        disabled: false
        servers:
            - 172.16.11.254
            - 172.16.11.9
            - 172.16.11.11
    sysctls:
        fs.inotify.max_user_instances: "8192"
        fs.inotify.max_user_watches: "1048576"
        kernel.randomize_va_space: "0"
        net.core.netdev_max_backlog: "30000"
        net.core.rmem_max: "67108864"
        net.core.wmem_max: "67108864"
        net.ipv4.tcp_rmem: 4096 87380 33554432
        net.ipv4.tcp_tw_reuse: "1"
        net.ipv4.tcp_window_scaling: "1"
        net.ipv4.tcp_wmem: 4096 65536 33554432
    features:
        rbac: true
        stableHostname: true
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
        kubePrism:
            enabled: true
            port: 7445
        hostDNS:
            enabled: true
            forwardKubeDNSToHost: false
            resolveMemberNames: true
    logging:
        destinations:
            - endpoint: udp://vector.monosense.io:6002
              format: json_lines
    nodeLabels:
        topology.kubernetes.io/region: main
        topology.kubernetes.io/zone: w
        factory.talos.dev/schematic-id.part-0: ${TALOS_SCHEMATIC_ID:0:32}
        factory.talos.dev/schematic-id.part-1: ${TALOS_SCHEMATIC_ID:32}
cluster:
    id: ENC[AES256_GCM,data:XaD8DvWvZFQ4pEbGAn8Yq5B8PUFdODxJ8luKU/+iROIwH1m+4UqJj3ELGn0=,iv:2jZ4NmfBAjdoVykDShuFtz6sYNJJ9nmK9MYWgp/wF5k=,tag:WwZ9ivgxBS002lLqNFyGsw==,type:str]
    secret: ENC[AES256_GCM,data:vZ3jRcDuwPWD3sz06lH4tz97eGet1lKeaUfiBgOg1Ew15FSJjNFYUFd9644=,iv:Mg2vf73ybPmMQcKtkrsR4oMxp2tq9Z3GGnwJP+Oedqk=,tag:8ToG7YimKCOH0CDxPUnnOg==,type:str]
    controlPlane:
        endpoint: https://k8s.monosense.io:6443
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.42.0.0/16
        serviceSubnets:
            - 10.43.0.0/16
    token: ENC[AES256_GCM,data:yCGQ9orU1y7Jip6yYEN5HytwwYkD8lU=,iv:wZlAhp7u+zlGBtw5sh1b3WnZ3gGLG2YV3ofPxIKULlg=,tag:7c5f5Ma0PHqz/RNlu635YA==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:agbS5elLO4lJR6Bi73tb6EdBuiN3dPCb9oyDSJGkariYt46X4hE1vni3SD+j7Me6wJGjYxR/Dul5Wxq2DJniFA7p4vfb9g9mYss9BMnRnDa49xp0s3da7JW24tFFNrZw4brXZLoQMLHhNZlfjmiw/ZW76k3oZsTZghx+mb6FUfkmr747/EwNB1/Suotbg50rwxDegOAVdLOnyYY4aDIVjAVcQsLvqrMdlh9Aos/wbvHYPuDtjFqAPellDbhHgj+d9ney98JTdlXgvxGy0ys21JRUxK90vY4nSABjk3n9J+nsd1mBRn7IACVxGwJL7xd5ZbNOToUCIxASD4Z2Ylk4m97LJcCVYFwZyxLq5Bl0kubtxxeyD8NZxlvBE54N0eqVcrODrYWnxluhMowvNUIbmApYFFV61thMu1FEikvTdl6sSza8qF2pq38jOkO9JG26f/Vl6dH3Z0rE8Sz+CP0BPNstE1zrtBmkY7L70sozFw1m5mFKwLey+DH5V2v+UqPHvqTJDCM1nBzX+fWEwnukc00SoOpbs+ggw61FNdHWcK5YaLyIAw2rjLUVNeHfZAAt2NNHFrrD/rvVc4yslVqzsp5krvStlMmFcYpxgLZj8vHNOy2gb3rYUqw8Q+5Mb59AaKIUOmqAvZlVmemcjlojnLj7lydcVMBVQRNy+R/FKRPUHUWkdiK83sqYHpV40b9xIjMt9JlgubIBewi8LbQxGzh1Y3vIGdz9fNVQ9otSkZ6Scd5s4WTpbhzbnpftYfleyWI1tT2o31REmDxt7ChvUvz8QSNa82WlQwgjcXBE8K4mlMSgkgLryO9sEeLh7OdEr8PI6EVwMuiZNbnKJPKqLu9yvTWmZ7j2hF4zW3hT5VNRLjcy3MuljBWkg/XVb6+xB2pLbDRZySeV17Tz6COJOK4i2DywDwdW0DDu9cBkaCcJafH9920/tkTnDlO0j2WUyGJRkzWmVUgOgA2Po/jEX0dbEUydLOJ/iOeX/773zY5lhcbEkzEP7BCFwFbdYvWD2wswtYOMlaEfFs6QdqEM1a1Q90iWY7gk5WxL4w==,iv:Y4qgYCiDw63MCCp4gUD7fgDZWC2VaU4Pz1tCVuFkMYg=,tag:nQ37MC+nAqnRMmECKwfV3g==,type:str]
        key: ""
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: false
            service:
                disabled: false
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1j3hsfptdfsfwvkf504etjkrtmajny9csrfh5s24uqh6fchmg5dgqg087ek
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBwcWcwMDdPMmU3aHhDK2Vi
            OWJJaXE3My8wTzJmbzFQZ243aDByY1pETWhVClRFVWIxelRJazE4S0VUVUI2R0lw
            YnZ2ZjRBcytkZWdQVE9DeHFkQW1wMUUKLS0tIGVPT3g0azFwOU1xdFFvN1h5U3hN
            cTZCOHFMNER4M2JaK2VraVk0dnJwNVEKRIvCWbPPS9YJVJRnT/VSzwRay4ao6Rcx
            ZUBvFbq5NXmzTXr9IQC5N99cu1QNXI4FZ5RCQ5x+ZdGJXECOIVS5EA==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-08-18T02:02:29Z"
    mac: ENC[AES256_GCM,data:XJlr0+w4mU69FXqJQGG4t6UecHKC00/rFm9GT3XhVvnubVjeywx+fWdUDMiImWY8efg63pHiTf2khlKI6tfaFRBknh3t7vnu+E/6W0P+jmSLgHKVAGDlrwZb9/IMzaNQTZ0rJJJJ1K5xGlhFRiQqXcy+BjiwMKHvC1dDkm2ugD8=,iv:m9A9ym8iIGZBYAMeV87FBZwMbdImsFLIJMDwGtbLSeo=,tag:lOe/A95ZFGLNIpPo7JIihg==,type:str]
    pgp: []
    encrypted_regex: ^(token|crt|key|id|secret|secretboxEncryptionSecret|ca)$
    version: 3.9.0
